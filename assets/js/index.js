/*! For license information please see index.js.LICENSE.txt */
(()=>{var e={552:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var r=n(559),i=n.n(r),o=n(476),s=n.n(o)()(i());s.push([e.id,".daily-bread-widget__chapter-title{font-size:1.125em;margin:1rem 0;font-weight:800}.daily-bread-widget__verse{font-size:.9em;margin:1em 0 0}.daily-bread-widget__verse-ref{font-weight:bold}.daily-bread-widget:not(.daily-bread-widget--expanded) .daily-bread-widget__verse:nth-child(n+6){display:none}.daily-bread-widget--state-loading .daily-bread-widget__expander,.daily-bread-widget--expanded .daily-bread-widget__expander,.daily-bread-widget--state-errored .daily-bread-widget__expander{display:none}.daily-bread-widget__error_msg{text-align:center}.daily-bread-widget__error_msg .button{margin-top:1em}\n","",{version:3,sources:["webpack://./js/daily-bread-widget/styles.scss"],names:[],mappings:"AAQI,mCACI,iBAAkB,CAClB,aAAc,CACd,eAAgB,CACnB,2BAGG,cAAe,CACf,cAAe,CAEf,+BACI,gBAAiB,CACpB,iGAGG,YAAa,CAChB,8LAOG,YAAa,CAChB,+BAID,iBAAkB,CADrB,uCAIO,cAAe",sourcesContent:['@import "../_sass/variables";\n\n$class-name: "daily-bread-widget";\n\n.#{$class-name} {\n    // This constant should also be changes in /js/daily-bread-widget.js.\n    $unexpanded-length: 5;\n\n    &__chapter-title {\n        font-size: 1.125em;\n        margin: 1rem 0;\n        font-weight: 800;\n    }\n\n    &__verse {\n        font-size: .9em;\n        margin: 1em 0 0;\n\n        &-ref {\n            font-weight: bold;\n        }\n\n        .#{$class-name}:not(.#{$class-name}--expanded) &:nth-child(n + #{$unexpanded-length + 1}) {\n            display: none;\n        }\n    }\n\n    &__expander {\n        .#{$class-name}--state-loading &,\n        .#{$class-name}--expanded &,\n        .#{$class-name}--state-errored & {\n            display: none;\n        }\n    }\n\n    &__error_msg {\n        text-align: center;\n\n        .button {\n            margin-top: 1em;\n        }\n    }\n}'],sourceRoot:""}]);const a=s},883:(e,t,n)=>{"use strict";n.d(t,{Z:()=>h});var r=n(559),i=n.n(r),o=n(476),s=n.n(o),a=n(678),c=n.n(a),u=new URL(n(93),n.b),l=s()(i()),d=c()(u);l.push([e.id,".upcoming-events-widget{display:flex;flex-direction:row}.upcoming-events-widget__no-events,.upcoming-events-widget__loading{padding:1em;width:100%;height:11rem;display:flex;justify-content:center;align-items:center}.upcoming-events-widget__errored{padding:1em;width:100%;height:11rem;display:flex;flex-direction:column;justify-content:center;align-items:center}.upcoming-events-widget__errored .button{margin-top:1em}.upcoming-event{color:#000;box-shadow:0 0 0 1px #EDEEEE;border-radius:0.5em;padding:1rem;width:15rem;height:11rem;flex-shrink:0;display:flex;flex-direction:column;justify-content:space-between;font-size:.9em}.upcoming-event__info-text-name{font-size:1.25em;font-weight:800;margin:0}.upcoming-event__calendar{display:flex;flex-direction:row;justify-content:space-between;align-items:center}.upcoming-event__calendar-icon{color:inherit;font-size:1.5em;margin:-1rem;padding:1rem}.upcoming-event__calendar-icon:hover,.upcoming-event__calendar-icon:focus{color:#DD5450}.upcoming-event:first-of-type{background-image:url("+d+");background-size:cover;box-shadow:none;box-shadow:0 0.25em 0.25em 0 rgba(0,0,0,0.25)}.upcoming-event:first-of-type .upcoming-event__calendar-icon:hover,.upcoming-event:first-of-type .upcoming-event__calendar-icon:focus{color:#fff}\n","",{version:3,sources:["webpack://./js/upcoming-events-widget/styles.scss","webpack://./../_sass/variables.scss"],names:[],mappings:"AAMA,wBACI,YAAa,CACb,kBAAmB,CAEnB,oEAEI,WAAY,CACZ,UAAW,CACX,YAAa,CACb,YAAa,CACb,sBAAuB,CACvB,kBAAmB,CACtB,iCAGG,WAAY,CACZ,UAAW,CACX,YAAa,CACb,YAAa,CACb,qBAAsB,CACtB,sBAAuB,CACvB,kBAAmB,CAPtB,yCAUO,cAAe,CAClB,gBAKL,UCrBwB,CDsBxB,4BC1BwB,CD2BxB,mBAAoB,CACpB,YAAa,CACb,WAAY,CACZ,YAAa,CACb,aAAc,CACd,YAAa,CACb,qBAAsB,CACtB,6BAA8B,CAC9B,cAAe,CAGX,gCACI,gBAAiB,CACjB,eAAgB,CAChB,QAAS,CACZ,0BAID,YAAa,CACb,kBAAmB,CACnB,6BAA8B,CAC9B,kBAAmB,CAEnB,+BACI,aAAc,CACd,eAAgB,CAChB,YAAa,CACb,YAAa,CAJhB,0EAQO,aC9DO,CD2BvB,8BA6CQ,wDAA84G,CAC94G,qBAAsB,CACtB,eAAgB,CAChB,6CAAoE,CAhD5E,sIAqDgB,UC5Ea",sourcesContent:["@import \"../_sass/variables\";\n@import \"../_sass/sass-functions\";\n\n$widget-class-name: \"upcoming-events-widget\";\n$event-class-name: \"upcoming-event\";\n\n.#{$widget-class-name} {\n    display: flex;\n    flex-direction: row;\n\n    &__no-events,\n    &__loading {\n        padding: 1em;\n        width: 100%;\n        height: 11rem;\n        display: flex;\n        justify-content: center;\n        align-items: center;\n    }\n\n    &__errored {\n        padding: 1em;\n        width: 100%;\n        height: 11rem;\n        display: flex;\n        flex-direction: column;\n        justify-content: center;\n        align-items: center;\n\n        .button {\n            margin-top: 1em;\n        }\n    }\n}\n\n.#{$event-class-name} {\n    color: $color-mono-darkest;\n    box-shadow: 0 0 0 1px $color-mono-lighter;\n    border-radius: 0.5em;\n    padding: 1rem;\n    width: 15rem;\n    height: 11rem;\n    flex-shrink: 0;\n    display: flex;\n    flex-direction: column;\n    justify-content: space-between;\n    font-size: .9em;\n\n    &__info-text {\n        &-name {\n            font-size: 1.25em;\n            font-weight: 800;\n            margin: 0;\n        }\n    }\n\n    &__calendar {\n        display: flex;\n        flex-direction: row;\n        justify-content: space-between;\n        align-items: center;\n\n        &-icon {\n            color: inherit;\n            font-size: 1.5em;\n            margin: -1rem;\n            padding: 1rem;\n\n            &:hover,\n            &:focus {\n                color: $color-primary;\n            }\n        }\n    }\n\n    &:first-of-type {\n        $background-color: $color-secondary;\n        $line-color: $color-mono-lightest;\n        $line-opacity: 0.5;\n        $line-width: 0.005;\n        background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1 1'%3E%3Crect x='0' y='0' width='1' height='1' fill='#{str-replace(#{$background-color}, '#', '%23')}'/%3E%3Cpath stroke='#{str-replace(#{$line-color}, '#', '%23')}' stroke-opacity='#{$line-opacity}' stroke-width='#{$line-width}' fill='none' d='M-0.03847773843338248 1.705301560974815Q0.24799884945430195 1.5254310773340647 0.35711011562818085 1.423751915454356Q0.4662213818020598 1.3220727535746473 0.6018595526086572 1.2872055432850902Q0.7374977234152545 1.252338332995533 0.8551660308683305 1.113104041090609Q0.9728343383214065 0.9738697491856851 1.0282021598502125 0.8831927525655429Q1.0835699813790185 0.7925157559454006 1.113379404422758 0.6189734599636176Q1.1431888274664974 0.4454311639818347 1.4992762023420692 0.4714894856629578'/%3E%3Cpath stroke='#{str-replace(#{$line-color}, '#', '%23')}' stroke-width='#{$line-width}' stroke-opacity='#{$line-opacity}' fill='none' d='M-0.16157074629257784 1.5822085531156198Q0.17449904683588602 1.4519312747156488 0.20059845180604746 1.2672402516322225Q0.22669785677620893 1.0825492285487963 0.4023354181592057 1.0876814088356388Q0.5779729795422025 1.0928135891224813 0.6539559724315185 0.9118939826537971Q0.7299389653208344 0.7309743761851129 0.8534849941685274 0.7084755868838578Q0.9770310230162206 0.6859767975826028 1.0284053380908589 0.5339993936317184Q1.079779653165497 0.3820219896808341 1.2300821387119631 0.20229542203285183'/%3E%3Cpath stroke='#{str-replace(#{$line-color}, '#', '%23')}' stroke-width='#{$line-width}' stroke-opacity='#{$line-opacity}' fill='none' d='M-0.41861362789706663 1.325165671511131Q-0.2617164396985247 1.0157157881812382 -0.15819966585786951 0.9084421339683058Q-0.05468289201721431 0.8011684797553732 0.07800410669803162 0.7633500973744647Q0.21069110541327757 0.7255317149935562 0.2875436036334733 0.5454816138557519Q0.3643961018536691 0.3654315127179477 0.4516373277173389 0.30662792043266934Q0.5388785535810087 0.24782432814739097 0.6460615407491088 0.15165559628996853Q0.753244527917209 0.05548686443254608 0.9995780467904314 -0.028208669888679705'/%3E%3Cpath stroke='#{str-replace(#{$line-color}, '#', '%23')}' stroke-width='#{$line-width}' stroke-opacity='#{$line-opacity}' fill='none' d='M-0.8642849137937137 0.8794943856144843Q-0.5301135770729493 0.7473186508068138 -0.46891646901606054 0.5977253308101147Q-0.40771936095917183 0.44813201081341564 -0.2262213824750796 0.4591246082013534Q-0.044723403990987426 0.4701172055892912 0.08212573258680099 0.3400637428090796Q0.2089748691645894 0.210010280028868 0.2372734696530927 0.0922640623684232Q0.265572070141596 -0.025482155292021615 0.38755250882962045 -0.1068534356295197Q0.5095329475176449 -0.18822471596701779 0.7271669746448011 -0.30061974203431'/%3E%3Cpath stroke='#{str-replace(#{$line-color}, '#', '%23')}' stroke-width='#{$line-width}' stroke-opacity='#{$line-opacity}' fill='none' d='M-1.0447420372151026 0.6990372621930955Q-0.7441519027571061 0.533280325122657 -0.637692662841834 0.42894913698434123Q-0.5312334229265621 0.32461794884602546 -0.38220399280820627 0.30314199786822676Q-0.23317456268985048 0.28166604689042807 -0.13911589616078696 0.11882211406149165Q-0.045057229631723456 -0.044021818767444765 0.031186607146196144 -0.11382280013847332Q0.10743044392411574 -0.18362378150950187 0.1658597865419602 -0.3285461579171799Q0.2242891291598047 -0.47346853432485797 0.4916482352671088 -0.5361384814120023'/%3E%3C/svg%3E\");\n        background-size: cover;\n        box-shadow: none;\n        box-shadow: 0 .25em .25em 0 transparentize($color-mono-darkest, .75);\n\n        & .#{$event-class-name}__calendar-icon {\n            &:hover,\n            &:focus {\n                color: $color-mono-lightest;\n            }\n        }\n    }\n}",'// Breakpoints\n$mobile: "(max-width: 767px)";\n$desktop: "(min-width: 768px)";\n\n$page-side-padding-desktop: 5rem;\n$page-side-padding-mobile: 1rem;\n$page-column-separation: 3.5rem;\n\n$color-primary: #DD5450;\n$color-secondary: #F6BE6A;\n$color-mono-light: #CDCFCF;\n$color-mono-lighter: #EDEEEE;\n$color-mono-lightest: #FFFFFF;\n// $color-mono-dark: #DEADBEEF;\n$color-mono-darker: #1F2120;\n$color-mono-darkest: #000000;\n\n$Karla: \'Karla\', sans-serif;\n\n%button-base {\n    padding: .75em 1em;\n    border-radius: 1.5em;\n    border: 0;\n    cursor: pointer;\n    white-space: nowrap;\n    text-decoration: none;\n    font-weight: 500;\n    font-size: .9rem;\n\n    &:not(.fa):not(.fa-regular):not(.fa-brands):not(.fa-solid):not(.fa-light) {\n        font-family: inherit;\n    }\n}\n\n%button-hover-shadow {\n    @extend %button-base;\n    transition: box-shadow .15s ease-in-out;\n\n    &:hover,\n    &:focus {\n        box-shadow: 0 .25em .25em 0 rgba(0,0,0,.25);\n    }\n}\n\n%button-hover-darken {\n    @extend %button-base;\n    transition: background-color .15s ease-in-out;\n\n    &:hover,\n    &:focus {\n        background-color: rgba(0,0,0,.1);\n    }\n\n    &:active {\n        background-color: rgba(0,0,0,.25);\n    }\n}\n\n@mixin minor-column-base($percentage: 50%) {\n    flex-basis: calc(#{$percentage} - #{$page-column-separation});\n}\n\n@mixin minor-column($side, $percentage: 50%) {\n    @include minor-column-base($percentage);\n    @if $side == left {\n        padding-right: $page-column-separation;\n\n        @media #{$mobile} {\n            padding-right: 0;\n            flex-basis: initial;\n        }\n    } @else if $side == right {\n        padding-left: $page-column-separation;\n\n        @media #{$mobile} {\n            padding-left: 0;\n            flex-basis: initial;\n        }\n    }\n}\n\n@mixin major-column-base($percentage: 50%) {\n    flex-basis: $percentage;\n\n    @media #{$mobile} {\n        flex-basis: initial;\n    }\n}\n\n@mixin major-column($side, $percentage: 50%) {\n    @include major-column-base($percentage);\n}\n'],sourceRoot:""}]);const h=l},476:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",r=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),r&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),r&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,r,i,o){"string"==typeof e&&(e=[[null,e,void 0]]);var s={};if(r)for(var a=0;a<this.length;a++){var c=this[a][0];null!=c&&(s[c]=!0)}for(var u=0;u<e.length;u++){var l=[].concat(e[u]);r&&s[l[0]]||(void 0!==o&&(void 0===l[5]||(l[1]="@layer".concat(l[5].length>0?" ".concat(l[5]):""," {").concat(l[1],"}")),l[5]=o),n&&(l[2]?(l[1]="@media ".concat(l[2]," {").concat(l[1],"}"),l[2]=n):l[2]=n),i&&(l[4]?(l[1]="@supports (".concat(l[4],") {").concat(l[1],"}"),l[4]=i):l[4]="".concat(i)),t.push(l))}},t}},678:e=>{"use strict";e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]|(%20)/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e):e}},559:e=>{"use strict";e.exports=function(e){var t=e[1],n=e[3];if(!n)return t;if("function"==typeof btoa){var r=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),i="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(r),o="/*# ".concat(i," */"),s=n.sources.map((function(e){return"/*# sourceURL=".concat(n.sourceRoot||"").concat(e," */")}));return[t].concat(s).concat([o]).join("\n")}return[t].join("\n")}},892:e=>{"use strict";var t=[];function n(e){for(var n=-1,r=0;r<t.length;r++)if(t[r].identifier===e){n=r;break}return n}function r(e,r){for(var o={},s=[],a=0;a<e.length;a++){var c=e[a],u=r.base?c[0]+r.base:c[0],l=o[u]||0,d="".concat(u," ").concat(l);o[u]=l+1;var h=n(d),p={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==h)t[h].references++,t[h].updater(p);else{var f=i(p,r);r.byIndex=a,t.splice(a,0,{identifier:d,updater:f,references:1})}s.push(d)}return s}function i(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,i){var o=r(e=e||[],i=i||{});return function(e){e=e||[];for(var s=0;s<o.length;s++){var a=n(o[s]);t[a].references--}for(var c=r(e,i),u=0;u<o.length;u++){var l=n(o[u]);0===t[l].references&&(t[l].updater(),t.splice(l,1))}o=c}}},311:e=>{"use strict";var t={};e.exports=function(e,n){var r=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},60:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},192:(e,t,n)=>{"use strict";e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},760:e=>{"use strict";e.exports=function(e){var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var i=void 0!==n.layer;i&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,i&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var o=n.sourceMap;o&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},865:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},858:()=>{},93:e=>{"use strict";e.exports="data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 1 1%27%3E%3Crect x=%270%27 y=%270%27 width=%271%27 height=%271%27 fill=%27%23F6BE6A%27/%3E%3Cpath stroke=%27%23fff%27 stroke-opacity=%27.5%27 stroke-width=%27.005%27 fill=%27none%27 d=%27M-0.03847773843338248 1.705301560974815Q0.24799884945430195 1.5254310773340647 0.35711011562818085 1.423751915454356Q0.4662213818020598 1.3220727535746473 0.6018595526086572 1.2872055432850902Q0.7374977234152545 1.252338332995533 0.8551660308683305 1.113104041090609Q0.9728343383214065 0.9738697491856851 1.0282021598502125 0.8831927525655429Q1.0835699813790185 0.7925157559454006 1.113379404422758 0.6189734599636176Q1.1431888274664974 0.4454311639818347 1.4992762023420692 0.4714894856629578%27/%3E%3Cpath stroke=%27%23fff%27 stroke-width=%27.005%27 stroke-opacity=%27.5%27 fill=%27none%27 d=%27M-0.16157074629257784 1.5822085531156198Q0.17449904683588602 1.4519312747156488 0.20059845180604746 1.2672402516322225Q0.22669785677620893 1.0825492285487963 0.4023354181592057 1.0876814088356388Q0.5779729795422025 1.0928135891224813 0.6539559724315185 0.9118939826537971Q0.7299389653208344 0.7309743761851129 0.8534849941685274 0.7084755868838578Q0.9770310230162206 0.6859767975826028 1.0284053380908589 0.5339993936317184Q1.079779653165497 0.3820219896808341 1.2300821387119631 0.20229542203285183%27/%3E%3Cpath stroke=%27%23fff%27 stroke-width=%27.005%27 stroke-opacity=%27.5%27 fill=%27none%27 d=%27M-0.41861362789706663 1.325165671511131Q-0.2617164396985247 1.0157157881812382 -0.15819966585786951 0.9084421339683058Q-0.05468289201721431 0.8011684797553732 0.07800410669803162 0.7633500973744647Q0.21069110541327757 0.7255317149935562 0.2875436036334733 0.5454816138557519Q0.3643961018536691 0.3654315127179477 0.4516373277173389 0.30662792043266934Q0.5388785535810087 0.24782432814739097 0.6460615407491088 0.15165559628996853Q0.753244527917209 0.05548686443254608 0.9995780467904314 -0.028208669888679705%27/%3E%3Cpath stroke=%27%23fff%27 stroke-width=%27.005%27 stroke-opacity=%27.5%27 fill=%27none%27 d=%27M-0.8642849137937137 0.8794943856144843Q-0.5301135770729493 0.7473186508068138 -0.46891646901606054 0.5977253308101147Q-0.40771936095917183 0.44813201081341564 -0.2262213824750796 0.4591246082013534Q-0.044723403990987426 0.4701172055892912 0.08212573258680099 0.3400637428090796Q0.2089748691645894 0.210010280028868 0.2372734696530927 0.0922640623684232Q0.265572070141596 -0.025482155292021615 0.38755250882962045 -0.1068534356295197Q0.5095329475176449 -0.18822471596701779 0.7271669746448011 -0.30061974203431%27/%3E%3Cpath stroke=%27%23fff%27 stroke-width=%27.005%27 stroke-opacity=%27.5%27 fill=%27none%27 d=%27M-1.0447420372151026 0.6990372621930955Q-0.7441519027571061 0.533280325122657 -0.637692662841834 0.42894913698434123Q-0.5312334229265621 0.32461794884602546 -0.38220399280820627 0.30314199786822676Q-0.23317456268985048 0.28166604689042807 -0.13911589616078696 0.11882211406149165Q-0.045057229631723456 -0.044021818767444765 0.031186607146196144 -0.11382280013847332Q0.10743044392411574 -0.18362378150950187 0.1658597865419602 -0.3285461579171799Q0.2242891291598047 -0.47346853432485797 0.4916482352671088 -0.5361384814120023%27/%3E%3C/svg%3E"}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={id:r,exports:{}};return e[r](o,o.exports,n),o.exports}n.m=e,n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.b=document.baseURI||self.location.href,n.nc=void 0,(()=>{"use strict";var e=function(e){var t=new Date(e),n=""+(t.getMonth()+1),r=""+t.getDate(),i=t.getFullYear();return n.length<2&&(n="0"+n),r.length<2&&(r="0"+r),[i,n,r].join("-")},t=n(892),r=n.n(t),i=n(760),o=n.n(i),s=n(311),a=n.n(s),c=n(192),u=n.n(c),l=n(60),d=n.n(l),h=n(865),p=n.n(h),f=n(552),y={};y.styleTagTransform=p(),y.setAttributes=u(),y.insert=a().bind(null,"head"),y.domAPI=o(),y.insertStyleElement=d(),r()(f.Z,y),f.Z&&f.Z.locals&&f.Z.locals;var m=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},g=function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))};const v=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return String.raw.apply(String,g([{raw:e}],m(t),!1))};var b=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},w=function(e){var t=null,n=function(n,r){var i;"object"==typeof n&&null!==n&&(r=n,n=""),null==n&&(n=""),"number"==typeof n&&(n=n.toString());var o="".concat(e).concat(""===n?"":"__"+n);null==r?r=[]:Array.isArray(r)||(r=Object.entries(r).flatMap((function(e){var t=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}(e,2),n=t[0],r=t[1];return null==r||!1===r?[]:!0===r?[n]:["".concat(n,"-").concat(r)]})));var s=r.map((function(e){return"".concat(o,"--").concat(e)}));if(""===n&&0===r.length&&null!=t)return t;var a=null,c=Object.freeze([o].concat(s)),u=c.join(" "),l=function(){return Array.from(a||document.getElementsByClassName(u))};return(i={classes:c,className:u,select:l,modify:function(e,t){var n,r,i=null==t?l():t instanceof Element?[t]:t;for(var s in e){var a=e[s],c=null==a||!1===a||""===a?null:!0===a?s:"".concat(s,"-").concat(a),u=new RegExp("(?:^| )".concat(o,"--").concat(s,"(?:-[^ ]*)?(?:$| )"));try{for(var d=(n=void 0,b(i)),h=d.next();!h.done;h=d.next()){for(var p=h.value,f=void 0;f=p.className.match(u);)p.classList.remove(f[0].trim());null!=c&&p.classList.add("".concat(o,"--").concat(c))}}catch(e){n={error:e}}finally{try{h&&!h.done&&(r=d.return)&&r.call(d)}finally{if(n)throw n.error}}}},lock:function(){a=Array.from(l())},unlock:function(){a=null},root:function(t){for(var n=t;n instanceof Element;n=n.parentNode)if(n.classList.contains(e))return n;return null}})[Symbol.iterator]=function(){return l()[Symbol.iterator]()},i.toString=function(){return u},i};return t=n(),Object.assign(n,t),n},S=w("button"),A=w("page-content"),E=w("img-aspect-ratio");w.button=S,w.pageContent=A,w.imgAspectRatio=E;const I=w;function T(e){return T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},T(e)}"function"==typeof Symbol&&null!=Symbol.iterator&&Symbol.iterator,"function"==typeof Symbol&&null!=Symbol.asyncIterator&&Symbol.asyncIterator;var C="function"==typeof Symbol&&null!=Symbol.toStringTag?Symbol.toStringTag:"@@toStringTag";function N(e,t){for(var n,r=/\r\n|[\n\r]/g,i=1,o=t+1;(n=r.exec(e.body))&&n.index<t;)i+=1,o=t+1-(n.index+n[0].length);return{line:i,column:o}}function O(e){return _(e.source,N(e.source,e.start))}function _(e,t){var n=e.locationOffset.column-1,r=x(n)+e.body,i=t.line-1,o=e.locationOffset.line-1,s=t.line+o,a=1===t.line?n:0,c=t.column+a,u="".concat(e.name,":").concat(s,":").concat(c,"\n"),l=r.split(/\r\n|[\n\r]/g),d=l[i];if(d.length>120){for(var h=Math.floor(c/80),p=c%80,f=[],y=0;y<d.length;y+=80)f.push(d.slice(y,y+80));return u+k([["".concat(s),f[0]]].concat(f.slice(1,h+1).map((function(e){return["",e]})),[[" ",x(p-1)+"^"],["",f[h+1]]]))}return u+k([["".concat(s-1),l[i-1]],["".concat(s),d],["",x(c-1)+"^"],["".concat(s+1),l[i+1]]])}function k(e){var t=e.filter((function(e){return e[0],void 0!==e[1]})),n=Math.max.apply(Math,t.map((function(e){return e[0].length})));return t.map((function(e){var t,r=e[0],i=e[1];return x(n-(t=r).length)+t+(i?" | "+i:" |")})).join("\n")}function x(e){return Array(e+1).join(" ")}function P(e){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},P(e)}function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function R(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function M(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function L(e,t){return!t||"object"!==P(t)&&"function"!=typeof t?F(e):t}function F(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $(e){var t="function"==typeof Map?new Map:void 0;return $=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return j(e,arguments,q(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),B(r,e)},$(e)}function j(e,t,n){return j=U()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&B(i,n.prototype),i},j.apply(null,arguments)}function U(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function B(e,t){return B=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},B(e,t)}function q(e){return q=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},q(e)}var K=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&B(e,t)}(s,e);var t,n,r,i,o=(t=s,n=U(),function(){var e,r=q(t);if(n){var i=q(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return L(this,e)});function s(e,t,n,r,i,a,c){var u,l,d,h;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(h=o.call(this,e)).name="GraphQLError",h.originalError=null!=a?a:void 0,h.nodes=G(Array.isArray(t)?t:t?[t]:void 0);for(var p=[],f=0,y=null!==(m=h.nodes)&&void 0!==m?m:[];f<y.length;f++){var m,g=y[f].loc;null!=g&&p.push(g)}p=G(p),h.source=null!=n?n:null===(u=p)||void 0===u?void 0:u[0].source,h.positions=null!=r?r:null===(l=p)||void 0===l?void 0:l.map((function(e){return e.start})),h.locations=r&&n?r.map((function(e){return N(n,e)})):null===(d=p)||void 0===d?void 0:d.map((function(e){return N(e.source,e.start)})),h.path=null!=i?i:void 0;var v,b=null==a?void 0:a.extensions;return null==c&&"object"==T(v=b)&&null!==v?h.extensions=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){R(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},b):h.extensions=null!=c?c:{},Object.defineProperties(F(h),{message:{enumerable:!0},locations:{enumerable:null!=h.locations},path:{enumerable:null!=h.path},extensions:{enumerable:null!=h.extensions&&Object.keys(h.extensions).length>0},name:{enumerable:!1},nodes:{enumerable:!1},source:{enumerable:!1},positions:{enumerable:!1},originalError:{enumerable:!1}}),null!=a&&a.stack?(Object.defineProperty(F(h),"stack",{value:a.stack,writable:!0,configurable:!0}),L(h)):(Error.captureStackTrace?Error.captureStackTrace(F(h),s):Object.defineProperty(F(h),"stack",{value:Error().stack,writable:!0,configurable:!0}),h)}return r=s,(i=[{key:"toString",value:function(){return function(e){var t=e.message;if(e.nodes)for(var n=0,r=e.nodes;n<r.length;n++){var i=r[n];i.loc&&(t+="\n\n"+O(i.loc))}else if(e.source&&e.locations)for(var o=0,s=e.locations;o<s.length;o++){var a=s[o];t+="\n\n"+_(e.source,a)}return t}(this)}},{key:C,get:function(){return"Object"}}])&&M(r.prototype,i),s}($(Error));function G(e){return void 0===e||0===e.length?void 0:e}function V(e,t,n){return new K("Syntax Error: ".concat(n),void 0,e,[t])}var W=Object.freeze({NAME:"Name",DOCUMENT:"Document",OPERATION_DEFINITION:"OperationDefinition",VARIABLE_DEFINITION:"VariableDefinition",SELECTION_SET:"SelectionSet",FIELD:"Field",ARGUMENT:"Argument",FRAGMENT_SPREAD:"FragmentSpread",INLINE_FRAGMENT:"InlineFragment",FRAGMENT_DEFINITION:"FragmentDefinition",VARIABLE:"Variable",INT:"IntValue",FLOAT:"FloatValue",STRING:"StringValue",BOOLEAN:"BooleanValue",NULL:"NullValue",ENUM:"EnumValue",LIST:"ListValue",OBJECT:"ObjectValue",OBJECT_FIELD:"ObjectField",DIRECTIVE:"Directive",NAMED_TYPE:"NamedType",LIST_TYPE:"ListType",NON_NULL_TYPE:"NonNullType",SCHEMA_DEFINITION:"SchemaDefinition",OPERATION_TYPE_DEFINITION:"OperationTypeDefinition",SCALAR_TYPE_DEFINITION:"ScalarTypeDefinition",OBJECT_TYPE_DEFINITION:"ObjectTypeDefinition",FIELD_DEFINITION:"FieldDefinition",INPUT_VALUE_DEFINITION:"InputValueDefinition",INTERFACE_TYPE_DEFINITION:"InterfaceTypeDefinition",UNION_TYPE_DEFINITION:"UnionTypeDefinition",ENUM_TYPE_DEFINITION:"EnumTypeDefinition",ENUM_VALUE_DEFINITION:"EnumValueDefinition",INPUT_OBJECT_TYPE_DEFINITION:"InputObjectTypeDefinition",DIRECTIVE_DEFINITION:"DirectiveDefinition",SCHEMA_EXTENSION:"SchemaExtension",SCALAR_TYPE_EXTENSION:"ScalarTypeExtension",OBJECT_TYPE_EXTENSION:"ObjectTypeExtension",INTERFACE_TYPE_EXTENSION:"InterfaceTypeExtension",UNION_TYPE_EXTENSION:"UnionTypeExtension",ENUM_TYPE_EXTENSION:"EnumTypeExtension",INPUT_OBJECT_TYPE_EXTENSION:"InputObjectTypeExtension"});const z="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):void 0;function Q(e){var t=e.prototype.toJSON;"function"==typeof t||function(e,t){if(!Boolean(0))throw new Error("Unexpected invariant triggered.")}(),e.prototype.inspect=t,z&&(e.prototype[z]=t)}var H=function(){function e(e,t,n){this.start=e.start,this.end=t.end,this.startToken=e,this.endToken=t,this.source=n}return e.prototype.toJSON=function(){return{start:this.start,end:this.end}},e}();Q(H);var Y=function(){function e(e,t,n,r,i,o,s){this.kind=e,this.start=t,this.end=n,this.line=r,this.column=i,this.value=s,this.prev=o,this.next=null}return e.prototype.toJSON=function(){return{kind:this.kind,value:this.value,line:this.line,column:this.column}},e}();function J(e){return null!=e&&"string"==typeof e.kind}Q(Y);var X=Object.freeze({SOF:"<SOF>",EOF:"<EOF>",BANG:"!",DOLLAR:"$",AMP:"&",PAREN_L:"(",PAREN_R:")",SPREAD:"...",COLON:":",EQUALS:"=",AT:"@",BRACKET_L:"[",BRACKET_R:"]",BRACE_L:"{",PIPE:"|",BRACE_R:"}",NAME:"Name",INT:"Int",FLOAT:"Float",STRING:"String",BLOCK_STRING:"BlockString",COMMENT:"Comment"});function Z(e){return Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Z(e)}function ee(e){return te(e,[])}function te(e,t){switch(Z(e)){case"string":return JSON.stringify(e);case"function":return e.name?"[function ".concat(e.name,"]"):"[function]";case"object":return null===e?"null":function(e,t){if(-1!==t.indexOf(e))return"[Circular]";var n=[].concat(t,[e]),r=function(e){var t=e[String(z)];return"function"==typeof t?t:"function"==typeof e.inspect?e.inspect:void 0}(e);if(void 0!==r){var i=r.call(e);if(i!==e)return"string"==typeof i?i:te(i,n)}else if(Array.isArray(e))return function(e,t){if(0===e.length)return"[]";if(t.length>2)return"[Array]";for(var n=Math.min(10,e.length),r=e.length-n,i=[],o=0;o<n;++o)i.push(te(e[o],t));return 1===r?i.push("... 1 more item"):r>1&&i.push("... ".concat(r," more items")),"["+i.join(", ")+"]"}(e,n);return function(e,t){var n=Object.keys(e);return 0===n.length?"{}":t.length>2?"["+function(e){var t=Object.prototype.toString.call(e).replace(/^\[object /,"").replace(/]$/,"");if("Object"===t&&"function"==typeof e.constructor){var n=e.constructor.name;if("string"==typeof n&&""!==n)return n}return t}(e)+"]":"{ "+n.map((function(n){return n+": "+te(e[n],t)})).join(", ")+" }"}(e,n)}(e,t);default:return String(e)}}function ne(e,t){if(!Boolean(e))throw new Error(t)}function re(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ie=function(){function e(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GraphQL request",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{line:1,column:1};"string"==typeof e||ne(0,"Body must be a string. Received: ".concat(ee(e),".")),this.body=e,this.name=t,this.locationOffset=n,this.locationOffset.line>0||ne(0,"line in locationOffset is 1-indexed and must be positive."),this.locationOffset.column>0||ne(0,"column in locationOffset is 1-indexed and must be positive.")}var t,n;return t=e,(n=[{key:C,get:function(){return"Source"}}])&&re(t.prototype,n),e}(),oe=Object.freeze({QUERY:"QUERY",MUTATION:"MUTATION",SUBSCRIPTION:"SUBSCRIPTION",FIELD:"FIELD",FRAGMENT_DEFINITION:"FRAGMENT_DEFINITION",FRAGMENT_SPREAD:"FRAGMENT_SPREAD",INLINE_FRAGMENT:"INLINE_FRAGMENT",VARIABLE_DEFINITION:"VARIABLE_DEFINITION",SCHEMA:"SCHEMA",SCALAR:"SCALAR",OBJECT:"OBJECT",FIELD_DEFINITION:"FIELD_DEFINITION",ARGUMENT_DEFINITION:"ARGUMENT_DEFINITION",INTERFACE:"INTERFACE",UNION:"UNION",ENUM:"ENUM",ENUM_VALUE:"ENUM_VALUE",INPUT_OBJECT:"INPUT_OBJECT",INPUT_FIELD_DEFINITION:"INPUT_FIELD_DEFINITION"});function se(e){var t=e.split(/\r\n|[\n\r]/g),n=function(e){for(var t,n=!0,r=!0,i=0,o=null,s=0;s<e.length;++s)switch(e.charCodeAt(s)){case 13:10===e.charCodeAt(s+1)&&++s;case 10:n=!1,r=!0,i=0;break;case 9:case 32:++i;break;default:r&&!n&&(null===o||i<o)&&(o=i),r=!1}return null!==(t=o)&&void 0!==t?t:0}(e);if(0!==n)for(var r=1;r<t.length;r++)t[r]=t[r].slice(n);for(var i=0;i<t.length&&ae(t[i]);)++i;for(var o=t.length;o>i&&ae(t[o-1]);)--o;return t.slice(i,o).join("\n")}function ae(e){for(var t=0;t<e.length;++t)if(" "!==e[t]&&"\t"!==e[t])return!1;return!0}var ce=function(){function e(e){var t=new Y(X.SOF,0,0,0,0,null);this.source=e,this.lastToken=t,this.token=t,this.line=1,this.lineStart=0}var t=e.prototype;return t.advance=function(){return this.lastToken=this.token,this.token=this.lookahead()},t.lookahead=function(){var e=this.token;if(e.kind!==X.EOF)do{var t;e=null!==(t=e.next)&&void 0!==t?t:e.next=le(this,e)}while(e.kind===X.COMMENT);return e},e}();function ue(e){return isNaN(e)?X.EOF:e<127?JSON.stringify(String.fromCharCode(e)):'"\\u'.concat(("00"+e.toString(16).toUpperCase()).slice(-4),'"')}function le(e,t){for(var n=e.source,r=n.body,i=r.length,o=t.end;o<i;){var s=r.charCodeAt(o),a=e.line,c=1+o-e.lineStart;switch(s){case 65279:case 9:case 32:case 44:++o;continue;case 10:++o,++e.line,e.lineStart=o;continue;case 13:10===r.charCodeAt(o+1)?o+=2:++o,++e.line,e.lineStart=o;continue;case 33:return new Y(X.BANG,o,o+1,a,c,t);case 35:return he(n,o,a,c,t);case 36:return new Y(X.DOLLAR,o,o+1,a,c,t);case 38:return new Y(X.AMP,o,o+1,a,c,t);case 40:return new Y(X.PAREN_L,o,o+1,a,c,t);case 41:return new Y(X.PAREN_R,o,o+1,a,c,t);case 46:if(46===r.charCodeAt(o+1)&&46===r.charCodeAt(o+2))return new Y(X.SPREAD,o,o+3,a,c,t);break;case 58:return new Y(X.COLON,o,o+1,a,c,t);case 61:return new Y(X.EQUALS,o,o+1,a,c,t);case 64:return new Y(X.AT,o,o+1,a,c,t);case 91:return new Y(X.BRACKET_L,o,o+1,a,c,t);case 93:return new Y(X.BRACKET_R,o,o+1,a,c,t);case 123:return new Y(X.BRACE_L,o,o+1,a,c,t);case 124:return new Y(X.PIPE,o,o+1,a,c,t);case 125:return new Y(X.BRACE_R,o,o+1,a,c,t);case 34:return 34===r.charCodeAt(o+1)&&34===r.charCodeAt(o+2)?me(n,o,a,c,t,e):ye(n,o,a,c,t);case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return pe(n,o,s,a,c,t);case 65:case 66:case 67:case 68:case 69:case 70:case 71:case 72:case 73:case 74:case 75:case 76:case 77:case 78:case 79:case 80:case 81:case 82:case 83:case 84:case 85:case 86:case 87:case 88:case 89:case 90:case 95:case 97:case 98:case 99:case 100:case 101:case 102:case 103:case 104:case 105:case 106:case 107:case 108:case 109:case 110:case 111:case 112:case 113:case 114:case 115:case 116:case 117:case 118:case 119:case 120:case 121:case 122:return be(n,o,a,c,t)}throw V(n,o,de(s))}var u=e.line,l=1+o-e.lineStart;return new Y(X.EOF,i,i,u,l,t)}function de(e){return e<32&&9!==e&&10!==e&&13!==e?"Cannot contain the invalid character ".concat(ue(e),"."):39===e?"Unexpected single quote character ('), did you mean to use a double quote (\")?":"Cannot parse the unexpected character ".concat(ue(e),".")}function he(e,t,n,r,i){var o,s=e.body,a=t;do{o=s.charCodeAt(++a)}while(!isNaN(o)&&(o>31||9===o));return new Y(X.COMMENT,t,a,n,r,i,s.slice(t+1,a))}function pe(e,t,n,r,i,o){var s=e.body,a=n,c=t,u=!1;if(45===a&&(a=s.charCodeAt(++c)),48===a){if((a=s.charCodeAt(++c))>=48&&a<=57)throw V(e,c,"Invalid number, unexpected digit after 0: ".concat(ue(a),"."))}else c=fe(e,c,a),a=s.charCodeAt(c);if(46===a&&(u=!0,a=s.charCodeAt(++c),c=fe(e,c,a),a=s.charCodeAt(c)),69!==a&&101!==a||(u=!0,43!==(a=s.charCodeAt(++c))&&45!==a||(a=s.charCodeAt(++c)),c=fe(e,c,a),a=s.charCodeAt(c)),46===a||function(e){return 95===e||e>=65&&e<=90||e>=97&&e<=122}(a))throw V(e,c,"Invalid number, expected digit but got: ".concat(ue(a),"."));return new Y(u?X.FLOAT:X.INT,t,c,r,i,o,s.slice(t,c))}function fe(e,t,n){var r=e.body,i=t,o=n;if(o>=48&&o<=57){do{o=r.charCodeAt(++i)}while(o>=48&&o<=57);return i}throw V(e,i,"Invalid number, expected digit but got: ".concat(ue(o),"."))}function ye(e,t,n,r,i){for(var o=e.body,s=t+1,a=s,c=0,u="";s<o.length&&!isNaN(c=o.charCodeAt(s))&&10!==c&&13!==c;){if(34===c)return u+=o.slice(a,s),new Y(X.STRING,t,s+1,n,r,i,u);if(c<32&&9!==c)throw V(e,s,"Invalid character within String: ".concat(ue(c),"."));if(++s,92===c){switch(u+=o.slice(a,s-1),c=o.charCodeAt(s)){case 34:u+='"';break;case 47:u+="/";break;case 92:u+="\\";break;case 98:u+="\b";break;case 102:u+="\f";break;case 110:u+="\n";break;case 114:u+="\r";break;case 116:u+="\t";break;case 117:var l=ge(o.charCodeAt(s+1),o.charCodeAt(s+2),o.charCodeAt(s+3),o.charCodeAt(s+4));if(l<0){var d=o.slice(s+1,s+5);throw V(e,s,"Invalid character escape sequence: \\u".concat(d,"."))}u+=String.fromCharCode(l),s+=4;break;default:throw V(e,s,"Invalid character escape sequence: \\".concat(String.fromCharCode(c),"."))}a=++s}}throw V(e,s,"Unterminated string.")}function me(e,t,n,r,i,o){for(var s=e.body,a=t+3,c=a,u=0,l="";a<s.length&&!isNaN(u=s.charCodeAt(a));){if(34===u&&34===s.charCodeAt(a+1)&&34===s.charCodeAt(a+2))return l+=s.slice(c,a),new Y(X.BLOCK_STRING,t,a+3,n,r,i,se(l));if(u<32&&9!==u&&10!==u&&13!==u)throw V(e,a,"Invalid character within String: ".concat(ue(u),"."));10===u?(++a,++o.line,o.lineStart=a):13===u?(10===s.charCodeAt(a+1)?a+=2:++a,++o.line,o.lineStart=a):92===u&&34===s.charCodeAt(a+1)&&34===s.charCodeAt(a+2)&&34===s.charCodeAt(a+3)?(l+=s.slice(c,a)+'"""',c=a+=4):++a}throw V(e,a,"Unterminated string.")}function ge(e,t,n,r){return ve(e)<<12|ve(t)<<8|ve(n)<<4|ve(r)}function ve(e){return e>=48&&e<=57?e-48:e>=65&&e<=70?e-55:e>=97&&e<=102?e-87:-1}function be(e,t,n,r,i){for(var o=e.body,s=o.length,a=t+1,c=0;a!==s&&!isNaN(c=o.charCodeAt(a))&&(95===c||c>=48&&c<=57||c>=65&&c<=90||c>=97&&c<=122);)++a;return new Y(X.NAME,t,a,n,r,i,o.slice(t,a))}function we(e,t){return new Se(e,t).parseDocument()}var Se=function(){function e(e,t){var n=function(e){return e instanceof ie}(e)?e:new ie(e);this._lexer=new ce(n),this._options=t}var t=e.prototype;return t.parseName=function(){var e=this.expectToken(X.NAME);return{kind:W.NAME,value:e.value,loc:this.loc(e)}},t.parseDocument=function(){var e=this._lexer.token;return{kind:W.DOCUMENT,definitions:this.many(X.SOF,this.parseDefinition,X.EOF),loc:this.loc(e)}},t.parseDefinition=function(){if(this.peek(X.NAME))switch(this._lexer.token.value){case"query":case"mutation":case"subscription":return this.parseOperationDefinition();case"fragment":return this.parseFragmentDefinition();case"schema":case"scalar":case"type":case"interface":case"union":case"enum":case"input":case"directive":return this.parseTypeSystemDefinition();case"extend":return this.parseTypeSystemExtension()}else{if(this.peek(X.BRACE_L))return this.parseOperationDefinition();if(this.peekDescription())return this.parseTypeSystemDefinition()}throw this.unexpected()},t.parseOperationDefinition=function(){var e=this._lexer.token;if(this.peek(X.BRACE_L))return{kind:W.OPERATION_DEFINITION,operation:"query",name:void 0,variableDefinitions:[],directives:[],selectionSet:this.parseSelectionSet(),loc:this.loc(e)};var t,n=this.parseOperationType();return this.peek(X.NAME)&&(t=this.parseName()),{kind:W.OPERATION_DEFINITION,operation:n,name:t,variableDefinitions:this.parseVariableDefinitions(),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet(),loc:this.loc(e)}},t.parseOperationType=function(){var e=this.expectToken(X.NAME);switch(e.value){case"query":return"query";case"mutation":return"mutation";case"subscription":return"subscription"}throw this.unexpected(e)},t.parseVariableDefinitions=function(){return this.optionalMany(X.PAREN_L,this.parseVariableDefinition,X.PAREN_R)},t.parseVariableDefinition=function(){var e=this._lexer.token;return{kind:W.VARIABLE_DEFINITION,variable:this.parseVariable(),type:(this.expectToken(X.COLON),this.parseTypeReference()),defaultValue:this.expectOptionalToken(X.EQUALS)?this.parseValueLiteral(!0):void 0,directives:this.parseDirectives(!0),loc:this.loc(e)}},t.parseVariable=function(){var e=this._lexer.token;return this.expectToken(X.DOLLAR),{kind:W.VARIABLE,name:this.parseName(),loc:this.loc(e)}},t.parseSelectionSet=function(){var e=this._lexer.token;return{kind:W.SELECTION_SET,selections:this.many(X.BRACE_L,this.parseSelection,X.BRACE_R),loc:this.loc(e)}},t.parseSelection=function(){return this.peek(X.SPREAD)?this.parseFragment():this.parseField()},t.parseField=function(){var e,t,n=this._lexer.token,r=this.parseName();return this.expectOptionalToken(X.COLON)?(e=r,t=this.parseName()):t=r,{kind:W.FIELD,alias:e,name:t,arguments:this.parseArguments(!1),directives:this.parseDirectives(!1),selectionSet:this.peek(X.BRACE_L)?this.parseSelectionSet():void 0,loc:this.loc(n)}},t.parseArguments=function(e){var t=e?this.parseConstArgument:this.parseArgument;return this.optionalMany(X.PAREN_L,t,X.PAREN_R)},t.parseArgument=function(){var e=this._lexer.token,t=this.parseName();return this.expectToken(X.COLON),{kind:W.ARGUMENT,name:t,value:this.parseValueLiteral(!1),loc:this.loc(e)}},t.parseConstArgument=function(){var e=this._lexer.token;return{kind:W.ARGUMENT,name:this.parseName(),value:(this.expectToken(X.COLON),this.parseValueLiteral(!0)),loc:this.loc(e)}},t.parseFragment=function(){var e=this._lexer.token;this.expectToken(X.SPREAD);var t=this.expectOptionalKeyword("on");return!t&&this.peek(X.NAME)?{kind:W.FRAGMENT_SPREAD,name:this.parseFragmentName(),directives:this.parseDirectives(!1),loc:this.loc(e)}:{kind:W.INLINE_FRAGMENT,typeCondition:t?this.parseNamedType():void 0,directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet(),loc:this.loc(e)}},t.parseFragmentDefinition=function(){var e,t=this._lexer.token;return this.expectKeyword("fragment"),!0===(null===(e=this._options)||void 0===e?void 0:e.experimentalFragmentVariables)?{kind:W.FRAGMENT_DEFINITION,name:this.parseFragmentName(),variableDefinitions:this.parseVariableDefinitions(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet(),loc:this.loc(t)}:{kind:W.FRAGMENT_DEFINITION,name:this.parseFragmentName(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet(),loc:this.loc(t)}},t.parseFragmentName=function(){if("on"===this._lexer.token.value)throw this.unexpected();return this.parseName()},t.parseValueLiteral=function(e){var t=this._lexer.token;switch(t.kind){case X.BRACKET_L:return this.parseList(e);case X.BRACE_L:return this.parseObject(e);case X.INT:return this._lexer.advance(),{kind:W.INT,value:t.value,loc:this.loc(t)};case X.FLOAT:return this._lexer.advance(),{kind:W.FLOAT,value:t.value,loc:this.loc(t)};case X.STRING:case X.BLOCK_STRING:return this.parseStringLiteral();case X.NAME:switch(this._lexer.advance(),t.value){case"true":return{kind:W.BOOLEAN,value:!0,loc:this.loc(t)};case"false":return{kind:W.BOOLEAN,value:!1,loc:this.loc(t)};case"null":return{kind:W.NULL,loc:this.loc(t)};default:return{kind:W.ENUM,value:t.value,loc:this.loc(t)}}case X.DOLLAR:if(!e)return this.parseVariable()}throw this.unexpected()},t.parseStringLiteral=function(){var e=this._lexer.token;return this._lexer.advance(),{kind:W.STRING,value:e.value,block:e.kind===X.BLOCK_STRING,loc:this.loc(e)}},t.parseList=function(e){var t=this,n=this._lexer.token;return{kind:W.LIST,values:this.any(X.BRACKET_L,(function(){return t.parseValueLiteral(e)}),X.BRACKET_R),loc:this.loc(n)}},t.parseObject=function(e){var t=this,n=this._lexer.token;return{kind:W.OBJECT,fields:this.any(X.BRACE_L,(function(){return t.parseObjectField(e)}),X.BRACE_R),loc:this.loc(n)}},t.parseObjectField=function(e){var t=this._lexer.token,n=this.parseName();return this.expectToken(X.COLON),{kind:W.OBJECT_FIELD,name:n,value:this.parseValueLiteral(e),loc:this.loc(t)}},t.parseDirectives=function(e){for(var t=[];this.peek(X.AT);)t.push(this.parseDirective(e));return t},t.parseDirective=function(e){var t=this._lexer.token;return this.expectToken(X.AT),{kind:W.DIRECTIVE,name:this.parseName(),arguments:this.parseArguments(e),loc:this.loc(t)}},t.parseTypeReference=function(){var e,t=this._lexer.token;return this.expectOptionalToken(X.BRACKET_L)?(e=this.parseTypeReference(),this.expectToken(X.BRACKET_R),e={kind:W.LIST_TYPE,type:e,loc:this.loc(t)}):e=this.parseNamedType(),this.expectOptionalToken(X.BANG)?{kind:W.NON_NULL_TYPE,type:e,loc:this.loc(t)}:e},t.parseNamedType=function(){var e=this._lexer.token;return{kind:W.NAMED_TYPE,name:this.parseName(),loc:this.loc(e)}},t.parseTypeSystemDefinition=function(){var e=this.peekDescription()?this._lexer.lookahead():this._lexer.token;if(e.kind===X.NAME)switch(e.value){case"schema":return this.parseSchemaDefinition();case"scalar":return this.parseScalarTypeDefinition();case"type":return this.parseObjectTypeDefinition();case"interface":return this.parseInterfaceTypeDefinition();case"union":return this.parseUnionTypeDefinition();case"enum":return this.parseEnumTypeDefinition();case"input":return this.parseInputObjectTypeDefinition();case"directive":return this.parseDirectiveDefinition()}throw this.unexpected(e)},t.peekDescription=function(){return this.peek(X.STRING)||this.peek(X.BLOCK_STRING)},t.parseDescription=function(){if(this.peekDescription())return this.parseStringLiteral()},t.parseSchemaDefinition=function(){var e=this._lexer.token,t=this.parseDescription();this.expectKeyword("schema");var n=this.parseDirectives(!0),r=this.many(X.BRACE_L,this.parseOperationTypeDefinition,X.BRACE_R);return{kind:W.SCHEMA_DEFINITION,description:t,directives:n,operationTypes:r,loc:this.loc(e)}},t.parseOperationTypeDefinition=function(){var e=this._lexer.token,t=this.parseOperationType();this.expectToken(X.COLON);var n=this.parseNamedType();return{kind:W.OPERATION_TYPE_DEFINITION,operation:t,type:n,loc:this.loc(e)}},t.parseScalarTypeDefinition=function(){var e=this._lexer.token,t=this.parseDescription();this.expectKeyword("scalar");var n=this.parseName(),r=this.parseDirectives(!0);return{kind:W.SCALAR_TYPE_DEFINITION,description:t,name:n,directives:r,loc:this.loc(e)}},t.parseObjectTypeDefinition=function(){var e=this._lexer.token,t=this.parseDescription();this.expectKeyword("type");var n=this.parseName(),r=this.parseImplementsInterfaces(),i=this.parseDirectives(!0),o=this.parseFieldsDefinition();return{kind:W.OBJECT_TYPE_DEFINITION,description:t,name:n,interfaces:r,directives:i,fields:o,loc:this.loc(e)}},t.parseImplementsInterfaces=function(){var e;if(!this.expectOptionalKeyword("implements"))return[];if(!0===(null===(e=this._options)||void 0===e?void 0:e.allowLegacySDLImplementsInterfaces)){var t=[];this.expectOptionalToken(X.AMP);do{t.push(this.parseNamedType())}while(this.expectOptionalToken(X.AMP)||this.peek(X.NAME));return t}return this.delimitedMany(X.AMP,this.parseNamedType)},t.parseFieldsDefinition=function(){var e;return!0===(null===(e=this._options)||void 0===e?void 0:e.allowLegacySDLEmptyFields)&&this.peek(X.BRACE_L)&&this._lexer.lookahead().kind===X.BRACE_R?(this._lexer.advance(),this._lexer.advance(),[]):this.optionalMany(X.BRACE_L,this.parseFieldDefinition,X.BRACE_R)},t.parseFieldDefinition=function(){var e=this._lexer.token,t=this.parseDescription(),n=this.parseName(),r=this.parseArgumentDefs();this.expectToken(X.COLON);var i=this.parseTypeReference(),o=this.parseDirectives(!0);return{kind:W.FIELD_DEFINITION,description:t,name:n,arguments:r,type:i,directives:o,loc:this.loc(e)}},t.parseArgumentDefs=function(){return this.optionalMany(X.PAREN_L,this.parseInputValueDef,X.PAREN_R)},t.parseInputValueDef=function(){var e=this._lexer.token,t=this.parseDescription(),n=this.parseName();this.expectToken(X.COLON);var r,i=this.parseTypeReference();this.expectOptionalToken(X.EQUALS)&&(r=this.parseValueLiteral(!0));var o=this.parseDirectives(!0);return{kind:W.INPUT_VALUE_DEFINITION,description:t,name:n,type:i,defaultValue:r,directives:o,loc:this.loc(e)}},t.parseInterfaceTypeDefinition=function(){var e=this._lexer.token,t=this.parseDescription();this.expectKeyword("interface");var n=this.parseName(),r=this.parseImplementsInterfaces(),i=this.parseDirectives(!0),o=this.parseFieldsDefinition();return{kind:W.INTERFACE_TYPE_DEFINITION,description:t,name:n,interfaces:r,directives:i,fields:o,loc:this.loc(e)}},t.parseUnionTypeDefinition=function(){var e=this._lexer.token,t=this.parseDescription();this.expectKeyword("union");var n=this.parseName(),r=this.parseDirectives(!0),i=this.parseUnionMemberTypes();return{kind:W.UNION_TYPE_DEFINITION,description:t,name:n,directives:r,types:i,loc:this.loc(e)}},t.parseUnionMemberTypes=function(){return this.expectOptionalToken(X.EQUALS)?this.delimitedMany(X.PIPE,this.parseNamedType):[]},t.parseEnumTypeDefinition=function(){var e=this._lexer.token,t=this.parseDescription();this.expectKeyword("enum");var n=this.parseName(),r=this.parseDirectives(!0),i=this.parseEnumValuesDefinition();return{kind:W.ENUM_TYPE_DEFINITION,description:t,name:n,directives:r,values:i,loc:this.loc(e)}},t.parseEnumValuesDefinition=function(){return this.optionalMany(X.BRACE_L,this.parseEnumValueDefinition,X.BRACE_R)},t.parseEnumValueDefinition=function(){var e=this._lexer.token,t=this.parseDescription(),n=this.parseName(),r=this.parseDirectives(!0);return{kind:W.ENUM_VALUE_DEFINITION,description:t,name:n,directives:r,loc:this.loc(e)}},t.parseInputObjectTypeDefinition=function(){var e=this._lexer.token,t=this.parseDescription();this.expectKeyword("input");var n=this.parseName(),r=this.parseDirectives(!0),i=this.parseInputFieldsDefinition();return{kind:W.INPUT_OBJECT_TYPE_DEFINITION,description:t,name:n,directives:r,fields:i,loc:this.loc(e)}},t.parseInputFieldsDefinition=function(){return this.optionalMany(X.BRACE_L,this.parseInputValueDef,X.BRACE_R)},t.parseTypeSystemExtension=function(){var e=this._lexer.lookahead();if(e.kind===X.NAME)switch(e.value){case"schema":return this.parseSchemaExtension();case"scalar":return this.parseScalarTypeExtension();case"type":return this.parseObjectTypeExtension();case"interface":return this.parseInterfaceTypeExtension();case"union":return this.parseUnionTypeExtension();case"enum":return this.parseEnumTypeExtension();case"input":return this.parseInputObjectTypeExtension()}throw this.unexpected(e)},t.parseSchemaExtension=function(){var e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("schema");var t=this.parseDirectives(!0),n=this.optionalMany(X.BRACE_L,this.parseOperationTypeDefinition,X.BRACE_R);if(0===t.length&&0===n.length)throw this.unexpected();return{kind:W.SCHEMA_EXTENSION,directives:t,operationTypes:n,loc:this.loc(e)}},t.parseScalarTypeExtension=function(){var e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("scalar");var t=this.parseName(),n=this.parseDirectives(!0);if(0===n.length)throw this.unexpected();return{kind:W.SCALAR_TYPE_EXTENSION,name:t,directives:n,loc:this.loc(e)}},t.parseObjectTypeExtension=function(){var e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("type");var t=this.parseName(),n=this.parseImplementsInterfaces(),r=this.parseDirectives(!0),i=this.parseFieldsDefinition();if(0===n.length&&0===r.length&&0===i.length)throw this.unexpected();return{kind:W.OBJECT_TYPE_EXTENSION,name:t,interfaces:n,directives:r,fields:i,loc:this.loc(e)}},t.parseInterfaceTypeExtension=function(){var e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("interface");var t=this.parseName(),n=this.parseImplementsInterfaces(),r=this.parseDirectives(!0),i=this.parseFieldsDefinition();if(0===n.length&&0===r.length&&0===i.length)throw this.unexpected();return{kind:W.INTERFACE_TYPE_EXTENSION,name:t,interfaces:n,directives:r,fields:i,loc:this.loc(e)}},t.parseUnionTypeExtension=function(){var e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("union");var t=this.parseName(),n=this.parseDirectives(!0),r=this.parseUnionMemberTypes();if(0===n.length&&0===r.length)throw this.unexpected();return{kind:W.UNION_TYPE_EXTENSION,name:t,directives:n,types:r,loc:this.loc(e)}},t.parseEnumTypeExtension=function(){var e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("enum");var t=this.parseName(),n=this.parseDirectives(!0),r=this.parseEnumValuesDefinition();if(0===n.length&&0===r.length)throw this.unexpected();return{kind:W.ENUM_TYPE_EXTENSION,name:t,directives:n,values:r,loc:this.loc(e)}},t.parseInputObjectTypeExtension=function(){var e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("input");var t=this.parseName(),n=this.parseDirectives(!0),r=this.parseInputFieldsDefinition();if(0===n.length&&0===r.length)throw this.unexpected();return{kind:W.INPUT_OBJECT_TYPE_EXTENSION,name:t,directives:n,fields:r,loc:this.loc(e)}},t.parseDirectiveDefinition=function(){var e=this._lexer.token,t=this.parseDescription();this.expectKeyword("directive"),this.expectToken(X.AT);var n=this.parseName(),r=this.parseArgumentDefs(),i=this.expectOptionalKeyword("repeatable");this.expectKeyword("on");var o=this.parseDirectiveLocations();return{kind:W.DIRECTIVE_DEFINITION,description:t,name:n,arguments:r,repeatable:i,locations:o,loc:this.loc(e)}},t.parseDirectiveLocations=function(){return this.delimitedMany(X.PIPE,this.parseDirectiveLocation)},t.parseDirectiveLocation=function(){var e=this._lexer.token,t=this.parseName();if(void 0!==oe[t.value])return t;throw this.unexpected(e)},t.loc=function(e){var t;if(!0!==(null===(t=this._options)||void 0===t?void 0:t.noLocation))return new H(e,this._lexer.lastToken,this._lexer.source)},t.peek=function(e){return this._lexer.token.kind===e},t.expectToken=function(e){var t=this._lexer.token;if(t.kind===e)return this._lexer.advance(),t;throw V(this._lexer.source,t.start,"Expected ".concat(Ee(e),", found ").concat(Ae(t),"."))},t.expectOptionalToken=function(e){var t=this._lexer.token;if(t.kind===e)return this._lexer.advance(),t},t.expectKeyword=function(e){var t=this._lexer.token;if(t.kind!==X.NAME||t.value!==e)throw V(this._lexer.source,t.start,'Expected "'.concat(e,'", found ').concat(Ae(t),"."));this._lexer.advance()},t.expectOptionalKeyword=function(e){var t=this._lexer.token;return t.kind===X.NAME&&t.value===e&&(this._lexer.advance(),!0)},t.unexpected=function(e){var t=null!=e?e:this._lexer.token;return V(this._lexer.source,t.start,"Unexpected ".concat(Ae(t),"."))},t.any=function(e,t,n){this.expectToken(e);for(var r=[];!this.expectOptionalToken(n);)r.push(t.call(this));return r},t.optionalMany=function(e,t,n){if(this.expectOptionalToken(e)){var r=[];do{r.push(t.call(this))}while(!this.expectOptionalToken(n));return r}return[]},t.many=function(e,t,n){this.expectToken(e);var r=[];do{r.push(t.call(this))}while(!this.expectOptionalToken(n));return r},t.delimitedMany=function(e,t){this.expectOptionalToken(e);var n=[];do{n.push(t.call(this))}while(this.expectOptionalToken(e));return n},e}();function Ae(e){var t=e.value;return Ee(e.kind)+(null!=t?' "'.concat(t,'"'):"")}function Ee(e){return function(e){return e===X.BANG||e===X.DOLLAR||e===X.AMP||e===X.PAREN_L||e===X.PAREN_R||e===X.SPREAD||e===X.COLON||e===X.EQUALS||e===X.AT||e===X.BRACKET_L||e===X.BRACKET_R||e===X.BRACE_L||e===X.PIPE||e===X.BRACE_R}(e)?'"'.concat(e,'"'):e}var Ie={Name:[],Document:["definitions"],OperationDefinition:["name","variableDefinitions","directives","selectionSet"],VariableDefinition:["variable","type","defaultValue","directives"],Variable:["name"],SelectionSet:["selections"],Field:["alias","name","arguments","directives","selectionSet"],Argument:["name","value"],FragmentSpread:["name","directives"],InlineFragment:["typeCondition","directives","selectionSet"],FragmentDefinition:["name","variableDefinitions","typeCondition","directives","selectionSet"],IntValue:[],FloatValue:[],StringValue:[],BooleanValue:[],NullValue:[],EnumValue:[],ListValue:["values"],ObjectValue:["fields"],ObjectField:["name","value"],Directive:["name","arguments"],NamedType:["name"],ListType:["type"],NonNullType:["type"],SchemaDefinition:["description","directives","operationTypes"],OperationTypeDefinition:["type"],ScalarTypeDefinition:["description","name","directives"],ObjectTypeDefinition:["description","name","interfaces","directives","fields"],FieldDefinition:["description","name","arguments","type","directives"],InputValueDefinition:["description","name","type","defaultValue","directives"],InterfaceTypeDefinition:["description","name","interfaces","directives","fields"],UnionTypeDefinition:["description","name","directives","types"],EnumTypeDefinition:["description","name","directives","values"],EnumValueDefinition:["description","name","directives"],InputObjectTypeDefinition:["description","name","directives","fields"],DirectiveDefinition:["description","name","arguments","locations"],SchemaExtension:["directives","operationTypes"],ScalarTypeExtension:["name","directives"],ObjectTypeExtension:["name","interfaces","directives","fields"],InterfaceTypeExtension:["name","interfaces","directives","fields"],UnionTypeExtension:["name","directives","types"],EnumTypeExtension:["name","directives","values"],InputObjectTypeExtension:["name","directives","fields"]},Te=Object.freeze({});function Ce(e,t,n){var r=e[t];if(r){if(!n&&"function"==typeof r)return r;var i=n?r.leave:r.enter;if("function"==typeof i)return i}else{var o=n?e.leave:e.enter;if(o){if("function"==typeof o)return o;var s=o[t];if("function"==typeof s)return s}}}function Ne(e){return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ie,r=void 0,i=Array.isArray(e),o=[e],s=-1,a=[],c=void 0,u=void 0,l=void 0,d=[],h=[],p=e;do{var f=++s===o.length,y=f&&0!==a.length;if(f){if(u=0===h.length?void 0:d[d.length-1],c=l,l=h.pop(),y){if(i)c=c.slice();else{for(var m={},g=0,v=Object.keys(c);g<v.length;g++){var b=v[g];m[b]=c[b]}c=m}for(var w=0,S=0;S<a.length;S++){var A=a[S][0],E=a[S][1];i&&(A-=w),i&&null===E?(c.splice(A,1),w++):c[A]=E}}s=r.index,o=r.keys,a=r.edits,i=r.inArray,r=r.prev}else{if(u=l?i?s:o[s]:void 0,null==(c=l?l[u]:p))continue;l&&d.push(u)}var I,T=void 0;if(!Array.isArray(c)){if(!J(c))throw new Error("Invalid AST Node: ".concat(ee(c),"."));var C=Ce(t,c.kind,f);if(C){if((T=C.call(t,c,u,l,d,h))===Te)break;if(!1===T){if(!f){d.pop();continue}}else if(void 0!==T&&(a.push([u,T]),!f)){if(!J(T)){d.pop();continue}c=T}}}void 0===T&&y&&a.push([u,c]),f?d.pop():(r={inArray:i,index:s,keys:o,edits:a,prev:r},o=(i=Array.isArray(c))?c:null!==(I=n[c.kind])&&void 0!==I?I:[],s=-1,a=[],l&&h.push(l),l=c)}while(void 0!==r);return 0!==a.length&&(p=a[a.length-1][1]),p}(e,{leave:Oe})}var Oe={Name:function(e){return e.value},Variable:function(e){return"$"+e.name},Document:function(e){return ke(e.definitions,"\n\n")+"\n"},OperationDefinition:function(e){var t=e.operation,n=e.name,r=Pe("(",ke(e.variableDefinitions,", "),")"),i=ke(e.directives," "),o=e.selectionSet;return n||i||r||"query"!==t?ke([t,ke([n,r]),i,o]," "):o},VariableDefinition:function(e){var t=e.variable,n=e.type,r=e.defaultValue,i=e.directives;return t+": "+n+Pe(" = ",r)+Pe(" ",ke(i," "))},SelectionSet:function(e){return xe(e.selections)},Field:function(e){var t=e.alias,n=e.name,r=e.arguments,i=e.directives,o=e.selectionSet,s=Pe("",t,": ")+n,a=s+Pe("(",ke(r,", "),")");return a.length>80&&(a=s+Pe("(\n",De(ke(r,"\n")),"\n)")),ke([a,ke(i," "),o]," ")},Argument:function(e){return e.name+": "+e.value},FragmentSpread:function(e){return"..."+e.name+Pe(" ",ke(e.directives," "))},InlineFragment:function(e){var t=e.typeCondition,n=e.directives,r=e.selectionSet;return ke(["...",Pe("on ",t),ke(n," "),r]," ")},FragmentDefinition:function(e){var t=e.name,n=e.typeCondition,r=e.variableDefinitions,i=e.directives,o=e.selectionSet;return"fragment ".concat(t).concat(Pe("(",ke(r,", "),")")," ")+"on ".concat(n," ").concat(Pe("",ke(i," ")," "))+o},IntValue:function(e){return e.value},FloatValue:function(e){return e.value},StringValue:function(e,t){var n=e.value;return e.block?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=-1===e.indexOf("\n"),i=" "===e[0]||"\t"===e[0],o='"'===e[e.length-1],s="\\"===e[e.length-1],a=!r||o||s||n,c="";return!a||r&&i||(c+="\n"+t),c+=t?e.replace(/\n/g,"\n"+t):e,a&&(c+="\n"),'"""'+c.replace(/"""/g,'\\"""')+'"""'}(n,"description"===t?"":"  "):JSON.stringify(n)},BooleanValue:function(e){return e.value?"true":"false"},NullValue:function(){return"null"},EnumValue:function(e){return e.value},ListValue:function(e){return"["+ke(e.values,", ")+"]"},ObjectValue:function(e){return"{"+ke(e.fields,", ")+"}"},ObjectField:function(e){return e.name+": "+e.value},Directive:function(e){return"@"+e.name+Pe("(",ke(e.arguments,", "),")")},NamedType:function(e){return e.name},ListType:function(e){return"["+e.type+"]"},NonNullType:function(e){return e.type+"!"},SchemaDefinition:_e((function(e){var t=e.directives,n=e.operationTypes;return ke(["schema",ke(t," "),xe(n)]," ")})),OperationTypeDefinition:function(e){return e.operation+": "+e.type},ScalarTypeDefinition:_e((function(e){return ke(["scalar",e.name,ke(e.directives," ")]," ")})),ObjectTypeDefinition:_e((function(e){var t=e.name,n=e.interfaces,r=e.directives,i=e.fields;return ke(["type",t,Pe("implements ",ke(n," & ")),ke(r," "),xe(i)]," ")})),FieldDefinition:_e((function(e){var t=e.name,n=e.arguments,r=e.type,i=e.directives;return t+(Me(n)?Pe("(\n",De(ke(n,"\n")),"\n)"):Pe("(",ke(n,", "),")"))+": "+r+Pe(" ",ke(i," "))})),InputValueDefinition:_e((function(e){var t=e.name,n=e.type,r=e.defaultValue,i=e.directives;return ke([t+": "+n,Pe("= ",r),ke(i," ")]," ")})),InterfaceTypeDefinition:_e((function(e){var t=e.name,n=e.interfaces,r=e.directives,i=e.fields;return ke(["interface",t,Pe("implements ",ke(n," & ")),ke(r," "),xe(i)]," ")})),UnionTypeDefinition:_e((function(e){var t=e.name,n=e.directives,r=e.types;return ke(["union",t,ke(n," "),r&&0!==r.length?"= "+ke(r," | "):""]," ")})),EnumTypeDefinition:_e((function(e){var t=e.name,n=e.directives,r=e.values;return ke(["enum",t,ke(n," "),xe(r)]," ")})),EnumValueDefinition:_e((function(e){return ke([e.name,ke(e.directives," ")]," ")})),InputObjectTypeDefinition:_e((function(e){var t=e.name,n=e.directives,r=e.fields;return ke(["input",t,ke(n," "),xe(r)]," ")})),DirectiveDefinition:_e((function(e){var t=e.name,n=e.arguments,r=e.repeatable,i=e.locations;return"directive @"+t+(Me(n)?Pe("(\n",De(ke(n,"\n")),"\n)"):Pe("(",ke(n,", "),")"))+(r?" repeatable":"")+" on "+ke(i," | ")})),SchemaExtension:function(e){var t=e.directives,n=e.operationTypes;return ke(["extend schema",ke(t," "),xe(n)]," ")},ScalarTypeExtension:function(e){return ke(["extend scalar",e.name,ke(e.directives," ")]," ")},ObjectTypeExtension:function(e){var t=e.name,n=e.interfaces,r=e.directives,i=e.fields;return ke(["extend type",t,Pe("implements ",ke(n," & ")),ke(r," "),xe(i)]," ")},InterfaceTypeExtension:function(e){var t=e.name,n=e.interfaces,r=e.directives,i=e.fields;return ke(["extend interface",t,Pe("implements ",ke(n," & ")),ke(r," "),xe(i)]," ")},UnionTypeExtension:function(e){var t=e.name,n=e.directives,r=e.types;return ke(["extend union",t,ke(n," "),r&&0!==r.length?"= "+ke(r," | "):""]," ")},EnumTypeExtension:function(e){var t=e.name,n=e.directives,r=e.values;return ke(["extend enum",t,ke(n," "),xe(r)]," ")},InputObjectTypeExtension:function(e){var t=e.name,n=e.directives,r=e.fields;return ke(["extend input",t,ke(n," "),xe(r)]," ")}};function _e(e){return function(t){return ke([t.description,e(t)],"\n")}}function ke(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return null!==(t=null==e?void 0:e.filter((function(e){return e})).join(n))&&void 0!==t?t:""}function xe(e){return Pe("{\n",De(ke(e,"\n")),"\n}")}function Pe(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return null!=t&&""!==t?e+t+n:""}function De(e){return Pe("  ",e.replace(/\n/g,"\n  "))}function Re(e){return-1!==e.indexOf("\n")}function Me(e){return null!=e&&e.some(Re)}var Le=function(e,t){return Le=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},Le(e,t)};function Fe(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}Le(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function $e(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))}function je(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}function Ue(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Be(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function qe(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}function Ke(e){return this instanceof Ke?(this.v=e,this):new Ke(e)}function Ge(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),o=[];return r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r;function s(e){i[e]&&(r[e]=function(t){return new Promise((function(n,r){o.push([e,t,n,r])>1||a(e,t)}))})}function a(e,t){try{!function(e){e.value instanceof Ke?Promise.resolve(e.value.v).then(c,u):l(o[0][2],e)}(i[e](t))}catch(e){l(o[0][3],e)}}function c(e){a("next",e)}function u(e){a("throw",e)}function l(e,t){e(t),o.shift(),o.length&&a(o[0][0],o[0][1])}}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;var Ve=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function We(e){return"function"==typeof e}function ze(e){return We(null==e?void 0:e.then)}function Qe(e){var t=e((function(e){Error.call(e),e.stack=(new Error).stack}));return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var He=Qe((function(e){return function(t){e(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}}));function Ye(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var Je=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}var t;return e.prototype.unsubscribe=function(){var e,t,n,r,i;if(!this.closed){this.closed=!0;var o=this._parentage;if(o)if(this._parentage=null,Array.isArray(o))try{for(var s=Ue(o),a=s.next();!a.done;a=s.next())a.value.remove(this)}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}else o.remove(this);var c=this.initialTeardown;if(We(c))try{c()}catch(e){i=e instanceof He?e.errors:[e]}var u=this._finalizers;if(u){this._finalizers=null;try{for(var l=Ue(u),d=l.next();!d.done;d=l.next()){var h=d.value;try{et(h)}catch(e){i=null!=i?i:[],e instanceof He?i=qe(qe([],Be(i)),Be(e.errors)):i.push(e)}}}catch(e){n={error:e}}finally{try{d&&!d.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}}if(i)throw new He(i)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)et(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&Ye(t,e)},e.prototype.remove=function(t){var n=this._finalizers;n&&Ye(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=((t=new e).closed=!0,t),e}(),Xe=Je.EMPTY;function Ze(e){return e instanceof Je||e&&"closed"in e&&We(e.remove)&&We(e.add)&&We(e.unsubscribe)}function et(e){We(e)?e():e.unsubscribe()}var tt=null,nt=null,rt=void 0,it=!1,ot=!1,st={setTimeout:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=st.delegate;return(null==i?void 0:i.setTimeout)?i.setTimeout.apply(i,qe([e,t],Be(n))):setTimeout.apply(void 0,qe([e,t],Be(n)))},clearTimeout:function(e){var t=st.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function at(e){st.setTimeout((function(){if(!tt)throw e;tt(e)}))}function ct(){}var ut=lt("C",void 0,void 0);function lt(e,t,n){return{kind:e,value:t,error:n}}var dt=null;function ht(e){if(it){var t=!dt;if(t&&(dt={errorThrown:!1,error:null}),e(),t){var n=dt,r=n.errorThrown,i=n.error;if(dt=null,r)throw i}}else e()}var pt=function(e){function t(t){var n=e.call(this)||this;return n.isStopped=!1,t?(n.destination=t,Ze(t)&&t.add(n)):n.destination=wt,n}return Fe(t,e),t.create=function(e,t,n){return new gt(e,t,n)},t.prototype.next=function(e){this.isStopped?bt(function(e){return lt("N",e,void 0)}(e),this):this._next(e)},t.prototype.error=function(e){this.isStopped?bt(lt("E",void 0,e),this):(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped?bt(ut,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(Je),ft=Function.prototype.bind;function yt(e,t){return ft.call(e,t)}var mt=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){vt(e)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){vt(e)}else vt(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){vt(e)}},e}(),gt=function(e){function t(t,n,r){var i,o,s=e.call(this)||this;return We(t)||!t?i={next:null!=t?t:void 0,error:null!=n?n:void 0,complete:null!=r?r:void 0}:s&&ot?((o=Object.create(t)).unsubscribe=function(){return s.unsubscribe()},i={next:t.next&&yt(t.next,o),error:t.error&&yt(t.error,o),complete:t.complete&&yt(t.complete,o)}):i=t,s.destination=new mt(i),s}return Fe(t,e),t}(pt);function vt(e){var t;it?(t=e,it&&dt&&(dt.errorThrown=!0,dt.error=t)):at(e)}function bt(e,t){var n=nt;n&&st.setTimeout((function(){return n(e,t)}))}var wt={closed:!0,next:ct,error:function(e){throw e},complete:ct},St="function"==typeof Symbol&&Symbol.observable||"@@observable";function At(e){return e}function Et(e){return 0===e.length?At:1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}}var It=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var r,i=this,o=(r=e)&&r instanceof pt||function(e){return e&&We(e.next)&&We(e.error)&&We(e.complete)}(r)&&Ze(r)?e:new gt(e,t,n);return ht((function(){var e=i,t=e.operator,n=e.source;o.add(t?t.call(o,n):n?i._subscribe(o):i._trySubscribe(o))})),o},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=Tt(t))((function(t,r){var i=new gt({next:function(t){try{e(t)}catch(e){r(e),i.unsubscribe()}},error:r,complete:t});n.subscribe(i)}))},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[St]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Et(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=Tt(e))((function(e,n){var r;t.subscribe((function(e){return r=e}),(function(e){return n(e)}),(function(){return e(r)}))}))},e.create=function(t){return new e(t)},e}();function Tt(e){var t;return null!==(t=null!=e?e:rt)&&void 0!==t?t:Promise}function Ct(e){return We(e[St])}function Nt(e){return Symbol.asyncIterator&&We(null==e?void 0:e[Symbol.asyncIterator])}function Ot(e){return new TypeError("You provided "+(null!==e&&"object"==typeof e?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}var _t="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function kt(e){return We(null==e?void 0:e[_t])}function xt(e){return Ge(this,arguments,(function(){var t,n,r;return je(this,(function(i){switch(i.label){case 0:t=e.getReader(),i.label=1;case 1:i.trys.push([1,,9,10]),i.label=2;case 2:return[4,Ke(t.read())];case 3:return n=i.sent(),r=n.value,n.done?[4,Ke(void 0)]:[3,5];case 4:return[2,i.sent()];case 5:return[4,Ke(r)];case 6:return[4,i.sent()];case 7:return i.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}}))}))}function Pt(e){return We(null==e?void 0:e.getReader)}function Dt(e){if(e instanceof It)return e;if(null!=e){if(Ct(e))return i=e,new It((function(e){var t=i[St]();if(We(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")}));if(Ve(e))return r=e,new It((function(e){for(var t=0;t<r.length&&!e.closed;t++)e.next(r[t]);e.complete()}));if(ze(e))return n=e,new It((function(e){n.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,at)}));if(Nt(e))return Rt(e);if(kt(e))return t=e,new It((function(e){var n,r;try{for(var i=Ue(t),o=i.next();!o.done;o=i.next()){var s=o.value;if(e.next(s),e.closed)return}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}e.complete()}));if(Pt(e))return Rt(xt(e))}var t,n,r,i;throw Ot(e)}function Rt(e){return new It((function(t){(function(e,t){var n,r,i,o;return $e(this,void 0,void 0,(function(){var s,a;return je(this,(function(c){switch(c.label){case 0:c.trys.push([0,5,6,11]),n=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=Ue(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,i){!function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)}(r,i,(t=e[n](t)).done,t.value)}))}}}(e),c.label=1;case 1:return[4,n.next()];case 2:if((r=c.sent()).done)return[3,4];if(s=r.value,t.next(s),t.closed)return[2];c.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return a=c.sent(),i={error:a},[3,11];case 6:return c.trys.push([6,,9,10]),r&&!r.done&&(o=n.return)?[4,o.call(n)]:[3,8];case 7:c.sent(),c.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}}))}))})(e,t).catch((function(e){return t.error(e)}))}))}function Mt(e,t,n,r,i){return new Lt(e,t,n,r,i)}var Lt=function(e){function t(t,n,r,i,o,s){var a=e.call(this,t)||this;return a.onFinalize=o,a.shouldUnsubscribe=s,a._next=n?function(e){try{n(e)}catch(e){t.error(e)}}:e.prototype._next,a._error=i?function(e){try{i(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,a._complete=r?function(){try{r()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,a}return Fe(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;e.prototype.unsubscribe.call(this),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}},t}(pt);function Ft(e){return function(t){if(function(e){return We(null==e?void 0:e.lift)}(t))return t.lift((function(t){try{return e(t,this)}catch(e){this.error(e)}}));throw new TypeError("Unable to lift unknown Observable type")}}function $t(e){return Ft((function(t,n){var r,i=null,o=!1;i=t.subscribe(Mt(n,void 0,void 0,(function(s){r=Dt(e(s,$t(e)(t))),i?(i.unsubscribe(),i=null,r.subscribe(n)):o=!0}))),o&&(i.unsubscribe(),i=null,r.subscribe(n))}))}const jt=URL;var Ut,Bt,qt,Kt,Gt,Vt,Wt,zt,Qt,Ht,Yt,Jt,Xt;URLSearchParams,function(e){e.WebUnknown="0",e.React="1",e.NextJs="2",e.Angular="3",e.VueJs="4",e.Nuxt="5",e.Svelte="6",e.ServerSideUnknown="100",e.ReactSSR="101",e.NextJsSSR="102",e.AngularSSR="103",e.VueJsSSR="104",e.NuxtSSR="105",e.SvelteSSR="106",e.ReactNative="201",e.Expo="202"}(Ut||(Ut={})),function(e){e.API="api",e.Auth="auth",e.Analytics="analytics",e.DataStore="datastore",e.Geo="geo",e.InAppMessaging="inappmessaging",e.Interactions="interactions",e.Predictions="predictions",e.PubSub="pubsub",e.PushNotification="pushnotification",e.Storage="storage"}(Bt||(Bt={})),function(e){e.Record="1",e.IdentifyUser="2"}(qt||(qt={})),function(e){e.GraphQl="1",e.Get="2",e.Post="3",e.Put="4",e.Patch="5",e.Del="6",e.Head="7"}(Kt||(Kt={})),function(e){e.SignUp="1",e.ConfirmSignUp="2",e.ResendSignUpCode="3",e.SignIn="4",e.FetchMFAPreference="6",e.UpdateMFAPreference="7",e.SetUpTOTP="10",e.VerifyTOTPSetup="11",e.ConfirmSignIn="12",e.DeleteUserAttributes="15",e.DeleteUser="16",e.UpdateUserAttributes="17",e.FetchUserAttributes="18",e.ConfirmUserAttribute="22",e.SignOut="26",e.UpdatePassword="27",e.ResetPassword="28",e.ConfirmResetPassword="29",e.FederatedSignIn="30",e.RememberDevice="32",e.ForgetDevice="33",e.FetchDevices="34",e.SendUserAttributeVerificationCode="35",e.SignInWithRedirect="36"}(Gt||(Gt={})),function(e){e.Subscribe="1",e.GraphQl="2"}(Vt||(Vt={})),function(e){e.SearchByText="0",e.SearchByCoordinates="1",e.SearchForSuggestions="2",e.SearchByPlaceId="3",e.SaveGeofences="4",e.GetGeofence="5",e.ListGeofences="6",e.DeleteGeofences="7"}(Wt||(Wt={})),function(e){e.SyncMessages="1",e.IdentifyUser="2",e.NotifyMessageInteraction="3"}(zt||(zt={})),function(e){e.None="0"}(Qt||(Qt={})),function(e){e.Convert="1",e.Identify="2",e.Interpret="3"}(Ht||(Ht={})),function(e){e.Subscribe="1"}(Yt||(Yt={})),function(e){e.InitializePushNotifications="1",e.IdentifyUser="2"}(Jt||(Jt={})),function(e){e.UploadData="1",e.DownloadData="2",e.List="3",e.Copy="4",e.Remove="5",e.GetProperties="6",e.GetUrl="7"}(Xt||(Xt={}));const Zt=()=>"undefined"!=typeof global,en=()=>"undefined"!=typeof window,tn=()=>"undefined"!=typeof document,nn=()=>"undefined"!=typeof process,rn=(e,t)=>!!Object.keys(e).find((e=>e.startsWith(t))),on=[{platform:Ut.Expo,detectionMethod:function(){return Zt()&&void 0!==global.expo}},{platform:Ut.ReactNative,detectionMethod:function(){return"undefined"!=typeof navigator&&void 0!==navigator.product&&"ReactNative"===navigator.product}},{platform:Ut.NextJs,detectionMethod:function(){return en()&&window.next&&"object"==typeof window.next}},{platform:Ut.Nuxt,detectionMethod:function(){return en()&&(void 0!==window.__NUXT__||void 0!==window.$nuxt)}},{platform:Ut.Angular,detectionMethod:function(){const e=Boolean(tn()&&document.querySelector("[ng-version]")),t=Boolean(en()&&void 0!==window.ng);return e||t}},{platform:Ut.React,detectionMethod:function(){const e=e=>e.startsWith("_react")||e.startsWith("__react");return tn()&&Array.from(document.querySelectorAll("[id]")).some((t=>Object.keys(t).find(e)))}},{platform:Ut.VueJs,detectionMethod:function(){return en()&&rn(window,"__VUE")}},{platform:Ut.Svelte,detectionMethod:function(){return en()&&rn(window,"__SVELTE")}},{platform:Ut.WebUnknown,detectionMethod:function(){return en()}},{platform:Ut.NextJsSSR,detectionMethod:function(){return Zt()&&(rn(global,"__next")||rn(global,"__NEXT"))}},{platform:Ut.NuxtSSR,detectionMethod:function(){return Zt()&&void 0!==global.__NUXT_PATHS__}},{platform:Ut.ReactSSR,detectionMethod:function(){return nn()&&void 0!==process.env&&!!Object.keys(process.env).find((e=>e.includes("react")))}},{platform:Ut.VueJsSSR,detectionMethod:function(){return Zt()&&rn(global,"__VUE")}},{platform:Ut.AngularSSR,detectionMethod:function(){return nn()&&"object"==typeof process.env&&process.env.npm_lifecycle_script?.startsWith("ng ")||!1}},{platform:Ut.SvelteSSR,detectionMethod:function(){return nn()&&void 0!==process.env&&!!Object.keys(process.env).find((e=>e.includes("svelte")))}}];let sn;const an=[];let cn=!1;const un=()=>{if(!sn){if(sn=on.find((e=>e.detectionMethod()))?.platform||Ut.ServerSideUnknown,cn)for(;an.length;)an.pop()?.();else an.forEach((e=>{e()}));dn(Ut.ServerSideUnknown,10),dn(Ut.WebUnknown,10)}return sn},ln=e=>{cn||an.push(e)};function dn(e,t){sn!==e||cn||setTimeout((()=>{sn=void 0,cn=!0,setTimeout(un,1e3)}),t)}const hn={};new class{constructor(){this.userAgent="aws-amplify/6.0.27"}get framework(){return un()}get isReactNative(){return this.framework===Ut.ReactNative||this.framework===Ut.Expo}observeFrameworkChanges(e){ln(e)}};const pn=e=>(({category:e,action:t}={})=>{const n=[["aws-amplify","6.0.27"]];if(e&&n.push([e,t]),n.push(["framework",un()]),e&&t){const r=((e,t)=>hn[e]?.[t]?.additionalDetails)(e,t);r&&r.forEach((e=>{n.push(e)}))}return n})(e).map((([e,t])=>e&&t?`${e}/${t}`:e)).join(" ");class fn extends Error{constructor({message:e,name:t,recoverySuggestion:n,underlyingError:r}){super(e),this.name=t,this.underlyingError=r,this.recoverySuggestion=n,this.constructor=fn,Object.setPrototypeOf(this,fn.prototype)}}class yn extends fn{get response(){return this._response?mn(this._response):void 0}constructor(e){super(e),this.constructor=yn,Object.setPrototypeOf(this,yn.prototype),e.response&&(this._response=e.response)}}const mn=e=>({...e,headers:{...e.headers}});class gn extends yn{constructor(e){super(e),this.constructor=gn,Object.setPrototypeOf(this,gn.prototype)}}class vn extends gn{constructor(e={}){super({name:"CanceledError",message:"Request is canceled by user",...e}),this.constructor=vn,Object.setPrototypeOf(this,vn.prototype)}}const bn=e=>!!e&&e instanceof vn;var wn;(wn||(wn={})).InvalidApiName="InvalidApiName",wn.InvalidApiName;const Sn=e=>{const{headers:t,statusCode:n}=e;return{...An(e)?e.$metadata:{},httpStatusCode:n,requestId:t["x-amzn-requestid"]??t["x-amzn-request-id"]??t["x-amz-request-id"],extendedRequestId:t["x-amz-id-2"],cfId:t["x-amz-cf-id"]}},An=e=>"object"==typeof e?.$metadata,En=async e=>{if(!e||e.statusCode<300)return;const t=await In(e),n=(e=>{const[t]=e.toString().split(/[,:]+/);return t.includes("#")?t.split("#")[1]:t})(e.headers["x-amzn-errortype"]??t.code??t.__type??"UnknownError"),r=t.message??t.Message??"Unknown error",i=new Error(r);return Object.assign(i,{name:n,$metadata:Sn(e)})},In=async e=>{if(!e.body)throw new Error("Missing response payload");const t=await e.body.json();return Object.assign(t,{$metadata:Sn(e)})},Tn=async e=>{if(!e)return;const t=await En(Cn(e));if(t){const n=await(e.body?.text());return Nn(t,{statusCode:e.statusCode,headers:e.headers,body:n})}},Cn=e=>{let t;const n=new Proxy(e.body,{get:(e,n,r)=>"json"===n?async()=>{t||(t=e.text());try{return JSON.parse(await t)}catch(e){return{}}}:"text"===n?async()=>(t||(t=e.text()),t):Reflect.get(e,n,r)});return new Proxy(e,{get:(e,t,r)=>"body"===t?n:Reflect.get(e,t,r)})},Nn=(e,t)=>{const n=new gn({name:e?.name,message:e.message,underlyingError:e,response:t});return Object.assign(n,{$metadata:e.$metadata})};var On;!function(e){e.DEBUG="DEBUG",e.ERROR="ERROR",e.INFO="INFO",e.WARN="WARN",e.VERBOSE="VERBOSE",e.NONE="NONE"}(On||(On={}));const _n={VERBOSE:1,DEBUG:2,INFO:3,WARN:4,ERROR:5,NONE:6};class kn{constructor(e,t=On.WARN){this.name=e,this.level=t,this._pluggables=[]}_padding(e){return e<10?"0"+e:""+e}_ts(){const e=new Date;return[this._padding(e.getMinutes()),this._padding(e.getSeconds())].join(":")+"."+e.getMilliseconds()}configure(e){return e?(this._config=e,this._config):this._config}_log(e,...t){let n=this.level;if(kn.LOG_LEVEL&&(n=kn.LOG_LEVEL),"undefined"!=typeof window&&window.LOG_LEVEL&&(n=window.LOG_LEVEL),!(_n[e]>=_n[n]))return;let r=console.log.bind(console);e===On.ERROR&&console.error&&(r=console.error.bind(console)),e===On.WARN&&console.warn&&(r=console.warn.bind(console)),kn.BIND_ALL_LOG_LEVELS&&(e===On.INFO&&console.info&&(r=console.info.bind(console)),e===On.DEBUG&&console.debug&&(r=console.debug.bind(console)));const i=`[${e}] ${this._ts()} ${this.name}`;let o="";if(1===t.length&&"string"==typeof t[0])o=`${i} - ${t[0]}`,r(o);else if(1===t.length)o=`${i} ${t[0]}`,r(i,t[0]);else if("string"==typeof t[0]){let e=t.slice(1);1===e.length&&(e=e[0]),o=`${i} - ${t[0]} ${e}`,r(`${i} - ${t[0]}`,e)}else o=`${i} ${t}`,r(i,t);for(const e of this._pluggables){const t={message:o,timestamp:Date.now()};e.pushLogs([t])}}log(...e){this._log(On.INFO,...e)}info(...e){this._log(On.INFO,...e)}warn(...e){this._log(On.WARN,...e)}error(...e){this._log(On.ERROR,...e)}debug(...e){this._log(On.DEBUG,...e)}verbose(...e){this._log(On.VERBOSE,...e)}addPluggable(e){e&&"Logging"===e.getCategoryName()&&(this._pluggables.push(e),e.configure(this._config))}listPluggables(){return this._pluggables}}kn.LOG_LEVEL=null,kn.BIND_ALL_LOG_LEVELS=!1;const xn=new kn("RestApis"),Pn=["AuthFailure","InvalidSignatureException","RequestExpired","RequestInTheFuture","RequestTimeTooSkewed","SignatureDoesNotMatch","BadRequestException"],Dn=e=>async(t,n)=>{const r=n??await e(t)??void 0,i=r?.code||r?.name,o=t?.statusCode;return Fn(n)||Ln(o,i)||(e=>!!e&&Pn.includes(e))(i)||$n(o,i)},Rn=["BandwidthLimitExceeded","EC2ThrottledException","LimitExceededException","PriorRequestNotComplete","ProvisionedThroughputExceededException","RequestLimitExceeded","RequestThrottled","RequestThrottledException","SlowDown","ThrottledException","Throttling","ThrottlingException","TooManyRequestsException"],Mn=["TimeoutError","RequestTimeout","RequestTimeoutException"],Ln=(e,t)=>429===e||!!t&&Rn.includes(t),Fn=e=>"Network error"===e?.name,$n=(e,t)=>!!e&&[500,502,503,504].includes(e)||!!t&&Mn.includes(t);function jn(e=3e5){return t=>{const n=2**t*100+100*Math.random();return!(n>e)&&n}}const Un=3e5,Bn=e=>{const t=jn(Un)(e);return!1===t?Un:t},qn=({maxAttempts:e=3,retryDecider:t,computeDelay:n,abortSignal:r})=>{if(e<1)throw new Error("maxAttempts must be greater than 0");return(i,o)=>async function(s){let a,c,u=o.attemptsCount??0;const l=()=>{if(c)return Gn(c,u),c;throw Gn(a,u),a};for(;!r?.aborted&&u<e;){try{c=await i(s),a=void 0}catch(e){a=e,c=void 0}if(u=(o.attemptsCount??0)>u?o.attemptsCount??0:u+1,o.attemptsCount=u,!await t(c,a))return l();if(!r?.aborted&&u<e){const e=n(u);await Kn(e,r)}}if(r?.aborted)throw new Error("Request aborted.");return l()}},Kn=(e,t)=>{if(t?.aborted)return Promise.resolve();let n,r;const i=new Promise((t=>{r=t,n=setTimeout(t,e)}));return t?.addEventListener("abort",(function e(i){clearTimeout(n),t?.removeEventListener("abort",e),r()})),i},Gn=(e,t)=>{"[object Object]"===Object.prototype.toString.call(e)&&(e.$metadata={...e.$metadata??{},attempts:t})},Vn=e=>Object.keys(e).map((e=>e.toLowerCase())).sort().join(";"),Wn="X-Amz-Date".toLowerCase(),zn="X-Amz-Security-Token".toLowerCase(),Qn="AWS4-HMAC-SHA256";var Hn=64,Yn=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Jn=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],Xn=Math.pow(2,53)-1,Zn=function(){function e(){this.state=Int32Array.from(Jn),this.temp=new Int32Array(64),this.buffer=new Uint8Array(64),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}return e.prototype.update=function(e){if(this.finished)throw new Error("Attempted to update an already finished hash.");var t=0,n=e.byteLength;if(this.bytesHashed+=n,8*this.bytesHashed>Xn)throw new Error("Cannot hash more than 2^53 - 1 bits");for(;n>0;)this.buffer[this.bufferLength++]=e[t++],n--,this.bufferLength===Hn&&(this.hashBuffer(),this.bufferLength=0)},e.prototype.digest=function(){if(!this.finished){var e=8*this.bytesHashed,t=new DataView(this.buffer.buffer,this.buffer.byteOffset,this.buffer.byteLength),n=this.bufferLength;if(t.setUint8(this.bufferLength++,128),n%Hn>=56){for(var r=this.bufferLength;r<Hn;r++)t.setUint8(r,0);this.hashBuffer(),this.bufferLength=0}for(r=this.bufferLength;r<56;r++)t.setUint8(r,0);t.setUint32(56,Math.floor(e/4294967296),!0),t.setUint32(60,e),this.hashBuffer(),this.finished=!0}var i=new Uint8Array(32);for(r=0;r<8;r++)i[4*r]=this.state[r]>>>24&255,i[4*r+1]=this.state[r]>>>16&255,i[4*r+2]=this.state[r]>>>8&255,i[4*r+3]=this.state[r]>>>0&255;return i},e.prototype.hashBuffer=function(){for(var e=this.buffer,t=this.state,n=t[0],r=t[1],i=t[2],o=t[3],s=t[4],a=t[5],c=t[6],u=t[7],l=0;l<Hn;l++){if(l<16)this.temp[l]=(255&e[4*l])<<24|(255&e[4*l+1])<<16|(255&e[4*l+2])<<8|255&e[4*l+3];else{var d=this.temp[l-2],h=(d>>>17|d<<15)^(d>>>19|d<<13)^d>>>10,p=((d=this.temp[l-15])>>>7|d<<25)^(d>>>18|d<<14)^d>>>3;this.temp[l]=(h+this.temp[l-7]|0)+(p+this.temp[l-16]|0)}var f=(((s>>>6|s<<26)^(s>>>11|s<<21)^(s>>>25|s<<7))+(s&a^~s&c)|0)+(u+(Yn[l]+this.temp[l]|0)|0)|0,y=((n>>>2|n<<30)^(n>>>13|n<<19)^(n>>>22|n<<10))+(n&r^n&i^r&i)|0;u=c,c=a,a=s,s=o+f|0,o=i,i=r,r=n,n=f+y|0}t[0]+=n,t[1]+=r,t[2]+=i,t[3]+=o,t[4]+=s,t[5]+=a,t[6]+=c,t[7]+=u},e}(),er="undefined"!=typeof Buffer&&Buffer.from?function(e){return Buffer.from(e,"utf8")}:e=>(new TextEncoder).encode(e);function tr(e){return e instanceof Uint8Array?e:"string"==typeof e?er(e):ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e)}var nr=function(){function e(e){this.secret=e,this.hash=new Zn,this.reset()}return e.prototype.update=function(e){var t;if(("string"==typeof(t=e)?0!==t.length:0!==t.byteLength)&&!this.error)try{this.hash.update(tr(e))}catch(e){this.error=e}},e.prototype.digestSync=function(){if(this.error)throw this.error;return this.outer?(this.outer.finished||this.outer.update(this.hash.digest()),this.outer.digest()):this.hash.digest()},e.prototype.digest=function(){return $e(this,void 0,void 0,(function(){return je(this,(function(e){return[2,this.digestSync()]}))}))},e.prototype.reset=function(){if(this.hash=new Zn,this.secret){this.outer=new Zn;var e=function(e){var t=tr(e);if(t.byteLength>Hn){var n=new Zn;n.update(t),t=n.digest()}var r=new Uint8Array(Hn);return r.set(t),r}(this.secret),t=new Uint8Array(Hn);t.set(e);for(var n=0;n<Hn;n++)e[n]^=54,t[n]^=92;for(this.hash.update(e),this.outer.update(t),n=0;n<e.byteLength;n++)e[n]=0}},e}();const rr={},ir={};for(let e=0;e<256;e++){let t=e.toString(16).toLowerCase();1===t.length&&(t=`0${t}`),rr[e]=t,ir[t]=e}const or=(e,t)=>{const n=new nr(e??void 0);return n.update(t),n.digestSync()},sr=(e,t)=>function(e){let t="";for(let n=0;n<e.byteLength;n++)t+=rr[e[n]];return t}(or(e,t)),ar=e=>Object.entries(e).map((([e,t])=>({key:e.toLowerCase(),value:t?.trim().replace(/\s+/g," ")??""}))).sort(((e,t)=>e.key<t.key?-1:1)).map((e=>`${e.key}:${e.value}\n`)).join(""),cr=e=>encodeURIComponent(e).replace(/[!'()*]/g,ur),ur=e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`,lr=(e,t=!0)=>e?t?encodeURIComponent(e).replace(/%2F/g,"/"):e:"/",dr=e=>null==e?"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855":hr(e)?sr(null,e):"UNSIGNED-PAYLOAD",hr=e=>"string"==typeof e||ArrayBuffer.isView(e)||pr(e),pr=e=>"function"==typeof ArrayBuffer&&e instanceof ArrayBuffer||"[object ArrayBuffer]"===Object.prototype.toString.call(e),fr=(e,t)=>{const n=(({credentials:e,signingDate:t=new Date,signingRegion:n,signingService:r,uriEscapePath:i=!0})=>{const{accessKeyId:o,secretAccessKey:s,sessionToken:a}=e,{longDate:c,shortDate:u}=(e=>{const t=e.toISOString().replace(/[:-]|\.\d{3}/g,"");return{longDate:t,shortDate:t.slice(0,8)}})(t);return{accessKeyId:o,credentialScope:`${u}/${n}/${r}/aws4_request`,longDate:c,secretAccessKey:s,sessionToken:a,shortDate:u,signingRegion:n,signingService:r,uriEscapePath:i}})(t),{accessKeyId:r,credentialScope:i,longDate:o,sessionToken:s}=n,a={...e.headers};a.host=e.url.host,a[Wn]=o,s&&(a[zn]=s);const c={...e,headers:a},u=((e,{credentialScope:t,longDate:n,secretAccessKey:r,shortDate:i,signingRegion:o,signingService:s,uriEscapePath:a})=>{const c=(({body:e,headers:t,method:n,url:r},i=!0)=>{return[n,lr(r.pathname,i),(o=r.searchParams,Array.from(o).sort((([e,t],[n,r])=>e===n?t<r?-1:1:e<n?-1:1)).map((([e,t])=>`${cr(e)}=${cr(t)}`)).join("&")),ar(t),Vn(t),dr(e)].join("\n");var o})(e,a),u=((e,t,n)=>[Qn,e,t,n].join("\n"))(n,t,sr(null,c)),l=sr(((e,t,n,r)=>{const i=or(`AWS4${e}`,t),o=or(i,n),s=or(o,r);return or(s,"aws4_request")})(r,i,o,s),u);return l})(c,n),l=`Credential=${r}/${i}`,d=`SignedHeaders=${Vn(a)}`,h=`Signature=${u}`;return a.authorization=`${Qn} ${l}, ${d}, ${h}`,c},yr=e=>new Date(Date.now()+e),mr=({userAgentHeader:e="x-amz-user-agent",userAgentValue:t=""})=>n=>async function(r){if(0===t.trim().length)return await n(r);{const i=e.toLowerCase();return r.headers[i]=r.headers[i]?`${r.headers[i]} ${t}`:t,await n(r)}},gr=(e,t)=>(n,r)=>{const i={};let o=t=>e(t,r);for(let e=t.length-1;e>=0;e--)o=(0,t[e])(r)(o,i);return o(n)},vr=e=>{let t;return()=>(t||(t=e()),t)},br=e=>!["HEAD","GET","DELETE"].includes(e.toUpperCase()),wr=async({url:e,method:t,headers:n,body:r},{abortSignal:i,cache:o,withCrossDomainCredentials:s})=>{let a;try{a=await fetch(e,{method:t,headers:n,body:br(t)?r:void 0,signal:i,cache:o,credentials:s?"include":"same-origin"})}catch(e){if(e instanceof TypeError)throw new Error("Network error");throw e}const c={};return a.headers?.forEach(((e,t)=>{c[t.toLowerCase()]=e})),{statusCode:a.status,headers:c,body:null,body:Object.assign(a.body??{},{text:vr((()=>a.text())),blob:vr((()=>a.blob())),json:vr((()=>a.json()))})}},Sr=gr(wr,[mr,qn,({credentials:e,region:t,service:n,uriEscapePath:r=!0})=>{let i;return o=>async function(s){i=i??0;const a={credentials:"function"==typeof e?await e():e,signingDate:yr(i),signingRegion:t,signingService:n,uriEscapePath:r},c=await fr(s,a),u=await o(c),l=(({headers:e}={})=>e?.date??e?.Date??e?.["x-amz-date"])(u);return l&&(i=((e,t)=>((e,t)=>Math.abs(yr(t).getTime()-e)>=3e5)(e,t)?e-Date.now():t)(Date.parse(l),i)),u}}]),Ar=gr(wr,[mr,qn]),Er="execute-api",Ir="us-east-1",Tr=/^.+\.([a-z0-9-]+)\.([a-z0-9-]+)\.amazonaws\.com/,Cr=({headers:e},t)=>!e.authorization&&!e["x-api-key"]&&!!t,Nr=async e=>{try{const{credentials:t}=await e.Auth.fetchAuthSession();if(t)return t}catch(e){xn.debug("No credentials available, the request will be unsigned.")}return null},Or=new WeakMap,_r=(e,{url:t,options:n,abortController:r})=>{const i=r??new AbortController,o=function(e,t){const n=e=>!!t,r=new AbortController,i=r.signal,o=t?.signal;let s;const a=async()=>{try{const t=await(n(),e());if(t.statusCode>=300)throw await Tn(t);return t}catch(e){const t=o??i,n=s??t.reason;if("AbortError"===e.name||!0===t?.aborted){const t=new vn({...n&&{message:n},underlyingError:e,recoverySuggestion:"The API request was explicitly canceled. If this is not intended, validate if you called the `cancel()` function on the API request erroneously."});throw xn.debug(e),t}throw xn.debug(e),e}};if(n())return a();{const e=e=>{!0!==i.aborted&&(r.abort(e),e&&i.reason!==e&&(s=e))};return{response:a(),cancel:e}}}((async()=>(async(e,t,n)=>{const{url:r,method:i,headers:o,body:s,withCredentials:a,abortSignal:c}=t,u=s?s instanceof FormData?s:JSON.stringify(s??""):void 0,l=((e,t)=>{const n={};for(const t in e)n[t.toLowerCase()]=e[t];return t&&(n["content-type"]="application/json; charset=UTF-8",t instanceof FormData&&delete n["content-type"]),n})(o,s),d={url:r,headers:l,method:i,body:u},h={retryDecider:Dn(Tn),computeDelay:Bn,withCrossDomainCredentials:a,abortSignal:c},p=Cr(d,n);let f;const y=await Nr(e);if(p&&y){const e=((e,t)=>{const{service:n=Er,region:r=Ir}={},{hostname:i}=e,[,o,s]=Tr.exec(i)??[];return o===Er?{service:o,region:s??r}:"appsync-api"===o?{service:"appsync",region:s??r}:{service:n,region:r}})(r),t=n?.service??e.service,i=n?.region??e.region;f=await Sr(d,{...h,credentials:y,region:i,service:t})}else f=await Ar(d,{...h});return{statusCode:f.statusCode,headers:f.headers,body:f.body}})(e,{url:t,method:"POST",...n,abortSignal:i.signal},n?.signingServiceInfo)),i),s=o.finally((()=>{Or.delete(s)}));return s},kr=(e,t)=>{const n=Or.get(e);return!!n&&(n.abort(t),t&&n.signal.reason!==t&&(n.signal.reason=t),!0)},xr=(e,t)=>{Or.set(e,t)},Pr="undefined"!=typeof Symbol?Symbol("amplify_default"):"@@amplify_default",Dr=new kn("Hub");class Rr{constructor(e){this.listeners=new Map,this.protectedChannels=["core","auth","api","analytics","interactions","pubsub","storage","ui","xr"],this.name=e}_remove(e,t){const n=this.listeners.get(e);n?this.listeners.set(e,[...n.filter((({callback:e})=>e!==t))]):Dr.warn(`No listeners for ${e}`)}dispatch(e,t,n,r){"string"==typeof e&&this.protectedChannels.indexOf(e)>-1&&(r===Pr||Dr.warn(`WARNING: ${e} is protected and dispatching on it can have unintended consequences`));const i={channel:e,payload:{...t},source:n,patternInfo:[]};try{this._toListeners(i)}catch(e){Dr.error(e)}}listen(e,t,n="noname"){let r;if("function"!=typeof t)throw new fn({name:"NoHubcallbackProvidedException",message:"No callback supplied to Hub"});r=t;let i=this.listeners.get(e);return i||(i=[],this.listeners.set(e,i)),i.push({name:n,callback:r}),()=>{this._remove(e,r)}}_toListeners(e){const{channel:t,payload:n}=e,r=this.listeners.get(t);r&&r.forEach((r=>{Dr.debug(`Dispatching to ${t} with `,n);try{r.callback(e)}catch(e){Dr.error(e)}}))}}const Mr=new Rr("__default__"),Lr=(new Rr("internal-hub"),new kn("parseAWSExports")),Fr={API_KEY:"apiKey",AWS_IAM:"iam",AMAZON_COGNITO_USER_POOLS:"userPool",OPENID_CONNECT:"oidc",NONE:"none",AWS_LAMBDA:"lambda",LAMBDA:"lambda"},$r=(e={})=>{if(!Object.prototype.hasOwnProperty.call(e,"aws_project_region"))throw new fn({name:"InvalidParameterException",message:"Invalid config parameter.",recoverySuggestion:"Ensure passing the config object imported from  `amplifyconfiguration.json`."});const{aws_appsync_apiKey:t,aws_appsync_authenticationType:n,aws_appsync_graphqlEndpoint:r,aws_appsync_region:i,aws_bots_config:o,aws_cognito_identity_pool_id:s,aws_cognito_sign_up_verification_method:a,aws_cognito_mfa_configuration:c,aws_cognito_mfa_types:u,aws_cognito_password_protection_settings:l,aws_cognito_verification_mechanisms:d,aws_cognito_signup_attributes:h,aws_cognito_social_providers:p,aws_cognito_username_attributes:f,aws_mandatory_sign_in:y,aws_mobile_analytics_app_id:m,aws_mobile_analytics_app_region:g,aws_user_files_s3_bucket:v,aws_user_files_s3_bucket_region:b,aws_user_files_s3_dangerously_connect_to_http_endpoint_for_testing:w,aws_user_pools_id:S,aws_user_pools_web_client_id:A,geo:E,oauth:I,predictions:T,aws_cloud_logic_custom:C,Notifications:N,modelIntrospection:O}=e,_={};m&&(_.Analytics={Pinpoint:{appId:m,region:g}});const{InAppMessaging:k,Push:x}=N??{};if(k?.AWSPinpoint||x?.AWSPinpoint){if(k?.AWSPinpoint){const{appId:e,region:t}=k.AWSPinpoint;_.Notifications={InAppMessaging:{Pinpoint:{appId:e,region:t}}}}if(x?.AWSPinpoint){const{appId:e,region:t}=x.AWSPinpoint;_.Notifications={..._.Notifications,PushNotification:{Pinpoint:{appId:e,region:t}}}}}if(Array.isArray(o)&&(_.Interactions={LexV1:Object.fromEntries(o.map((e=>[e.name,e])))}),r){const e=Fr[n];e||Lr.debug(`Invalid authentication type ${n}. Falling back to IAM.`),_.API={GraphQL:{endpoint:r,apiKey:t,region:i,defaultAuthMode:e??"iam"}},O&&(_.API.GraphQL.modelIntrospection=O)}const P=c?{status:c&&c.toLowerCase(),totpEnabled:u?.includes("TOTP")??!1,smsEnabled:u?.includes("SMS")??!1}:void 0,D=l?{minLength:l.passwordPolicyMinLength,requireLowercase:l.passwordPolicyCharacters?.includes("REQUIRES_LOWERCASE")??!1,requireUppercase:l.passwordPolicyCharacters?.includes("REQUIRES_UPPERCASE")??!1,requireNumbers:l.passwordPolicyCharacters?.includes("REQUIRES_NUMBERS")??!1,requireSpecialCharacters:l.passwordPolicyCharacters?.includes("REQUIRES_SYMBOLS")??!1}:void 0,R=Array.from(new Set([...d??[],...h??[]])).reduce(((e,t)=>({...e,[t.toLowerCase()]:{required:!0}})),{}),M=f?.includes("EMAIL")??!1,L=f?.includes("PHONE_NUMBER")??!1;(s||S)&&(_.Auth={Cognito:{identityPoolId:s,allowGuestAccess:"enable"!==y,signUpVerificationMethod:a,userAttributes:R,userPoolClientId:A,userPoolId:S,mfa:P,passwordFormat:D,loginWith:{username:!(M||L),email:M,phone:L}}});const F=!!I&&Object.keys(I).length>0,$=!!p&&p.length>0;if(_.Auth&&F&&(_.Auth.Cognito.loginWith={..._.Auth.Cognito.loginWith,oauth:{...Ur(I),...$&&{providers:Br(p)}}}),v&&(_.Storage={S3:{bucket:v,region:b,dangerouslyConnectToHttpEndpointForTesting:w}}),E){const{amazon_location_service:e}=E;_.Geo=e?{LocationService:{...e,searchIndices:e.search_indices,region:e.region}}:{...E}}if(C&&(_.API={..._.API,REST:C.reduce(((e,t)=>{const{name:n,endpoint:r,region:i,service:o}=t;return{...e,[n]:{endpoint:r,...o?{service:o}:void 0,...i?{region:i}:void 0}}}),{})}),T){const{VoiceId:e}=T?.convert?.speechGenerator?.defaults??{};_.Predictions=e?{...T,convert:{...T.convert,speechGenerator:{...T.convert.speechGenerator,defaults:{voiceId:e}}}}:T}return _},jr=e=>e?.split(",")??[],Ur=({domain:e,scope:t,redirectSignIn:n,redirectSignOut:r,responseType:i})=>({domain:e,scopes:t,redirectSignIn:jr(n),redirectSignOut:jr(r),responseType:i}),Br=e=>e.map((e=>{const t=e.toLowerCase();return t.charAt(0).toUpperCase()+t.slice(1)})),qr=e=>{const t=Reflect.ownKeys(e);for(const n of t){const t=e[n];(t&&"object"==typeof t||"function"==typeof t)&&qr(t)}return Object.freeze(e)};function Kr({expiresAt:e,clockDrift:t}){return Date.now()+t>e}class Gr{configure(e,t){this.authConfig=e,this.authOptions=t}async fetchAuthSession(e={}){let t,n;const r=await this.getTokens(e);return r?(n=r.accessToken?.payload?.sub,t=await(this.authOptions?.credentialsProvider?.getCredentialsAndIdentityId({authConfig:this.authConfig,tokens:r,authenticated:!0,forceRefresh:e.forceRefresh}))):t=await(this.authOptions?.credentialsProvider?.getCredentialsAndIdentityId({authConfig:this.authConfig,authenticated:!1,forceRefresh:e.forceRefresh})),{tokens:r,credentials:t?.credentials,identityId:t?.identityId,userSub:n}}async clearCredentials(){await(this.authOptions?.credentialsProvider?.clearCredentialsAndIdentityId())}async getTokens(e){return await(this.authOptions?.tokenProvider?.getTokens(e))??void 0}}const Vr=Symbol("oauth-listener"),Wr=new class{constructor(){this.oAuthListener=void 0,this.resourcesConfig={},this.libraryOptions={},this.Auth=new Gr}configure(e,t){let n;n=Object.keys(e).some((e=>e.startsWith("aws_")))?$r(e):e,this.resourcesConfig=n,t&&(this.libraryOptions=t),this.resourcesConfig=qr(this.resourcesConfig),this.Auth.configure(this.resourcesConfig.Auth,this.libraryOptions.Auth),Mr.dispatch("core",{event:"configure",data:this.resourcesConfig},"Configure",Pr),this.notifyOAuthListener()}getConfig(){return this.resourcesConfig}[Vr](e){this.resourcesConfig.Auth?.Cognito.loginWith?.oauth?e(this.resourcesConfig.Auth?.Cognito):this.oAuthListener=e}notifyOAuthListener(){this.resourcesConfig.Auth?.Cognito.loginWith?.oauth&&this.oAuthListener&&(this.oAuthListener(this.resourcesConfig.Auth?.Cognito),this.oAuthListener=void 0)}},zr=e=>((e,t)=>e.Auth.fetchAuthSession(t))(Wr,e),Qr={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let Hr;const Yr=new Uint8Array(16);function Jr(){if(!Hr&&(Hr="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Hr))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Hr(Yr)}const Xr=[];for(let e=0;e<256;++e)Xr.push((e+256).toString(16).slice(1));const Zr=function(e,t,n){if(Qr.randomUUID&&!t&&!e)return Qr.randomUUID();const r=(e=e||{}).random||(e.rng||Jr)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=r[e];return t}return function(e,t=0){return Xr[e[t+0]]+Xr[e[t+1]]+Xr[e[t+2]]+Xr[e[t+3]]+"-"+Xr[e[t+4]]+Xr[e[t+5]]+"-"+Xr[e[t+6]]+Xr[e[t+7]]+"-"+Xr[e[t+8]]+Xr[e[t+9]]+"-"+Xr[e[t+10]]+Xr[e[t+11]]+Xr[e[t+12]]+Xr[e[t+13]]+Xr[e[t+14]]+Xr[e[t+15]]}(r)},ei=e=>e&&e.nonRetryable,ti=()=>{if("object"==typeof window&&"object"==typeof window.crypto)return window.crypto;if("object"==typeof crypto)return crypto;throw new fn({name:"MissingPolyfill",message:"Cannot resolve the `crypto` function from the environment."})},ni={convert(e,{urlSafe:t}={urlSafe:!1}){const n="string"==typeof e?e:function(e){return Array.from(e,(e=>String.fromCodePoint(e))).join("")}(e),r=(()=>{if("undefined"!=typeof window&&"function"==typeof window.btoa)return window.btoa;if("function"==typeof btoa)return btoa;throw new fn({name:"Base64EncoderError",message:"Cannot resolve the `btoa` function from the environment."})})()(n);return t?r.replace(/\+/g,"-").replace(/\//g,"_"):r}},ri=new kn("retryUtil");async function ii(e,t,n,r){if("function"!=typeof e)throw Error("functionToRetry must be a function");return new Promise((async(i,o)=>{let s,a,c=0,u=!1,l=()=>{};for(r&&r.then((()=>{u=!0,clearTimeout(s),l()}));!u;){c++,ri.debug(`${e.name} attempt #${c} with this vars: ${JSON.stringify(t)}`);try{return void i(await e(...t))}catch(r){if(a=r,ri.debug(`error on ${e.name}`,r),ei(r))return ri.debug(`${e.name} non retryable error`,r),void o(r);const i=n(c,t,r);if(ri.debug(`${e.name} retrying in ${i} ms`),!1===i||u)return void o(r);await new Promise((e=>{l=e,s=setTimeout(l,i)}))}}o(a)}))}const oi=(e,t,n=3e5,r)=>ii(e,t,jn(n),r);class si extends Error{constructor(){super(...arguments),this.nonRetryable=!0}}var ai,ci;!function(e){e.CONNECTION_CLOSED="Connection closed",e.CONNECTION_FAILED="Connection failed",e.REALTIME_SUBSCRIPTION_INIT_ERROR="AppSync Realtime subscription init error",e.SUBSCRIPTION_ACK="Subscription ack",e.TIMEOUT_DISCONNECT="Timeout disconnect"}(ai||(ai={})),function(e){e.Connected="Connected",e.ConnectedPendingNetwork="ConnectedPendingNetwork",e.ConnectionDisrupted="ConnectionDisrupted",e.ConnectionDisruptedPendingNetwork="ConnectionDisruptedPendingNetwork",e.Connecting="Connecting",e.ConnectedPendingDisconnect="ConnectedPendingDisconnect",e.Disconnected="Disconnected",e.ConnectedPendingKeepAlive="ConnectedPendingKeepAlive"}(ci||(ci={}));const ui=[400,401,403],li="ConnectionStateChange";var di,hi,pi;!function(e){e.GQL_CONNECTION_INIT="connection_init",e.GQL_CONNECTION_ERROR="connection_error",e.GQL_CONNECTION_ACK="connection_ack",e.GQL_START="start",e.GQL_START_ACK="start_ack",e.GQL_DATA="data",e.GQL_CONNECTION_KEEP_ALIVE="ka",e.GQL_STOP="stop",e.GQL_COMPLETE="complete",e.GQL_ERROR="error"}(di||(di={})),function(e){e[e.PENDING=0]="PENDING",e[e.CONNECTED=1]="CONNECTED",e[e.FAILED=2]="FAILED"}(hi||(hi={})),function(e){e[e.CLOSED=0]="CLOSED",e[e.READY=1]="READY",e[e.CONNECTING=2]="CONNECTING"}(pi||(pi={}));const fi={accept:"application/json, text/javascript","content-encoding":"amz-1.0","content-type":"application/json; charset=UTF-8"},yi=3e5;function mi(e,t){return Ft((function(n,r){var i=0;n.subscribe(Mt(r,(function(n){r.next(e.call(t,n,i++))})))}))}function gi(e,t){return Ft((function(n,r){var i=0;n.subscribe(Mt(r,(function(n){return e.call(t,n,i++)&&r.next(n)})))}))}function vi(e,t,n,r,i){void 0===r&&(r=0),void 0===i&&(i=!1);var o=t.schedule((function(){n(),i?e.add(this.schedule(null,r)):this.unsubscribe()}),r);if(e.add(o),!i)return o}function bi(e,t){return void 0===t&&(t=0),Ft((function(n,r){n.subscribe(Mt(r,(function(n){return vi(r,e,(function(){return r.next(n)}),t)}),(function(){return vi(r,e,(function(){return r.complete()}),t)}),(function(n){return vi(r,e,(function(){return r.error(n)}),t)})))}))}function wi(e,t){return void 0===t&&(t=0),Ft((function(n,r){r.add(e.schedule((function(){return n.subscribe(r)}),t))}))}function Si(e,t){if(!e)throw new Error("Iterable cannot be null");return new It((function(n){vi(n,t,(function(){var r=e[Symbol.asyncIterator]();vi(n,t,(function(){r.next().then((function(e){e.done?n.complete():n.next(e.value)}))}),0,!0)}))}))}function Ai(e,t){return t?function(e,t){if(null!=e){if(Ct(e))return function(e,t){return Dt(e).pipe(wi(t),bi(t))}(e,t);if(Ve(e))return function(e,t){return new It((function(n){var r=0;return t.schedule((function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())}))}))}(e,t);if(ze(e))return function(e,t){return Dt(e).pipe(wi(t),bi(t))}(e,t);if(Nt(e))return Si(e,t);if(kt(e))return function(e,t){return new It((function(n){var r;return vi(n,t,(function(){r=e[_t](),vi(n,t,(function(){var e,t,i;try{t=(e=r.next()).value,i=e.done}catch(e){return void n.error(e)}i?n.complete():n.next(t)}),0,!0)})),function(){return We(null==r?void 0:r.return)&&r.return()}}))}(e,t);if(Pt(e))return function(e,t){return Si(xt(e),t)}(e,t)}throw Ot(e)}(e,t):Dt(e)}const Ei=()=>{if("undefined"==typeof self)return!1;const e=self;return void 0!==e.WorkerGlobalScope&&self instanceof e.WorkerGlobalScope};class Ii{networkMonitor(e){const t=Ei()?self:"undefined"!=typeof window&&window;return t?new It((e=>{e.next({online:t.navigator.onLine});const n=()=>{e.next({online:!0})},r=()=>{e.next({online:!1})};return t.addEventListener("online",n),t.addEventListener("offline",r),Ii._observers.push(e),()=>{t.removeEventListener("online",n),t.removeEventListener("offline",r),Ii._observers=Ii._observers.filter((t=>t!==e))}})):Ai([{online:!0}])}static _observerOverride(e){for(const t of this._observers)t.closed?this._observers=this._observers.filter((e=>e!==t)):t?.next&&t.next(e)}}Ii._observers=[];const Ti=()=>(new Ii).networkMonitor(),Ci={KEEP_ALIVE_MISSED:{keepAliveState:"unhealthy"},KEEP_ALIVE:{keepAliveState:"healthy"},CONNECTION_ESTABLISHED:{connectionState:"connected"},CONNECTION_FAILED:{intendedConnectionState:"disconnected",connectionState:"disconnected"},CLOSING_CONNECTION:{intendedConnectionState:"disconnected"},OPENING_CONNECTION:{intendedConnectionState:"connected",connectionState:"connecting"},CLOSED:{connectionState:"disconnected"},ONLINE:{networkState:"connected"},OFFLINE:{networkState:"disconnected"}};class Ni{constructor(){this._networkMonitoringSubscription=void 0,this._linkedConnectionState={networkState:"connected",connectionState:"disconnected",intendedConnectionState:"disconnected",keepAliveState:"healthy"},this._initialNetworkStateSubscription=Ti().subscribe((({online:e})=>{this.record(e?Ci.ONLINE:Ci.OFFLINE),this._initialNetworkStateSubscription?.unsubscribe()})),this._linkedConnectionStateObservable=new It((e=>{e.next(this._linkedConnectionState),this._linkedConnectionStateObserver=e}))}enableNetworkMonitoring(){this._initialNetworkStateSubscription?.unsubscribe(),void 0===this._networkMonitoringSubscription&&(this._networkMonitoringSubscription=Ti().subscribe((({online:e})=>{this.record(e?Ci.ONLINE:Ci.OFFLINE)})))}disableNetworkMonitoring(){this._networkMonitoringSubscription?.unsubscribe(),this._networkMonitoringSubscription=void 0}get connectionStateObservable(){let e;return this._linkedConnectionStateObservable.pipe(mi((e=>this.connectionStatesTranslator(e)))).pipe(gi((t=>{const n=t!==e;return e=t,n})))}record(e){"connected"===e.intendedConnectionState?this.enableNetworkMonitoring():"disconnected"===e.intendedConnectionState&&this.disableNetworkMonitoring();const t={...this._linkedConnectionState,...e};this._linkedConnectionState={...t},this._linkedConnectionStateObserver?.next(this._linkedConnectionState)}connectionStatesTranslator({connectionState:e,networkState:t,intendedConnectionState:n,keepAliveState:r}){return"connected"===e&&"disconnected"===t?ci.ConnectedPendingNetwork:"connected"===e&&"disconnected"===n?ci.ConnectedPendingDisconnect:"disconnected"===e&&"connected"===n&&"disconnected"===t?ci.ConnectionDisruptedPendingNetwork:"disconnected"===e&&"connected"===n?ci.ConnectionDisrupted:"connected"===e&&"unhealthy"===r?ci.ConnectedPendingKeepAlive:"connecting"===e?ci.Connecting:"disconnected"===e?ci.Disconnected:ci.Connected}}var Oi;!function(e){e.START_RECONNECT="START_RECONNECT",e.HALT_RECONNECT="HALT_RECONNECT"}(Oi||(Oi={}));class _i{constructor(){this.reconnectObservers=[]}addObserver(e){this.reconnectObservers.push(e)}record(e){e===Oi.START_RECONNECT&&void 0===this.reconnectSetTimeoutId&&void 0===this.reconnectIntervalId&&(this.reconnectSetTimeoutId=setTimeout((()=>{this._triggerReconnect(),this.reconnectIntervalId=setInterval((()=>{this._triggerReconnect()}),6e4)}),5e3)),e===Oi.HALT_RECONNECT&&(this.reconnectIntervalId&&(clearInterval(this.reconnectIntervalId),this.reconnectIntervalId=void 0),this.reconnectSetTimeoutId&&(clearTimeout(this.reconnectSetTimeoutId),this.reconnectSetTimeoutId=void 0))}close(){this.reconnectObservers.forEach((e=>{e.complete?.()}))}_triggerReconnect(){this.reconnectObservers.forEach((e=>{e.next?.()}))}}const ki=new kn("AWSAppSyncRealTimeProvider"),xi=e=>{Mr.dispatch("api",e,"PubSub",Pr)},Pi=/^https:\/\/\w{26}\.appsync-api\.\w{2}(?:(?:-\w{2,})+)-\d\.amazonaws.com(?:\.cn)?\/graphql$/i;class Di{constructor(){this.socketStatus=pi.CLOSED,this.keepAliveTimeout=yi,this.subscriptionObserverMap=new Map,this.promiseArray=[],this.connectionStateMonitor=new Ni,this.reconnectionMonitor=new _i,this.connectionStateMonitorSubscription=this.connectionStateMonitor.connectionStateObservable.subscribe((e=>{xi({event:li,data:{provider:this,connectionState:e},message:`Connection state is ${e}`}),this.connectionState=e,e===ci.ConnectionDisrupted&&this.reconnectionMonitor.record(Oi.START_RECONNECT),[ci.Connected,ci.ConnectedPendingDisconnect,ci.ConnectedPendingKeepAlive,ci.ConnectedPendingNetwork,ci.ConnectionDisruptedPendingNetwork,ci.Disconnected].includes(e)&&this.reconnectionMonitor.record(Oi.HALT_RECONNECT)}))}close(){this.socketStatus=pi.CLOSED,this.connectionStateMonitor.record(Ci.CONNECTION_FAILED),this.connectionStateMonitorSubscription.unsubscribe(),this.reconnectionMonitor.close()}getNewWebSocket(e,t){return new WebSocket(e,t)}getProviderName(){return"AWSAppSyncRealTimeProvider"}isCustomDomain(e){return null===e.match(Pi)}subscribe(e,t){const{appSyncGraphqlEndpoint:n,region:r,query:i,variables:o,authenticationType:s,additionalHeaders:a,apiKey:c,authToken:u,libraryConfigHeaders:l}=e||{};return new It((d=>{if(e&&n){let e=!1;const h=Zr(),p=()=>{e||(e=!0,this._startSubscriptionWithAWSAppSyncRealTime({options:{query:i,variables:o,region:r,authenticationType:s,appSyncGraphqlEndpoint:n,additionalHeaders:a,apiKey:c,authToken:u,libraryConfigHeaders:l},observer:d,subscriptionId:h,customUserAgentDetails:t}).catch((e=>{ki.debug(`${ai.REALTIME_SUBSCRIPTION_INIT_ERROR}: ${e}`),this.connectionStateMonitor.record(Ci.CLOSED)})).finally((()=>{e=!1})))},f=new It((e=>{this.reconnectionMonitor.addObserver(e)})).subscribe((()=>{p()}));return p(),async()=>{f?.unsubscribe();try{await this._waitForSubscriptionToBeConnected(h);const{subscriptionState:e}=this.subscriptionObserverMap.get(h)||{};if(!e)return;if(e!==hi.CONNECTED)throw new Error("Subscription never connected");this._sendUnsubscriptionMessage(h)}catch(e){ki.debug(`Error while unsubscribing ${e}`)}finally{this._removeSubscriptionObserver(h)}}}d.error({errors:[{...new K("Subscribe only available for AWS AppSync endpoint")}]}),d.complete()}))}async _startSubscriptionWithAWSAppSyncRealTime({options:e,observer:t,subscriptionId:n,customUserAgentDetails:r}){const{appSyncGraphqlEndpoint:i,authenticationType:o,query:s,variables:a,apiKey:c,region:u,libraryConfigHeaders:l=(()=>({})),additionalHeaders:d={},authToken:h}=e;let p={};if("function"==typeof d){const e={url:i||"",queryString:s||""};p=await d(e)}else p=d;h&&(p={...p,Authorization:h});const f=hi.PENDING,y={query:s,variables:a};this.subscriptionObserverMap.set(n,{observer:t,query:s??"",variables:a??{},subscriptionState:f,startAckTimeoutId:void 0});const m=JSON.stringify(y),g={...await this._awsRealTimeHeaderBasedAuth({apiKey:c,appSyncGraphqlEndpoint:i,authenticationType:o,payload:m,canonicalUri:"",region:u,additionalCustomHeaders:p}),...await l(),...p,"x-amz-user-agent":pn(r)},v={id:n,payload:{data:m,extensions:{authorization:{...g}}},type:di.GQL_START},b=JSON.stringify(v);try{this.connectionStateMonitor.record(Ci.OPENING_CONNECTION),await this._initializeWebSocketConnection({apiKey:c,appSyncGraphqlEndpoint:i,authenticationType:o,region:u,additionalCustomHeaders:p})}catch(e){return void this._logStartSubscriptionError(n,t,e)}const{subscriptionFailedCallback:w,subscriptionReadyCallback:S}=this.subscriptionObserverMap.get(n)??{};this.subscriptionObserverMap.set(n,{observer:t,subscriptionState:f,query:s??"",variables:a??{},subscriptionReadyCallback:S,subscriptionFailedCallback:w,startAckTimeoutId:setTimeout((()=>{this._timeoutStartSubscriptionAck(n)}),15e3)}),this.awsRealTimeSocket&&this.awsRealTimeSocket.send(b)}_logStartSubscriptionError(e,t,n){ki.debug({err:n});const r=String(n.message??"");if(this.connectionStateMonitor.record(Ci.CLOSED),this.connectionState!==ci.ConnectionDisruptedPendingNetwork){ei(n)?t.error({errors:[{...new K(`${ai.CONNECTION_FAILED}: ${r}`)}]}):ki.debug(`${ai.CONNECTION_FAILED}: ${r}`);const{subscriptionFailedCallback:i}=this.subscriptionObserverMap.get(e)||{};"function"==typeof i&&i()}}async _waitForSubscriptionToBeConnected(e){const t=this.subscriptionObserverMap.get(e);if(t){const{subscriptionState:n}=t;if(n===hi.PENDING)return new Promise(((n,r)=>{const{observer:i,subscriptionState:o,variables:s,query:a}=t;this.subscriptionObserverMap.set(e,{observer:i,subscriptionState:o,variables:s,query:a,subscriptionReadyCallback:n,subscriptionFailedCallback:r})}))}}_sendUnsubscriptionMessage(e){try{if(this.awsRealTimeSocket&&this.awsRealTimeSocket.readyState===WebSocket.OPEN&&this.socketStatus===pi.READY){const t={id:e,type:di.GQL_STOP},n=JSON.stringify(t);this.awsRealTimeSocket.send(n)}}catch(e){ki.debug({err:e})}}_removeSubscriptionObserver(e){this.subscriptionObserverMap.delete(e),setTimeout(this._closeSocketIfRequired.bind(this),1e3)}_closeSocketIfRequired(){if(!(this.subscriptionObserverMap.size>0))if(this.awsRealTimeSocket)if(this.connectionStateMonitor.record(Ci.CLOSING_CONNECTION),this.awsRealTimeSocket.bufferedAmount>0)setTimeout(this._closeSocketIfRequired.bind(this),1e3);else{ki.debug("closing WebSocket..."),this.keepAliveTimeoutId&&clearTimeout(this.keepAliveTimeoutId),this.keepAliveAlertTimeoutId&&clearTimeout(this.keepAliveAlertTimeoutId);const e=this.awsRealTimeSocket;e.onclose=null,e.onerror=null,e.close(1e3),this.awsRealTimeSocket=void 0,this.socketStatus=pi.CLOSED,this.connectionStateMonitor.record(Ci.CLOSED)}else this.socketStatus=pi.CLOSED}_handleIncomingSubscriptionMessage(e){if("string"!=typeof e.data)return;ki.debug(`subscription message from AWS AppSync RealTime: ${e.data}`);const{id:t="",payload:n,type:r}=JSON.parse(String(e.data)),{observer:i=null,query:o="",variables:s={},startAckTimeoutId:a,subscriptionReadyCallback:c,subscriptionFailedCallback:u}=this.subscriptionObserverMap.get(t)||{};if(ki.debug({id:t,observer:i,query:o,variables:s}),r===di.GQL_DATA&&n&&n.data)i?i.next(n):ki.debug(`observer not found for id: ${t}`);else{if(r===di.GQL_START_ACK){ki.debug(`subscription ready for ${JSON.stringify({query:o,variables:s})}`),"function"==typeof c&&c(),a&&clearTimeout(a),xi({event:ai.SUBSCRIPTION_ACK,data:{query:o,variables:s},message:"Connection established for subscription"});const e=hi.CONNECTED;return i&&this.subscriptionObserverMap.set(t,{observer:i,query:o,variables:s,startAckTimeoutId:void 0,subscriptionState:e,subscriptionReadyCallback:c,subscriptionFailedCallback:u}),void this.connectionStateMonitor.record(Ci.CONNECTION_ESTABLISHED)}if(r===di.GQL_CONNECTION_KEEP_ALIVE)return this.keepAliveTimeoutId&&clearTimeout(this.keepAliveTimeoutId),this.keepAliveAlertTimeoutId&&clearTimeout(this.keepAliveAlertTimeoutId),this.keepAliveTimeoutId=setTimeout((()=>{this._errorDisconnect(ai.TIMEOUT_DISCONNECT)}),this.keepAliveTimeout),this.keepAliveAlertTimeoutId=setTimeout((()=>{this.connectionStateMonitor.record(Ci.KEEP_ALIVE_MISSED)}),65e3),void this.connectionStateMonitor.record(Ci.KEEP_ALIVE);if(r===di.GQL_ERROR){const e=hi.FAILED;i&&(this.subscriptionObserverMap.set(t,{observer:i,query:o,variables:s,startAckTimeoutId:a,subscriptionReadyCallback:c,subscriptionFailedCallback:u,subscriptionState:e}),ki.debug(`${ai.CONNECTION_FAILED}: ${JSON.stringify(n)}`),i.error({errors:[{...new K(`${ai.CONNECTION_FAILED}: ${JSON.stringify(n)}`)}]}),a&&clearTimeout(a),"function"==typeof u&&u())}}}_errorDisconnect(e){ki.debug(`Disconnect error: ${e}`),this.awsRealTimeSocket&&(this.connectionStateMonitor.record(Ci.CLOSED),this.awsRealTimeSocket.close()),this.socketStatus=pi.CLOSED}_timeoutStartSubscriptionAck(e){const t=this.subscriptionObserverMap.get(e);if(t){const{observer:n,query:r,variables:i}=t;if(!n)return;this.subscriptionObserverMap.set(e,{observer:n,query:r,variables:i,subscriptionState:hi.FAILED}),this.connectionStateMonitor.record(Ci.CLOSED),ki.debug("timeoutStartSubscription",JSON.stringify({query:r,variables:i}))}}_initializeWebSocketConnection({appSyncGraphqlEndpoint:e,authenticationType:t,apiKey:n,region:r,additionalCustomHeaders:i}){if(this.socketStatus!==pi.READY)return new Promise((async(o,s)=>{if(this.promiseArray.push({res:o,rej:s}),this.socketStatus===pi.CLOSED)try{this.socketStatus=pi.CONNECTING;const o="{}",s=await this._awsRealTimeHeaderBasedAuth({authenticationType:t,payload:o,canonicalUri:"/connect",apiKey:n,appSyncGraphqlEndpoint:e,region:r,additionalCustomHeaders:i}),a=s?JSON.stringify(s):"",c=ni.convert(a),u=ni.convert(o);let l=e??"";l=this.isCustomDomain(l)?l.concat("/realtime"):l.replace("appsync-api","appsync-realtime-api").replace("gogi-beta","grt-beta");const d="wss://";l=l.replace("https://",d).replace("http://",d);const h=`${l}?header=${c}&payload=${u}`;await this._initializeRetryableHandshake(h),this.promiseArray.forEach((({res:e})=>{ki.debug("Notifying connection successful"),e()})),this.socketStatus=pi.READY,this.promiseArray=[]}catch(e){ki.debug("Connection exited with",e),this.promiseArray.forEach((({rej:t})=>{t(e)})),this.promiseArray=[],this.awsRealTimeSocket&&this.awsRealTimeSocket.readyState===WebSocket.OPEN&&this.awsRealTimeSocket.close(3001),this.awsRealTimeSocket=void 0,this.socketStatus=pi.CLOSED}}))}async _initializeRetryableHandshake(e){ki.debug("Initializaling retryable Handshake"),await oi(this._initializeHandshake.bind(this),[e],5e3)}async _initializeHandshake(e){ki.debug(`Initializing handshake ${e}`);try{await(()=>new Promise(((t,n)=>{const r=this.getNewWebSocket(e,"graphql-ws");r.onerror=()=>{ki.debug("WebSocket connection error")},r.onclose=()=>{n(new Error("Connection handshake error"))},r.onopen=()=>{this.awsRealTimeSocket=r,t()}})))(),await(()=>new Promise(((e,t)=>{if(this.awsRealTimeSocket){let n=!1;this.awsRealTimeSocket.onerror=e=>{ki.debug(`WebSocket error ${JSON.stringify(e)}`)},this.awsRealTimeSocket.onclose=e=>{ki.debug(`WebSocket closed ${e.reason}`),t(new Error(JSON.stringify(e)))},this.awsRealTimeSocket.onmessage=r=>{if("string"!=typeof r.data)return;ki.debug(`subscription message from AWS AppSyncRealTime: ${r.data} `);const i=JSON.parse(r.data),{type:o,payload:{connectionTimeoutMs:s=yi}={}}=i;if(o===di.GQL_CONNECTION_ACK)return n=!0,this.awsRealTimeSocket&&(this.keepAliveTimeout=s,this.awsRealTimeSocket.onmessage=this._handleIncomingSubscriptionMessage.bind(this),this.awsRealTimeSocket.onerror=e=>{ki.debug(e),this._errorDisconnect(ai.CONNECTION_CLOSED)},this.awsRealTimeSocket.onclose=e=>{ki.debug(`WebSocket closed ${e.reason}`),this._errorDisconnect(ai.CONNECTION_CLOSED)}),void e("Cool, connected to AWS AppSyncRealTime");if(o===di.GQL_CONNECTION_ERROR){const{payload:{errors:[{errorType:e="",errorCode:n=0}={}]=[]}={}}=i;t({errorType:e,errorCode:n})}};const r={type:di.GQL_CONNECTION_INIT};this.awsRealTimeSocket.send(JSON.stringify(r));const i=e=>{e||(this.connectionStateMonitor.record(Ci.CONNECTION_FAILED),t(new Error("Connection timeout: ack from AWSAppSyncRealTime was not received after 15000 ms")))};setTimeout((()=>{i(n)}),15e3)}})))()}catch(e){const{errorType:t,errorCode:n}=e;throw ui.includes(n)?new si(t):t?new Error(t):e}}async _awsRealTimeHeaderBasedAuth({apiKey:e,authenticationType:t,payload:n,canonicalUri:r,appSyncGraphqlEndpoint:i,region:o,additionalCustomHeaders:s}){const a={apiKey:this._awsRealTimeApiKeyHeader.bind(this),iam:this._awsRealTimeIAMHeader.bind(this),oidc:this._awsAuthTokenHeader.bind(this),userPool:this._awsAuthTokenHeader.bind(this),lambda:this._customAuthHeader,none:this._customAuthHeader};if(t&&a[t]){const c=a[t],u=i?new jt(i).host:void 0;let l;return ki.debug(`Authenticating with ${JSON.stringify(t)}`),"apiKey"===t&&(l=e),await c({payload:n,canonicalUri:r,appSyncGraphqlEndpoint:i,apiKey:l,region:o,host:u,additionalCustomHeaders:s})}ki.debug(`Authentication type ${t} not supported`)}async _awsAuthTokenHeader({host:e}){return{Authorization:(await zr())?.tokens?.accessToken?.toString(),host:e}}async _awsRealTimeApiKeyHeader({apiKey:e,host:t}){return{host:t,"x-amz-date":(new Date).toISOString().replace(/[:-]|\.\d{3}/g,""),"x-api-key":e}}async _awsRealTimeIAMHeader({payload:e,canonicalUri:t,appSyncGraphqlEndpoint:n,region:r}){const i={region:r,service:"appsync"},o=(await zr()).credentials,s={url:`${n}${t}`,data:e,method:"POST",headers:{...fi}};return fr({headers:s.headers,method:s.method,url:new jt(s.url),body:s.data},{credentials:o,signingRegion:i.region,signingService:i.service}).headers}_customAuthHeader({host:e,additionalCustomHeaders:t}){if(!t?.Authorization)throw new Error("No auth token specified");return{Authorization:t.Authorization,host:e}}}class Ri extends fn{constructor(e){super(e),this.constructor=Ri,Object.setPrototypeOf(this,Ri.prototype)}}var Mi;!function(e){e.NoAuthSession="NoAuthSession",e.NoRegion="NoRegion",e.NoCustomEndpoint="NoCustomEndpoint"}(Mi||(Mi={}));const Li={[Mi.NoAuthSession]:{message:"Auth session should not be empty."},[Mi.NoRegion]:{message:"Missing region."},[Mi.NoCustomEndpoint]:{message:"Custom endpoint region is present without custom endpoint."}},Fi=new kn("GraphQLAPI resolveConfig"),$i=e=>{const t=e.getConfig();t.API?.GraphQL||Fi.warn("The API configuration is missing. This is likely due to Amplify.configure() not being called prior to generateClient().");const{apiKey:n,customEndpoint:r,customEndpointRegion:i,defaultAuthMode:o,endpoint:s,region:a}=t.API?.GraphQL??{};return function(e,t){const{message:n,recoverySuggestion:r}=Li[t];if(!e)throw new Ri({name:t,message:n,recoverySuggestion:r})}(!(!r&&i),Mi.NoCustomEndpoint),{apiKey:n,customEndpoint:r,customEndpointRegion:i,defaultAuthMode:o,endpoint:s,region:a}},ji=e=>{const t=e.libraryOptions?.API?.GraphQL?.headers,n=e.libraryOptions?.API?.GraphQL?.withCredentials;return{headers:t,withCredentials:n}};function Ui(e){return e.errors&&Array.isArray(e.errors)&&e.errors.forEach((e=>{var t;((t=e)?.originalError?.name?.startsWith("UnauthorizedException")||t.message?.startsWith("Connection failed:")&&t.message?.includes("Permission denied"))&&(e.message="Unauthorized",e.recoverySuggestion="If you're calling an Amplify-generated API, make sure to set the \"authMode\" in generateClient({ authMode: '...' }) to the backend authorization rule's auth provider ('apiKey', 'userPool', 'iam', 'oidc', 'lambda')")})),e}var Bi;!function(e){e.NO_API_KEY="No api-key configured",e.NO_CURRENT_USER="No current user",e.NO_CREDENTIALS="No credentials",e.NO_FEDERATED_JWT="No federated jwt",e.NO_AUTH_TOKEN="No auth token specified"}(Bi||(Bi={})),Symbol("amplify"),Symbol("authMode"),Symbol("authToken"),Symbol("headers");const qi={name:"NoApiKey",message:Bi.NO_API_KEY,recoverySuggestion:'The API request was made with `authMode: "apiKey"` but no API Key was passed into `Amplify.configure()`. Review if your API key is passed into the `Amplify.configure()` function.'},Ki={name:"NoCredentials",message:Bi.NO_CREDENTIALS,recoverySuggestion:'The API request was made with `authMode: "iam"` but no authentication credentials are available.\n\nIf you intended to make a request using an authenticated role, review if your user is signed in before making the request.\n\nIf you intend to make a request using an unauthenticated role or also known as "guest access", verify if "Auth.Cognito.allowGuestAccess" is set to "true" in the `Amplify.configure()` function.'},Gi={name:"NoValidAuthTokens",message:Bi.NO_FEDERATED_JWT,recoverySuggestion:"If you intended to make an authenticated API request, review if the current user is signed in."},Vi={name:"NoSignedUser",message:Bi.NO_CURRENT_USER,recoverySuggestion:"Review the underlying exception field for more details. If you intended to make an authenticated API request, review if the current user is signed in."},Wi={name:"NoAuthorizationHeader",message:Bi.NO_AUTH_TOKEN,recoverySuggestion:'The API request was made with `authMode: "lambda"` but no `authToken` is set. Review if a valid authToken is passed into the request options or in the `Amplify.configure()` function.'},zi={name:"NoEndpoint",message:"No GraphQL endpoint configured in `Amplify.configure()`.",recoverySuggestion:"Review if the GraphQL API endpoint is set in the `Amplify.configure()` function."},Qi=e=>({data:{},errors:[new K(e.message,null,null,null,null,e)]});class Hi{constructor(){this.appSyncRealTime=new Di,this._api={post:_r,cancelREST:kr,isCancelErrorREST:bn,updateRequestToBeCancellable:xr}}getModuleName(){return"InternalGraphQLAPI"}async _headerBasedAuth(e,t,n={}){const{apiKey:r}=$i(e);let i={};switch(t){case"apiKey":if(!r)throw new Ri(qi);i={"X-Api-Key":r};break;case"iam":if(void 0===(await e.Auth.fetchAuthSession()).credentials)throw new Ri(Ki);break;case"oidc":case"userPool":{let t;try{t=(await e.Auth.fetchAuthSession()).tokens?.accessToken.toString()}catch(e){throw new Ri({...Vi,underlyingError:e})}if(!t)throw new Ri(Gi);i={Authorization:t};break}case"lambda":if("object"==typeof n&&!n.Authorization)throw new Ri(Wi);i={Authorization:n.Authorization}}return i}getGraphqlOperationType(e){const t=we(e).definitions,[{operation:n}]=t;return n}graphql(e,{query:t,variables:n={},authMode:r,authToken:i},o,s){const a=we("string"==typeof t?t:Ne(t)),[c={}]=a.definitions.filter((e=>"OperationDefinition"===e.kind)),{operation:u}=c,l=o||{};switch(u){case"query":case"mutation":{const t=new AbortController;let o;return o=(e=>"function"!=typeof e)(e)?this._graphql(e,{query:a,variables:n,authMode:r},l,t,s,i):e((async e=>await this._graphql(e,{query:a,variables:n,authMode:r},l,t,s,i))),this._api.updateRequestToBeCancellable(o,t),o}case"subscription":return this._graphqlSubscribe(e,{query:a,variables:n,authMode:r},l,s,i);default:throw new Error(`invalid operation type: ${u}`)}}async _graphql(e,{query:t,variables:n,authMode:r},i={},o,s,a){const{region:c,endpoint:u,customEndpoint:l,customEndpointRegion:d,defaultAuthMode:h}=$i(e),p=r||h||"iam",{headers:f,withCredentials:y}=ji(e);let m;if("function"==typeof i){const e={method:"POST",url:new jt(l||u||"").toString(),queryString:Ne(t)};m=await i(e)}else m=i;a&&(m={...m,Authorization:a});const g={...!l&&await this._headerBasedAuth(e,p,m),...l&&(d?await this._headerBasedAuth(e,p,m):{})||{},...f&&await f({query:Ne(t),variables:n}),...m,...!l&&{"x-amz-user-agent":pn(s)}},v={query:Ne(t),variables:n||null};let b;b=l&&!d||"oidc"!==p&&"userPool"!==p&&"iam"!==p&&"lambda"!==p?void 0:{service:d?"execute-api":"appsync",region:d||c};const w=l||u;if(!w)throw Qi(new Ri(zi));let S;try{const{body:t}=await this._api.post(e,{url:new jt(w),options:{headers:g,body:v,signingServiceInfo:b,withCredentials:y},abortController:o});S=await t.json()}catch(e){if(this.isCancelError(e))throw e;S=Qi(e)}if(function(e){if(!e)return!1;const t=e;return Array.isArray(t.errors)&&t.errors.length>0}(S))throw Ui(S);return S}isCancelError(e){return this._api.isCancelErrorREST(e)}cancel(e,t){return this._api.cancelREST(e,t)}_graphqlSubscribe(e,{query:t,variables:n,authMode:r},i={},o,s){const a=$i(e),{headers:c}=ji(e);return this.appSyncRealTime.subscribe({query:Ne(t),variables:n,appSyncGraphqlEndpoint:a?.endpoint,region:a?.region,authenticationType:r||a?.defaultAuthMode,apiKey:a?.apiKey,additionalHeaders:i,authToken:s,libraryConfigHeaders:c},o).pipe($t((e=>{if(e.errors)throw Ui(e);throw e})))}}var Yi;new Hi,function(e){e.NoEndpointId="NoEndpointId",e.PlatformNotSupported="PlatformNotSupported",e.Unknown="Unknown"}(Yi||(Yi={}));class Ji extends fn{constructor(){super({name:Yi.PlatformNotSupported,message:"Function not supported on current platform"})}}class Xi{constructor(e){this.storage=e}async setItem(e,t){if(!this.storage)throw new Ji;this.storage.setItem(e,t)}async getItem(e){if(!this.storage)throw new Ji;return this.storage.getItem(e)}async removeItem(e){if(!this.storage)throw new Ji;this.storage.removeItem(e)}async clear(){if(!this.storage)throw new Ji;this.storage.clear()}}class Zi{constructor(){this.storage=new Map}get length(){return this.storage.size}key(e){return e>this.length-1?null:Array.from(this.storage.keys())[e]}setItem(e,t){this.storage.set(e,t)}getItem(e){return this.storage.get(e)??null}removeItem(e){this.storage.delete(e)}clear(){this.storage.clear()}}const eo=()=>"undefined"!=typeof window&&window.localStorage?window.localStorage:new Zi,to={keyPrefix:"aws-amplify-cache",capacityInBytes:1048576,itemMaxSize:21e4,defaultTTL:2592e5,defaultPriority:5,warningThreshold:.8},no="CurSize";function ro(e){let t=0;t=e.length;for(let n=e.length;n>=0;n-=1){const r=e.charCodeAt(n);r>127&&r<=2047?t+=1:r>2047&&r<=65535&&(t+=2),r>=56320&&r<=57343&&(n-=1)}return t}function io(){return(new Date).getTime()}const oo=e=>`${e}CurSize`,so=(e,t=fn)=>(n,r,i)=>{const{message:o,recoverySuggestion:s}=e[r];if(!n)throw new t({name:r,message:i?`${o} ${i}`:o,recoverySuggestion:s})};var ao;!function(e){e.NoCacheItem="NoCacheItem",e.NullNextNode="NullNextNode",e.NullPreviousNode="NullPreviousNode"}(ao||(ao={}));const co=so({[ao.NoCacheItem]:{message:"Item not found in the cache storage."},[ao.NullNextNode]:{message:"Next node is null."},[ao.NullPreviousNode]:{message:"Previous node is null."}}),uo=new kn("StorageCache"),lo=new kn("StorageCache");class ho extends class{constructor({config:e,keyValueStorage:t}){this.config={...to,...e},this.keyValueStorage=t,this.sanitizeConfig()}getModuleName(){return"Cache"}configure(e){return e&&(e.keyPrefix&&uo.warn("keyPrefix can not be re-configured on an existing Cache instance."),this.config={...this.config,...e}),this.sanitizeConfig(),this.config}async getCurrentCacheSize(){let e=await this.getStorage().getItem(oo(this.config.keyPrefix));return e||(await this.getStorage().setItem(oo(this.config.keyPrefix),"0"),e="0"),Number(e)}async setItem(e,t,n){if(uo.debug(`Set item: key is ${e}, value is ${t} with options: ${n}`),!e||e===no)return void uo.warn("Invalid key: should not be empty or reserved key: 'CurSize'");if(void 0===t)return void uo.warn("The value of item should not be undefined!");const r={priority:void 0!==n?.priority?n.priority:this.config.defaultPriority,expires:void 0!==n?.expires?n.expires:this.config.defaultTTL+io()};if(r.priority<1||r.priority>5)return void uo.warn("Invalid parameter: priority due to out or range. It should be within 1 and 5.");const i=`${this.config.keyPrefix}${e}`,o=this.fillCacheItem(i,t,r);if(o.byteSize>this.config.itemMaxSize)uo.warn(`Item with key: ${e} you are trying to put into is too big!`);else try{const e=await this.getStorage().getItem(i);if(e&&await this.removeCacheItem(i,JSON.parse(e).byteSize),await this.isCacheFull(o.byteSize)){const e=await this.clearInvalidAndGetRemainingKeys();if(await this.isCacheFull(o.byteSize)){const t=await this.sizeToPop(o.byteSize);await this.popOutItems(e,t)}}return this.setCacheItem(i,o)}catch(e){uo.warn(`setItem failed! ${e}`)}}async getItem(e,t){let n;if(uo.debug(`Get item: key is ${e} with options ${t}`),!e||e===no)return uo.warn("Invalid key: should not be empty or reserved key: 'CurSize'"),null;const r=`${this.config.keyPrefix}${e}`;try{if(n=await this.getStorage().getItem(r),null!=n){if(!await this.isExpired(r))return(await this.updateVisitedTime(JSON.parse(n),r)).data;await this.removeCacheItem(r,JSON.parse(n).byteSize)}if(t?.callback){const n=t.callback();return null!==n&&await this.setItem(e,n,t),n}return null}catch(e){return uo.warn(`getItem failed! ${e}`),null}}async removeItem(e){if(uo.debug(`Remove item: key is ${e}`),!e||e===no)return void uo.warn("Invalid key: should not be empty or reserved key: 'CurSize'");const t=`${this.config.keyPrefix}${e}`;try{const e=await this.getStorage().getItem(t);e&&await this.removeCacheItem(t,JSON.parse(e).byteSize)}catch(e){uo.warn(`removeItem failed! ${e}`)}}async getAllKeys(){try{return await this.getAllCacheKeys()}catch(e){return uo.warn(`getAllkeys failed! ${e}`),[]}}getStorage(){return this.keyValueStorage}async isExpired(e){const t=await this.getStorage().getItem(e);co(null!==t,ao.NoCacheItem,`Key: ${e}`);const n=JSON.parse(t);return io()>=n.expires}async removeCacheItem(e,t){const n=await this.getStorage().getItem(e);co(null!==n,ao.NoCacheItem,`Key: ${e}`);const r=t??JSON.parse(n).byteSize;await this.decreaseCurrentSizeInBytes(r);try{await this.getStorage().removeItem(e)}catch(e){await this.increaseCurrentSizeInBytes(r),uo.error(`Failed to remove item: ${e}`)}}fillCacheItem(e,t,n){const r={key:e,data:t,timestamp:io(),visitedTime:io(),priority:n.priority??0,expires:n.expires??0,type:typeof t,byteSize:0};return r.byteSize=ro(JSON.stringify(r)),r.byteSize=ro(JSON.stringify(r)),r}sanitizeConfig(){this.config.itemMaxSize>this.config.capacityInBytes&&(uo.error("Invalid parameter: itemMaxSize. It should be smaller than capacityInBytes. Setting back to default."),this.config.itemMaxSize=to.itemMaxSize),(this.config.defaultPriority>5||this.config.defaultPriority<1)&&(uo.error("Invalid parameter: defaultPriority. It should be between 1 and 5. Setting back to default."),this.config.defaultPriority=to.defaultPriority),(Number(this.config.warningThreshold)>1||Number(this.config.warningThreshold)<0)&&(uo.error("Invalid parameter: warningThreshold. It should be between 0 and 1. Setting back to default."),this.config.warningThreshold=to.warningThreshold),this.config.capacityInBytes>5242880&&(uo.error("Cache Capacity should be less than 5MB. Setting back to default. Setting back to default."),this.config.capacityInBytes=to.capacityInBytes)}async increaseCurrentSizeInBytes(e){const t=await this.getCurrentCacheSize();await this.getStorage().setItem(oo(this.config.keyPrefix),(t+e).toString())}async decreaseCurrentSizeInBytes(e){const t=await this.getCurrentCacheSize();await this.getStorage().setItem(oo(this.config.keyPrefix),(t-e).toString())}async updateVisitedTime(e,t){return e.visitedTime=io(),await this.getStorage().setItem(t,JSON.stringify(e)),e}async setCacheItem(e,t){await this.increaseCurrentSizeInBytes(t.byteSize);try{await this.getStorage().setItem(e,JSON.stringify(t))}catch(e){await this.decreaseCurrentSizeInBytes(t.byteSize),uo.error(`Failed to set item ${e}`)}}async sizeToPop(e){const t=await this.getCurrentCacheSize()+e-this.config.capacityInBytes,n=(1-this.config.warningThreshold)*this.config.capacityInBytes;return t>n?t:n}async isCacheFull(e){return e+await this.getCurrentCacheSize()>this.config.capacityInBytes}async popOutItems(e,t){const n=[];let r=t;for(const t of e){const e=await this.getStorage().getItem(t);if(null!=e){const t=JSON.parse(e);n.push(t)}}n.sort(((e,t)=>e.priority>t.priority?-1:e.priority<t.priority?1:e.visitedTime<t.visitedTime?-1:1));for(const e of n)if(await this.removeCacheItem(e.key,e.byteSize),r-=e.byteSize,r<=0)return}async clearInvalidAndGetRemainingKeys(){const e=[],t=await this.getAllCacheKeys({omitSizeKey:!0});for(const n of t)await this.isExpired(n)?await this.removeCacheItem(n):e.push(n);return e}async clear(){uo.debug("Clear Cache");try{const e=await this.getAllKeys();for(const t of e)await this.getStorage().removeItem(t)}catch(e){uo.warn(`clear failed! ${e}`)}}}{constructor(e){const t=eo();super({config:e,keyValueStorage:new Xi(t)}),this.storage=t,this.getItem=this.getItem.bind(this),this.setItem=this.setItem.bind(this),this.removeItem=this.removeItem.bind(this)}async getAllCacheKeys(e){const{omitSizeKey:t}=e??{},n=[];for(let e=0;e<this.storage.length;e++){const r=this.storage.key(e);t&&r===oo(this.config.keyPrefix)||r?.startsWith(this.config.keyPrefix)&&n.push(r.substring(this.config.keyPrefix.length))}return n}createInstance(e){return e.keyPrefix&&e.keyPrefix!==to.keyPrefix||(lo.error("invalid keyPrefix, setting keyPrefix with timeStamp"),e.keyPrefix=io.toString()),new ho(e)}}const po=new ho,fo=new class{constructor(){this.Cache=po,this._graphqlApi=new Hi}getModuleName(){return"InternalAPI"}getGraphqlOperationType(e){return this._graphqlApi.getGraphqlOperationType(e)}graphql(e,t,n){const r={category:Bt.API,action:Kt.GraphQl,...n};return this._graphqlApi.graphql(Wr,e,t,r)}};function yo(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw Error("[Immer] minified error nr: "+e+(n.length?" "+n.map((function(e){return"'"+e+"'"})).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function mo(e){return!!e&&!!e[ns]}function go(e){return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;var n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object||"function"==typeof n&&Function.toString.call(n)===rs}(e)||Array.isArray(e)||!!e[ts]||!!e.constructor[ts]||Eo(e)||Io(e))}function vo(e,t,n){void 0===n&&(n=!1),0===bo(e)?(n?Object.keys:is)(e).forEach((function(r){n&&"symbol"==typeof r||t(r,e[r],e)})):e.forEach((function(n,r){return t(r,n,e)}))}function bo(e){var t=e[ns];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:Eo(e)?2:Io(e)?3:0}function wo(e,t){return 2===bo(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function So(e,t){return 2===bo(e)?e.get(t):e[t]}function Ao(e,t,n){var r=bo(e);2===r?e.set(t,n):3===r?(e.delete(t),e.add(n)):e[t]=n}function Eo(e){return Jo&&e instanceof Map}function Io(e){return Xo&&e instanceof Set}function To(e){return e.o||e.t}function Co(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=os(e);delete t[ns];for(var n=is(t),r=0;r<n.length;r++){var i=n[r],o=t[i];!1===o.writable&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(t[i]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[i]})}return Object.create(Object.getPrototypeOf(e),t)}function No(e,t){return void 0===t&&(t=!1),_o(e)||mo(e)||!go(e)||(bo(e)>1&&(e.set=e.add=e.clear=e.delete=Oo),Object.freeze(e),t&&vo(e,(function(e,t){return No(t,!0)}),!0)),e}function Oo(){yo(2)}function _o(e){return null==e||"object"!=typeof e||Object.isFrozen(e)}function ko(e){var t=ss[e];return t||yo(18,e),t}function xo(){return Ho}function Po(e,t){t&&(ko("Patches"),e.u=[],e.s=[],e.v=t)}function Do(e){Ro(e),e.p.forEach(Lo),e.p=null}function Ro(e){e===Ho&&(Ho=e.l)}function Mo(e){return Ho={p:[],l:Ho,h:e,m:!0,_:0}}function Lo(e){var t=e[ns];0===t.i||1===t.i?t.j():t.O=!0}function Fo(e,t){t._=t.p.length;var n=t.p[0],r=void 0!==e&&e!==n;return t.h.g||ko("ES5").S(t,e,r),r?(n[ns].P&&(Do(t),yo(4)),go(e)&&(e=$o(t,e),t.l||Uo(t,e)),t.u&&ko("Patches").M(n[ns],e,t.u,t.s)):e=$o(t,n,[]),Do(t),t.u&&t.v(t.u,t.s),e!==es?e:void 0}function $o(e,t,n){if(_o(t))return t;var r=t[ns];if(!r)return vo(t,(function(i,o){return jo(e,r,t,i,o,n)}),!0),t;if(r.A!==e)return t;if(!r.P)return Uo(e,r.t,!0),r.t;if(!r.I){r.I=!0,r.A._--;var i=4===r.i||5===r.i?r.o=Co(r.k):r.o;vo(3===r.i?new Set(i):i,(function(t,o){return jo(e,r,i,t,o,n)})),Uo(e,i,!1),n&&e.u&&ko("Patches").R(r,n,e.u,e.s)}return r.o}function jo(e,t,n,r,i,o){if(mo(i)){var s=$o(e,i,o&&t&&3!==t.i&&!wo(t.D,r)?o.concat(r):void 0);if(Ao(n,r,s),!mo(s))return;e.m=!1}if(go(i)&&!_o(i)){if(!e.h.F&&e._<1)return;$o(e,i),t&&t.A.l||Uo(e,i)}}function Uo(e,t,n){void 0===n&&(n=!1),e.h.F&&e.m&&No(t,n)}function Bo(e,t){var n=e[ns];return(n?To(n):e)[t]}function qo(e,t){if(t in e)for(var n=Object.getPrototypeOf(e);n;){var r=Object.getOwnPropertyDescriptor(n,t);if(r)return r;n=Object.getPrototypeOf(n)}}function Ko(e){e.P||(e.P=!0,e.l&&Ko(e.l))}function Go(e){e.o||(e.o=Co(e.t))}function Vo(e,t,n){var r=Eo(t)?ko("MapSet").N(t,n):Io(t)?ko("MapSet").T(t,n):e.g?function(e,t){var n=Array.isArray(e),r={i:n?1:0,A:t?t.A:xo(),P:!1,I:!1,D:{},l:t,t:e,k:null,o:null,j:null,C:!1},i=r,o=as;n&&(i=[r],o=cs);var s=Proxy.revocable(i,o),a=s.revoke,c=s.proxy;return r.k=c,r.j=a,c}(t,n):ko("ES5").J(t,n);return(n?n.A:xo()).p.push(r),r}function Wo(e){return mo(e)||yo(22,e),function e(t){if(!go(t))return t;var n,r=t[ns],i=bo(t);if(r){if(!r.P&&(r.i<4||!ko("ES5").K(r)))return r.t;r.I=!0,n=zo(t,i),r.I=!1}else n=zo(t,i);return vo(n,(function(t,i){r&&So(r.t,t)===i||Ao(n,t,e(i))})),3===i?new Set(n):n}(e)}function zo(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return Co(e)}var Qo,Ho,Yo="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),Jo="undefined"!=typeof Map,Xo="undefined"!=typeof Set,Zo="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,es=Yo?Symbol.for("immer-nothing"):((Qo={})["immer-nothing"]=!0,Qo),ts=Yo?Symbol.for("immer-draftable"):"__$immer_draftable",ns=Yo?Symbol.for("immer-state"):"__$immer_state",rs=("undefined"!=typeof Symbol&&Symbol.iterator,""+Object.prototype.constructor),is="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,os=Object.getOwnPropertyDescriptors||function(e){var t={};return is(e).forEach((function(n){t[n]=Object.getOwnPropertyDescriptor(e,n)})),t},ss={},as={get:function(e,t){if(t===ns)return e;var n=To(e);if(!wo(n,t))return function(e,t,n){var r,i=qo(t,n);return i?"value"in i?i.value:null===(r=i.get)||void 0===r?void 0:r.call(e.k):void 0}(e,n,t);var r=n[t];return e.I||!go(r)?r:r===Bo(e.t,t)?(Go(e),e.o[t]=Vo(e.A.h,r,e)):r},has:function(e,t){return t in To(e)},ownKeys:function(e){return Reflect.ownKeys(To(e))},set:function(e,t,n){var r=qo(To(e),t);if(null==r?void 0:r.set)return r.set.call(e.k,n),!0;if(!e.P){var i=Bo(To(e),t),o=null==i?void 0:i[ns];if(o&&o.t===n)return e.o[t]=n,e.D[t]=!1,!0;if(function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}(n,i)&&(void 0!==n||wo(e.t,t)))return!0;Go(e),Ko(e)}return e.o[t]===n&&"number"!=typeof n&&(void 0!==n||t in e.o)||(e.o[t]=n,e.D[t]=!0,!0)},deleteProperty:function(e,t){return void 0!==Bo(e.t,t)||t in e.t?(e.D[t]=!1,Go(e),Ko(e)):delete e.D[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var n=To(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r?{writable:!0,configurable:1!==e.i||"length"!==t,enumerable:r.enumerable,value:n[t]}:r},defineProperty:function(){yo(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){yo(12)}},cs={};vo(as,(function(e,t){cs[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),cs.deleteProperty=function(e,t){return as.deleteProperty.call(this,e[0],t)},cs.set=function(e,t,n){return as.set.call(this,e[0],t,n,e[0])};var us,ls=function(){function e(e){var t=this;this.g=Zo,this.F=!0,this.produce=function(e,n,r){if("function"==typeof e&&"function"!=typeof n){var i=n;n=e;var o=t;return function(e){var t=this;void 0===e&&(e=i);for(var r=arguments.length,s=Array(r>1?r-1:0),a=1;a<r;a++)s[a-1]=arguments[a];return o.produce(e,(function(e){var r;return(r=n).call.apply(r,[t,e].concat(s))}))}}var s;if("function"!=typeof n&&yo(6),void 0!==r&&"function"!=typeof r&&yo(7),go(e)){var a=Mo(t),c=Vo(t,e,void 0),u=!0;try{s=n(c),u=!1}finally{u?Do(a):Ro(a)}return"undefined"!=typeof Promise&&s instanceof Promise?s.then((function(e){return Po(a,r),Fo(e,a)}),(function(e){throw Do(a),e})):(Po(a,r),Fo(s,a))}if(!e||"object"!=typeof e){if((s=n(e))===es)return;return void 0===s&&(s=e),t.F&&No(s,!0),s}yo(21,e)},this.produceWithPatches=function(e,n){return"function"==typeof e?function(n){for(var r=arguments.length,i=Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];return t.produceWithPatches(n,(function(t){return e.apply(void 0,[t].concat(i))}))}:[t.produce(e,n,(function(e,t){r=e,i=t})),r,i];var r,i},"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze)}var t=e.prototype;return t.createDraft=function(e){go(e)||yo(8),mo(e)&&(e=Wo(e));var t=Mo(this),n=Vo(this,e,void 0);return n[ns].C=!0,Ro(t),n},t.finishDraft=function(e,t){var n=(e&&e[ns]).A;return Po(n,t),Fo(void 0,n)},t.setAutoFreeze=function(e){this.F=e},t.setUseProxies=function(e){e&&!Zo&&yo(20),this.g=e},t.applyPatches=function(e,t){var n;for(n=t.length-1;n>=0;n--){var r=t[n];if(0===r.path.length&&"replace"===r.op){e=r.value;break}}var i=ko("Patches").$;return mo(e)?i(e,t):this.produce(e,(function(e){return i(e,t.slice(n+1))}))},e}(),ds=new ls,hs=ds.produce,ps=(ds.produceWithPatches.bind(ds),ds.setAutoFreeze.bind(ds)),fs=(ds.setUseProxies.bind(ds),ds.applyPatches.bind(ds));ds.createDraft.bind(ds),ds.finishDraft.bind(ds);class ys extends Error{constructor(e){super(`BackgroundManagerNotOpenError: ${e}`)}}!function(e){e.Open="Open",e.Closing="Closing",e.Closed="Closed"}(us||(us={}));class ms{constructor(){this._state=us.Open,this.jobs=new Set}add(e,t){let n,r;"string"==typeof e?(n=void 0,r=e):(n=e,r=t);const i=this.closedFailure(r);if(i)return i;if(void 0===n)return this.addHook(r);if("function"==typeof n)return this.addFunction(n,r);if(!(n instanceof ms))throw new Error("If `job` is provided, it must be an Observable, Function, or BackgroundProcessManager.");this.addManager(n,r)}addCleaner(e,t){const{resolve:n,onTerminate:r}=this.addHook(t),i=async()=>{await e(),n()};return r.then(i),i}addFunction(e,t){let n;const r=e(new Promise((e=>{n=e})));return"function"==typeof r?.then&&this.registerPromise(r,n,t),r}addManager(e,t){this.addCleaner((async()=>e.close()),t)}addHook(e){let t,n;const r=new Promise(((e,r)=>{t=e,n=r}));let i;const o=new Promise((e=>{i=e}));return this.registerPromise(r,i,e),{resolve:t,reject:n,onTerminate:o}}registerPromise(e,t,n){const r={promise:e,terminate:t,description:n};this.jobs.add(r),e.then((()=>{this.jobs.delete(r)})).catch((()=>{this.jobs.delete(r)}))}get length(){return this.jobs.size}get state(){return this._state}get pending(){return Array.from(this.jobs).map((e=>e.description))}get isOpen(){return this._state===us.Open}get isClosing(){return this._state===us.Closing}get isClosed(){return this._state===us.Closed}closedFailure(e){if(!this.isOpen)return Promise.reject(new ys([`The manager is ${this.state}.`,`You tried to add "${e}".`,`Pending jobs: [\n${this.pending.map((e=>"    "+e)).join(",\n")}\n]`].join("\n")))}async close(){if(this.isOpen){this._state=us.Closing;for(const e of Array.from(this.jobs))try{e.terminate()}catch(t){console.warn(`Failed to send termination signal to job. Error: ${t.message}`,e)}this._closingPromise=Promise.allSettled(Array.from(this.jobs).map((e=>e.promise))),await this._closingPromise,this._state=us.Closed}return this._closingPromise}async open(){this.isClosing&&await this.close(),this._state=us.Open}}const gs=()=>[];function vs(e){var t=new Error(e);return t.source="ulid",t}var bs,ws="0123456789ABCDEFGHJKMNPQRSTVWXYZ",Ss=ws.length,As=Math.pow(2,48)-1;function Es(e,t,n){return t>e.length-1?e:e.substr(0,t)+n+e.substr(t+1)}function Is(e){var t=Math.floor(e()*Ss);return t===Ss&&(t=Ss-1),ws.charAt(t)}function Ts(e,t){if(isNaN(e))throw new Error(e+" must be a number");if(e>As)throw vs("cannot encode time greater than "+As);if(e<0)throw vs("time must be positive");if(!1===Number.isInteger(e))throw vs("time must be an integer");for(var n=void 0,r="";t>0;t--)r=ws.charAt(n=e%Ss)+r,e=(e-n)/Ss;return r}function Cs(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments[1];t||(t="undefined"!=typeof window?window:null);var r=t&&(t.crypto||t.msCrypto);if(r)return function(){var e=new Uint8Array(1);return r.getRandomValues(e),e[0]/255};try{var i=n(858);return function(){return i.randomBytes(1).readUInt8()/255}}catch(e){}if(e){try{console.error("secure crypto unusable, falling back to insecure Math.random()!")}catch(e){}return function(){return Math.random()}}throw vs("secure crypto unusable, insecure Math.random not allowed")}function Ns(e){e||(e=Cs());var t=0,n=void 0;return function(r){if(isNaN(r)&&(r=Date.now()),r<=t){var i=n=function(e){for(var t=void 0,n=e.length,r=void 0,i=void 0,o=Ss-1;!t&&n-- >=0;){if(r=e[n],-1===(i=ws.indexOf(r)))throw vs("incorrectly encoded string");i!==o?t=Es(e,n,ws[i+1]):e=Es(e,n,ws[0])}if("string"==typeof t)return t;throw vs("cannot increment this string")}(n);return Ts(t,10)+i}t=r;var o=n=function(e,t){for(var n="";e>0;e--)n=Is(t)+n;return n}(16,e);return Ts(r,10)+o}}bs||(bs=Cs());class Os{constructor(e,t){this.words=[];let n=e;n=this.words=n||[],this.sigBytes=void 0!==t?t:4*n.length}random(e){const t=[];for(let n=0;n<e;n+=4)t.push(ti().getRandomValues(new Uint32Array(1))[0]);return new Os(t,e)}toString(){return function(e){const{words:t}=e,{sigBytes:n}=e,r=[];for(let e=0;e<n;e++){const n=t[e>>>2]>>>24-e%4*8&255;r.push((n>>>4).toString(16)),r.push((15&n).toString(16))}return r.join("")}(this)}}class _s{static createPredicateBuilder(e){const{name:t}=e,n=new Set(Object.keys(e.fields)),r=new Proxy({},{get(e,r,i){const o=r;if(!n.has(o))throw new Error(`Invalid field for model. field: ${String(o)}, model: ${t}`);return e=>(_s.sortPredicateGroupsMap.get(i)?.push({field:o,sortDirection:e}),i)}});return _s.sortPredicateGroupsMap.set(r,[]),r}static isValidPredicate(e){return _s.sortPredicateGroupsMap.has(e)}static getPredicates(e,t=!0){if(t&&!_s.isValidPredicate(e))throw new Error("The predicate is not valid");const n=_s.sortPredicateGroupsMap.get(e);if(n)return n;throw new Error("Predicate group not found")}static createFromExisting(e,t){if(t&&e)return t(_s.createPredicateBuilder(e))}}_s.sortPredicateGroupsMap=new WeakMap;const ks="id",xs="#",Ps="An index field cannot contain an empty string value";var Ds;!function(e){e.DATASTORE="datastore",e.USER="user",e.SYNC="sync",e.STORAGE="storage"}(Ds||(Ds={}));const Rs=Ds.DATASTORE,Ms=Ds.USER,Ls=Ds.SYNC,Fs=Ds.STORAGE,$s=e=>void 0===e||null==e,js=(e,t,n)=>{let r,i=!1;if(0===n.length)return!0;switch(t){case"not":r="every",i=!0;break;case"and":r="every";break;case"or":r="some";break;default:throw new Error(`Invalid ${t}`)}const o=n[r]((t=>{if(Ba(t)){const{field:n,operator:r,operand:i}=t,o=e[n];return Us(o,r,i)}if(qa(t)){const{type:n,predicates:r}=t;return js(e,n,r)}throw new Error("Not a predicate or group")}));return i?!o:o},Us=(e,t,n)=>{switch(t){case"ne":return e!==n;case"eq":return e===n;case"le":return e<=n;case"lt":return e<n;case"ge":return e>=n;case"gt":return e>n;case"between":const[t,r]=n;return e>=t&&e<=r;case"beginsWith":return!$s(e)&&e.startsWith(n);case"contains":return!$s(e)&&e.indexOf(n)>-1;case"notContains":return $s(e)||-1===e.indexOf(n);default:return!1}},Bs=e=>e&&"function"==typeof e.copyOf,qs=new WeakSet,Ks=new WeakMap,Gs=(e,t,n,r,i)=>{const o=[],s=i(n.name,e).copyOf(t,(()=>{}));o.unshift({modelName:e,item:s,instance:s}),Ks.has(n)||Ks.set(n,Array.from(n.modelTopologicalOrdering.keys()));const a=Ks.get(n);return o.sort(((e,t)=>a.indexOf(e.modelName)-a.indexOf(t.modelName))),o};let Vs,Ws;const zs={};for(let e=0;e<256;e++){let t=e.toString(16).toLowerCase();1===t.length&&(t=`0${t}`),zs[t]=e}const Qs=()=>{return(e=1,(e=>{if(e.length%2!=0)throw new Error("Hex encoded strings must have an even number length");const t=new Uint8Array(e.length/2);for(let n=0;n<e.length;n+=2){const r=e.slice(n,n+2).toLowerCase();if(!(r in zs))throw new Error(`Cannot decode unrecognized sequence ${r} as hexadecimal`);t[n/2]=zs[r]}return t})((new Os).random(e).toString()))[0]/255;var e};function Hs(e){const t=Ns(Qs);return()=>t(e)}function Ys(){return"undefined"!=typeof performance&&performance&&"function"==typeof performance.now?0|performance.now():Date.now()}function Js(e){return function(t,n){for(const r of e){const{field:e,sortDirection:i}=r,o=i===Da.ASCENDING?1:-1;if(t[e]<n[e])return-1*o;if(t[e]>n[e])return 1*o}return 0}}function Xs(e,t,n=!1){let r=e,i=t;if(r instanceof Object&&!(i instanceof Object)||!(r instanceof Object)&&i instanceof Object)return!1;if(!(r instanceof Object))return!(!n||(o=r,s=i,null!=o||null!=s))||r===i;var o,s;if(Array.isArray(r)&&!Array.isArray(i)||Array.isArray(i)&&!Array.isArray(r))return!1;r instanceof Set&&i instanceof Set&&(r=[...r],i=[...i]),r instanceof Map&&i instanceof Map&&(r=Object.fromEntries(r),i=Object.fromEntries(i));const a=Object.keys(r),c=Object.keys(i);if(a.length!==c.length&&(!n||Array.isArray(r)))return!1;const u=a.length>=c.length?a:c;for(const e of u)if(!Xs(r[e],i[e],n))return!1;return!0}function Zs(e,t){if(t&&e.length>1){if(t.sort){const n=_s.getPredicates(t.sort);if(n.length){const t=Js(n);e.sort(t)}}const{page:n=0,limit:r=0}=t,i=Math.max(0,n*r)||0,o=r>0?i+r:e.length;return e.slice(i,o)}return e}const ea=e=>!!/^\d{4}-\d{2}-\d{2}(Z|[+-]\d{2}:\d{2}($|:\d{2}))?$/.exec(e),ta=e=>!!/^\d{2}:\d{2}(:\d{2}(.\d+)?)?(Z|[+-]\d{2}:\d{2}($|:\d{2}))?$/.exec(e),na=e=>!!/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}(:\d{2}(.\d+)?)?(Z|[+-]\d{2}:\d{2}($|:\d{2}))?$/.exec(e),ra=e=>!!/^\d+$/.exec(String(e)),ia=e=>!!/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.exec(e),oa=e=>{try{return JSON.parse(e),!0}catch{return!1}},sa=e=>{try{return!!new jt(e)}catch{return!1}},aa=e=>!!/^\+?\d[\d\s-]+$/.exec(e),ca=e=>!!/((^((([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]))$)|(^((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?$))$/.exec(e);class ua{constructor(){const e=this;this.promise=new Promise(((t,n)=>{e.resolve=t,e.reject=n}))}}class la{constructor(e){this.limitPromise=new ua,this.raceInFlight=!1,this.callback=()=>{},this.defaultErrorHandler=(e="DeferredCallbackResolver error")=>{throw new Error(e)},this.callback=e.callback,this.errorHandler=e.errorHandler||this.defaultErrorHandler,this.maxInterval=e.maxInterval||2e3}startTimer(){this.timerPromise=new Promise(((e,t)=>{this.timer=setTimeout((()=>{e(Ga.TIMER)}),this.maxInterval)}))}async racePromises(){let e;try{this.raceInFlight=!0,this.startTimer(),e=await Promise.race([this.timerPromise,this.limitPromise.promise]),this.callback()}catch(e){this.errorHandler(e)}finally{return this.clear(),this.raceInFlight=!1,this.limitPromise=new ua,e}}start(){this.raceInFlight||this.racePromises()}clear(){clearTimeout(this.timer)}resolve(){this.limitPromise.resolve(Ga.LIMIT)}}const da=(e,t)=>`${e}_${t}`,ha=e=>{const t=e?.attributes?.find(Ta);return t},pa=e=>{const t=ha(e);return t&&Ca(t)?t.properties.fields:[ks]},fa=(e,t)=>t.map((t=>e[t])),ya=e=>{const t=ha(e);return!t||!Ca(t)},ma=e=>{const t={},n={};return Object.keys(e.models).forEach((r=>{t[r]={indexes:[],relationTypes:[]},n[r]={};const i=e.models[r];if(Object.keys(i.fields).forEach((e=>{const n=i.fields[e];if("object"==typeof n.type&&"model"in n.type){const e=n.association.connectionType;if(t[r].relationTypes.push({fieldName:n.name,modelName:n.type.model,relationType:e,targetName:n.association.targetName,targetNames:n.association.targetNames,associatedWith:n.association.associatedWith}),"BELONGS_TO"===e){const e=ga(n.association);if(e){const n=va(e);t[r].indexes.find((([e])=>e===n))||t[r].indexes.push([n,e])}}}})),i.attributes){n[r].compositeKeys=(e=>{const t=e=>e.reduce(((e,t)=>{const n=new Set(t);if(0===e.length)return e.push(n),e;const r=e.findIndex((e=>[...e].some((e=>n.has(e)))));if(r>-1){const t=new Set([...e[r],...n]);e[r]=t}else e.push(n);return e}),[]),n=t(e.filter(Na).map((({properties:{fields:[,...e]}})=>e)));return t(n)})(i.attributes);for(const e of i.attributes){if(!Ta(e))continue;const{fields:i}=e.properties;if(Ca(e)){n[r].primaryKey=i;continue}const o=va(i);t[r].indexes.find((([e])=>e===o))||t[r].indexes.push([o,i])}}n[r].primaryKey||(n[r].primaryKey=[ks]),t[r].indexes.push(["byPk",n[r].primaryKey,{unique:!0}])})),[t,n]},ga=e=>{const t=e?.targetName,n=e?.targetNames;return Array.isArray(n)?n:"string"==typeof t?[t]:void 0},va=e=>e.reduce(((e,t,n)=>0===n?t:`${e}-${t}`),""),ba=(e,t)=>e.length===t.length&&e.every(((e,n)=>e===t[n])),wa=(e,t)=>{const n=e?.keys?.[t]?.primaryKey;return n||[ks]};function Sa(e){return e&&void 0!==e.pluralName}function Aa(e){return Sa(e)&&void 0!==e.attributes}function Ea(e){return e?.targetName||e?.targetNames}function Ia(e,t){return e?.fields[t]?.association?.connectionType}function Ta(e){return"key"===e.type&&e.properties&&e.properties.fields&&e.properties.fields.length>0}function Ca(e){return Ta(e)&&void 0===e.properties.name}function Na(e){return Ta(e)&&void 0!==e.properties.name&&e.properties.fields.length>2}var Oa,_a,ka,xa,Pa,Da,Ra,Ma,La;function Fa(e){return e&&void 0!==ka[e]}function $a(e){return!(!e||!e.model)}function ja(e){return!(!e||!e.nonModel)}function Ua(e,t){const n=pa(t);return"object"==typeof e&&e&&n.every((t=>void 0!==e[t]))}function Ba(e){return e&&void 0!==e.field}function qa(e){return e&&void 0!==e.type}!function(e){e.CUSTOM="custom",e.OWNER="owner",e.GROUPS="groups",e.PRIVATE="private",e.PUBLIC="public"}(Oa||(Oa={})),function(e){e.FUNCTION="function",e.USER_POOLS="userPools",e.OIDC="oidc",e.IAM="iam",e.API_KEY="apiKey"}(_a||(_a={})),function(e){e[e.ID=0]="ID",e[e.String=1]="String",e[e.Int=2]="Int",e[e.Float=3]="Float",e[e.Boolean=4]="Boolean",e[e.AWSDate=5]="AWSDate",e[e.AWSTime=6]="AWSTime",e[e.AWSDateTime=7]="AWSDateTime",e[e.AWSTimestamp=8]="AWSTimestamp",e[e.AWSEmail=9]="AWSEmail",e[e.AWSJSON=10]="AWSJSON",e[e.AWSURL=11]="AWSURL",e[e.AWSPhone=12]="AWSPhone",e[e.AWSIPAddress=13]="AWSIPAddress"}(ka||(ka={})),function(e){e.getJSType=function(e){switch(e){case"Boolean":return"boolean";case"ID":case"String":case"AWSDate":case"AWSTime":case"AWSDateTime":case"AWSEmail":case"AWSURL":case"AWSPhone":case"AWSIPAddress":return"string";case"Int":case"Float":case"AWSTimestamp":return"number";case"AWSJSON":return"object";default:throw new Error("Invalid scalar type")}},e.getValidationFunction=function(e){switch(e){case"AWSDate":return ea;case"AWSTime":return ta;case"AWSDateTime":return na;case"AWSTimestamp":return ra;case"AWSEmail":return ia;case"AWSJSON":return oa;case"AWSURL":return sa;case"AWSPhone":return aa;case"AWSIPAddress":return ca;default:return}}}(ka||(ka={})),function(e){e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"}(xa||(xa={})),function(e){e[e.FIRST=0]="FIRST",e[e.LAST=1]="LAST"}(Pa||(Pa={})),function(e){e.ASCENDING="ASCENDING",e.DESCENDING="DESCENDING"}(Da||(Da={})),function(e){e.DEFAULT="DEFAULT",e.MULTI_AUTH="MULTI_AUTH"}(Ra||(Ra={})),function(e){e.CREATE="CREATE",e.READ="READ",e.UPDATE="UPDATE",e.DELETE="DELETE"}(Ma||(Ma={})),function(e){e.sync="sync",e.mutate="mutate",e.subscribe="subscribe"}(La||(La={}));const Ka=Symbol("DISCARD");var Ga;!function(e){e.LIMIT="LIMIT",e.TIMER="TIMER"}(Ga||(Ga={}));class Va{constructor(){this.__isPredicateInternalsKeySentinel=!0}}function Wa(e){return"private"!==e.allow||e.provider?"public"!==e.allow||e.provider?e.provider:_a.API_KEY:_a.USER_POOLS}const za=new WeakSet;function Qa(e){return za.has(e)}const Ha=new Set(["and","or","not"]),Ya=new Set(["eq","ne","gt","lt","ge","le","contains","notContains","beginsWith","between"]),Ja=e=>Array.isArray(e)?e.every((e=>Ja(e))):Object.keys(e).length<=1;Symbol("A predicate that matches all records");class Xa{static isValidPredicate(e){return Xa.predicateGroupsMap.has(e)}static getPredicates(e,t=!0){if(t&&!Xa.isValidPredicate(e))throw new Error("The predicate is not valid");return Xa.predicateGroupsMap.get(e)}static createForPk(e,t){const n=pa(e),r=fa(t,n);return this.createFromAST(e,{and:n.map(((e,t)=>({[e]:{eq:r[t]}})))})}static createFromFlatEqualities(e,t){const n={and:Object.entries(t).map((([e,t])=>({[e]:{eq:t}})))};return this.createFromAST(e,n)}static transformGraphQLFilterNodeToPredicateAST(e){if(!Ja(e))throw new Error("Invalid GraphQL Condition or subtree: "+JSON.stringify(e));if((e=>!Array.isArray(e)&&0===Object.keys(e).length)(e))return{type:"and",predicates:[]};if((e=>{const t=[...Object.keys(e)];return 1===t.length&&Ha.has(t[0])})(e)){const t=Object.keys(e)[0],n=this.transformGraphQLFilterNodeToPredicateAST(e[t]);return{type:t,predicates:Array.isArray(n)?n:[n]}}if((e=>{const t=[...Object.keys(e)];return!Array.isArray(e)&&1===t.length&&Ya.has(t[0])})(e)){const t=Object.keys(e)[0];return{operator:t,operand:e[t]}}if(Array.isArray(e))return e.map((e=>this.transformGraphQLFilterNodeToPredicateAST(e)));{const t=Object.keys(e)[0];return{field:t,...this.transformGraphQLFilterNodeToPredicateAST(e[t])}}}static createFromAST(e,t){const n={};return Xa.predicateGroupsMap.set(n,this.transformGraphQLFilterNodeToPredicateAST(t)),n}}Xa.predicateGroupsMap=new WeakMap;var Za=Qe((function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}})),ec=function(e){function t(){var t=e.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return Fe(t,e),t.prototype.lift=function(e){var t=new tc(this,this);return t.operator=e,t},t.prototype._throwIfClosed=function(){if(this.closed)throw new Za},t.prototype.next=function(e){var t=this;ht((function(){var n,r;if(t._throwIfClosed(),!t.isStopped){t.currentObservers||(t.currentObservers=Array.from(t.observers));try{for(var i=Ue(t.currentObservers),o=i.next();!o.done;o=i.next())o.value.next(e)}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}}}))},t.prototype.error=function(e){var t=this;ht((function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var n=t.observers;n.length;)n.shift().error(e)}}))},t.prototype.complete=function(){var e=this;ht((function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}}))},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(t){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)},t.prototype._innerSubscribe=function(e){var t=this,n=this,r=n.hasError,i=n.isStopped,o=n.observers;return r||i?Xe:(this.currentObservers=null,o.push(e),new Je((function(){t.currentObservers=null,Ye(o,e)})))},t.prototype._checkFinalizedStatuses=function(e){var t=this,n=t.hasError,r=t.thrownError,i=t.isStopped;n?e.error(r):i&&e.complete()},t.prototype.asObservable=function(){var e=new It;return e.source=this,e},t.create=function(e,t){return new tc(e,t)},t}(It),tc=function(e){function t(t,n){var r=e.call(this)||this;return r.destination=t,r.source=n,r}return Fe(t,e),t.prototype.next=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)},t.prototype.error=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)},t.prototype.complete=function(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)},t.prototype._subscribe=function(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:Xe},t}(ec);const nc=new kn("DataStore");var rc,ic;!function(e){e.LIST="query",e.CREATE="mutation",e.UPDATE="mutation",e.DELETE="mutation",e.GET="query"}(rc||(rc={})),function(e){e.CREATE="Create",e.UPDATE="Update",e.DELETE="Delete",e.GET="Get"}(ic||(ic={}));const oc=Object.keys({_version:void 0,_lastChangedAt:void 0,_deleted:void 0});function sc(e,t){const n=ac(t),r=function(e,t){const n=[];return Object.values(t.fields).forEach((({name:t,type:r})=>{if(ja(r)){const i=e.nonModels[r.nonModel],o=Object.values(ac(i)).map((({name:e})=>e)),s=[];Object.values(i.fields).forEach((t=>{const{type:n,name:r}=t;if(ja(n)){const t=e.nonModels[n.nonModel];s.push(`${r} { ${sc(e,t)} }`)}})),n.push(`${t} { ${o.join(" ")} ${s.join(" ")} }`)}})),n}(e,t),i=function(e,t){const n=function(e){const t=[];return Aa(e)&&e.attributes.forEach((e=>{if(e.properties&&e.properties.rules){const n=e.properties.rules.find((e=>"owner"===e.allow));n&&n.ownerField&&t.push(n.ownerField)}})),t}(e);return!t.owner&&n.includes("owner")?["owner"]:[]}(t,n);let o=Object.values(n).map((({name:e})=>e)).concat(i).concat(r);return Sa(t)&&(o=o.concat(oc).concat(function(e,t){const n=[];return Object.values(e.fields).filter((({association:e})=>e&&Object.keys(e).length)).forEach((({name:r,association:i})=>{const{connectionType:o}=i||{};switch(o){case"HAS_ONE":case"HAS_MANY":break;case"BELONGS_TO":if(Ea(i))if(i.targetNames&&i.targetNames.length>0){const[i]=ma(t),o=i[e.fields[r].type.model].indexes.find((([e])=>"byPk"===e)),s=(o&&o[1])?.join(" ");n.push(`${r} { ${s} _deleted }`)}else n.push(`${r} { id _deleted }`);break;default:throw new Error(`Invalid connection type ${o}`)}})),n}(t,e))),o.join("\n")}function ac(e){const{fields:t}=e;return Object.values(t).filter((e=>{return!!(Fa(e.type)||(t=e.type,t&&t.enum));var t})).reduce(((e,t)=>(e[t.name]=t,e)),{})}function cc(e){const t=[].concat(e.attributes||[]).find((e=>e&&"auth"===e.type)),{properties:{rules:n=[]}={}}=t||{},r=[];return n.forEach((t=>{const{identityClaim:n="cognito:username",ownerField:i="owner",operations:o=["create","update","delete","read"],provider:s="userPools",groupClaim:a="cognito:groups",allow:c="iam",groups:u=[],groupsField:l=""}=t,d="owner"===c;if(!o.includes("read")&&!d)return;const h={identityClaim:n,ownerField:i,provider:s,groupClaim:a,authStrategy:c,groups:u,groupsField:l,areSubscriptionsPublic:!1};if(d){const t=[].concat(e.attributes||[]).find((e=>e&&"model"===e.type)),{properties:{subscriptions:{level:n="on"}={}}={}}=t||{};h.areSubscriptionsPublic=!o.includes("read")||"public"===n}d?r.push(h):r.unshift(h)})),r}function uc(e,t,n){let r=sc(e,t);const{name:i,pluralName:o}=t;let s,a,c,u;switch(n){case"LIST":s=`sync${o}`,a=`($limit: Int, $nextToken: String, $lastSync: AWSTimestamp, $filter: Model${i}FilterInput)`,c="(limit: $limit, nextToken: $nextToken, lastSync: $lastSync, filter: $filter)",r=`items {\n\t\t\t\t\t\t\t${r}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tnextToken\n\t\t\t\t\t\tstartedAt`;break;case"CREATE":s=`create${i}`,a=`($input: Create${i}Input!)`,c="(input: $input)",u=ic.CREATE;break;case"UPDATE":s=`update${i}`,a=`($input: Update${i}Input!, $condition: Model${i}ConditionInput)`,c="(input: $input, condition: $condition)",u=ic.UPDATE;break;case"DELETE":s=`delete${i}`,a=`($input: Delete${i}Input!, $condition: Model${i}ConditionInput)`,c="(input: $input, condition: $condition)",u=ic.DELETE;break;case"GET":s=`get${i}`,a="($id: ID!)",c="(id: $id)",u=ic.GET;break;default:throw new Error(`Invalid graphQlOpType ${n}`)}return[[u,s,`${rc[n]} operation${a}{\n\t\t${s}${c}{\n\t\t\t${r}\n\t\t}\n\t}`]]}function lc(e,t,n,r,i,o,s,a,c){let u;switch(n){case xa.INSERT:u=ic.CREATE;break;case xa.UPDATE:u=ic.UPDATE;break;case xa.DELETE:u=ic.DELETE;break;default:throw new Error(`Invalid opType ${n}`)}const l=vc(t,i),d=a(s,{...xa.INSERT&&c?{id:c}:{},data:JSON.stringify(i,((e,n)=>e&&null!==n&&"object"==typeof n&&t.fields[e]&&"AWSJSON"===t.fields[e].type?JSON.stringify(n):n)),modelId:l,model:r.name,operation:u,condition:JSON.stringify(o)});return d}function dc(e,t=[],n=!0){const r={};if(!e||!Array.isArray(e.predicates))return r;const{type:i,predicates:o}=e,s="and"===i||"or"===i;r[i]=s?[]:{};const a=[];if(o.forEach((e=>{if(Ba(e)){const{field:n,operator:r,operand:i}=e;if(t.includes(n))return;const o={[n]:{[r]:i}};return void a.push(o)}const n=dc(e,t,!1);Object.keys(n).length>0&&a.push(n)})),1===a.length){const[e]=a;if(s&&!n||s&&n&&("and"in e||"or"in e))return delete r[i],Object.assign(r,e),r}if(a.forEach((e=>{s?r[i].push(e):r[i]=e})),s){if(0===r[i].length)return{}}else if(0===Object.keys(r[i]).length)return{};return r}var hc;async function pc({authModeStrategy:e,defaultAuthMode:t,modelName:n,schema:r}){const i=Object.values(Ma),o={CREATE:[],READ:[],UPDATE:[],DELETE:[]};try{await Promise.all(i.map((async i=>{const s=await e({schema:r,modelName:n,operation:i});"string"==typeof s?o[i]=[s]:Array.isArray(s)&&s.length?o[i]=s:o[i]=[t]})))}catch(e){nc.debug(`Error getting auth modes for model: ${n}`,e)}return o}function fc(e){const t=[401,403];let n;return e&&e.errors?n=e.errors.find((e=>t.includes(yc(e)))):e&&e.message&&(n=e),n?n.message??`Request failed with status code ${yc(n)}`:null}function yc(e){return e?.$metadata?.httpStatusCode?Number(e?.$metadata?.httpStatusCode):e?.originalError?yc(e?.originalError):null}function mc(e){const t=Object.values(Bi);return e&&e.message&&t.find((t=>e.message.includes(t)))||null}async function gc(e,t={}){if("lambda"===e){const{authProviders:{functionAuthProvider:e}={functionAuthProvider:null}}=t;if(!e||"function"!=typeof e)throw new Error("You must provide a `functionAuthProvider` function to `DataStore.configure` when using lambda");try{const{token:t}=await e();return t}catch(e){throw new Error(`Error retrieving token from \`functionAuthProvider\`: ${e}`)}}}function vc(e,t){const n=pa(e).map((e=>t[e])).join("-");return n}let bc,wc;!function(e){e[e.UnknownField=0]="UnknownField",e[e.MaxAttributes=1]="MaxAttributes",e[e.MaxCombinations=2]="MaxCombinations",e[e.RepeatedFieldname=3]="RepeatedFieldname",e[e.NotGroup=4]="NotGroup",e[e.FieldNotInType=5]="FieldNotInType"}(hc||(hc={}));const Sc=new WeakMap,Ac=new WeakMap,Ec=new WeakMap,Ic=new WeakMap,Tc=new WeakMap;let Cc={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return Ac.get(e);if("objectStoreNames"===t)return e.objectStoreNames||Ec.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Oc(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function Nc(e){return"function"==typeof e?(t=e)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(wc||(wc=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(_c(this),e),Oc(Sc.get(this))}:function(...e){return Oc(t.apply(_c(this),e))}:function(e,...n){const r=t.call(_c(this),e,...n);return Ec.set(r,e.sort?e.sort():[e]),Oc(r)}:(e instanceof IDBTransaction&&function(e){if(Ac.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",o),e.removeEventListener("abort",o)},i=()=>{t(),r()},o=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",o),e.addEventListener("abort",o)}));Ac.set(e,t)}(e),n=e,(bc||(bc=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((e=>n instanceof e))?new Proxy(e,Cc):e);var t,n}function Oc(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",o)},i=()=>{t(Oc(e.result)),r()},o=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",o)}));return t.then((t=>{t instanceof IDBCursor&&Sc.set(t,e)})).catch((()=>{})),Tc.set(t,e),t}(e);if(Ic.has(e))return Ic.get(e);const t=Nc(e);return t!==e&&(Ic.set(e,t),Tc.set(t,e)),t}const _c=e=>Tc.get(e),kc=["get","getKey","getAll","getAllKeys","count"],xc=["put","add","delete","clear"],Pc=new Map;function Dc(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(Pc.get(t))return Pc.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=xc.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!kc.includes(n))return;const o=async function(e,...t){const o=this.transaction(e,i?"readwrite":"readonly");let s=o.store;r&&(s=s.index(t.shift()));const a=await s[n](...t);return i&&await o.done,a};return Pc.set(t,o),o}var Rc;Rc=Cc,Cc={...Rc,get:(e,t,n)=>Dc(e,t)||Rc.get(e,t,n),has:(e,t)=>!!Dc(e,t)||Rc.has(e,t)};class Mc{constructor(e,t){if(!Ia(e.schema,t))throw new Error(`${e.schema.name}.${t} is not a relationship.`);this.localModel=e,this._field=t}static from(e,t){return Ia(e.schema,t)?new this(e,t):null}static allFrom(e){const t=[];for(const n of Object.keys(e.schema.fields)){const r=Mc.from(e,n);r&&t.push(r)}return t}get localDefinition(){return this.localModel.schema}get field(){return this._field}get localConstructor(){return this.localModel.builder}get type(){return this.localAssocation.connectionType}get localAssocation(){return this.localDefinition.fields[this.field].association}get localJoinFields(){return this.localAssocation.targetName?[this.localAssocation.targetName]:this.localAssocation.targetNames?this.localAssocation.targetNames:this.localPKFields}get localPKFields(){return this.localModel.pkField}get remoteDefinition(){return this.remoteModelType.modelConstructor?.schema}get remoteModelType(){return this.localDefinition.fields[this.field].type}get remoteModelConstructor(){return this.remoteModelType.modelConstructor.builder}get remotePKFields(){return this.remoteModelType.modelConstructor?.pkField||["id"]}get localAssociatedWith(){return"HAS_MANY"===this.localAssocation.connectionType||"HAS_ONE"===this.localAssocation.connectionType?Array.isArray(this.localAssocation.associatedWith)?this.localAssocation.associatedWith:[this.localAssocation.associatedWith]:void 0}get explicitRemoteAssociation(){if(this.localAssociatedWith)return 1===this.localAssociatedWith.length?this.remoteDefinition.fields[this.localAssociatedWith[0]]?.association:void 0}get remoteJoinFields(){return this.explicitRemoteAssociation?.targetName?[this.explicitRemoteAssociation.targetName]:this.explicitRemoteAssociation?.targetNames?this.explicitRemoteAssociation?.targetNames:this.localAssociatedWith?this.localAssociatedWith:this.remotePKFields}get isComplete(){return this.localJoinFields.length>0&&this.remoteJoinFields.length>0}createLocalFKObject(e){const t={};for(let n=0;n<this.localJoinFields.length;n++)t[this.localJoinFields[n]]=e[this.remoteJoinFields[n]];return t}createRemoteQueryObject(e){const t={};for(let n=0;n<this.remoteJoinFields.length;n++){if(null==e[this.localJoinFields[n]])return null;t[this.remoteJoinFields[n]]=e[this.localJoinFields[n]]}return t}}const Lc=new kn("DataStore"),Fc="amplify-datastore";class $c{constructor(){this.dbName=Fc}async setUp(e,t,n,r,i){if(await this.preSetUpChecks(),this.initPromise)await this.initPromise;else{this.initPromise=new Promise(((e,t)=>{this.resolve=e,this.reject=t})),i&&(this.dbName=`${Fc}-${i}`),this.schema=e,this.namespaceResolver=t,this.modelInstanceCreator=n,this.getModelConstructorByModelName=r;try{this.db||(this.db=await this.initDb(),this.resolve())}catch(e){this.reject(e)}}}getStorenameForModel(e){const t=this.namespaceResolver(e),{name:n}=e;return da(t,n)}getIndexKeyValuesFromModel(e){const t=Object.getPrototypeOf(e).constructor,n=this.namespaceResolver(t),r=wa(this.schema.namespaces[n],t.name);return fa(e,r)}saveMetadata(e){const t=Object.getPrototypeOf(e).constructor,n=this.getStorenameForModel(t),r=this.namespaceResolver(t),i=Gs(t.name,e,this.schema.namespaces[r],this.modelInstanceCreator,this.getModelConstructorByModelName),o=new Set,s=Object.values(i).map((({modelName:e,item:t,instance:n})=>{const i=da(r,e);return o.add(i),{storeName:i,item:t,instance:n,keys:wa(this.schema.namespaces[r],e)}})),a=this.getIndexKeyValuesFromModel(e);return{storeName:n,set:o,connectionStoreNames:s,modelKeyValues:a}}validateSaveCondition(e,t){if(!e||!t)return;const n=Xa.getPredicates(e),{predicates:r,type:i}=n;if(!js(t,i,r)){const e="Conditional update failed";throw Lc.error(e,{model:t,condition:r}),new Error(e)}}async load(e,t,n){const r=this.schema.namespaces[e].relationships[t].relationTypes.map((({modelName:t})=>da(e,t))),i=this.getModelConstructorByModelName(e,t);return r.length,n.map((e=>this.modelInstanceCreator(i,e)))}keyValueFromPredicate(e,t){const{predicates:n}=e;if(n.length!==t.length)return;const r=[];for(const e of t){const t=n.find((t=>Ba(t)&&t.field===e&&"eq"===t.operator&&null!==t.operand&&void 0!==t.operand));t&&r.push(t.operand)}return r.length===t.length?r:void 0}queryMetadata(e,t,n){const r=this.getStorenameForModel(e),i=this.namespaceResolver(e),o=t&&Xa.getPredicates(t),s=wa(this.schema.namespaces[i],e.name);return{storeName:r,namespaceName:i,queryByKey:o&&this.keyValueFromPredicate(o,s),predicates:o,hasSort:n&&n.sort,hasPagination:n&&n.limit}}async delete(e,t){await this.preOpCheck();const n=[];if(Bs(e)){const r=e,i=this.namespaceResolver(r),o=await this.query(r,t);return await this.deleteTraverse(o,r,i,n),await this.deleteItem(n),[o,n.reduce(((e,{items:t})=>e.concat(t)),[])]}{const r=e,i=Object.getPrototypeOf(r).constructor,o=this.namespaceResolver(i),s=this.getStorenameForModel(i);if(t){const e=this.getIndexKeyValuesFromModel(r),a=await this._get(s,e);if(void 0===a){const e="Model instance not found in storage";return Lc.warn(e,{model:r}),[[r],[]]}const c=Xa.getPredicates(t),{predicates:u,type:l}=c;if(!js(a,l,u)){const e="Conditional update failed";throw Lc.error(e,{model:a,condition:u}),new Error(e)}await this.deleteTraverse([r],i,o,n)}else await this.deleteTraverse([r],i,o,n);return await this.deleteItem(n),[[r],n.reduce(((e,{items:t})=>e.concat(t)),[])]}}async deleteTraverse(e,t,n,r){const i=["HAS_ONE","HAS_MANY"];for await(const o of e){const e=this.schema.namespaces[n].models[t.name],s={builder:t,schema:e,pkField:pa(e)},a=Mc.allFrom(s).filter((e=>i.includes(e.type)));for await(const e of a){const t=e.createRemoteQueryObject(o);if(null!==t){const i=await this.query(e.remoteModelConstructor,Xa.createFromFlatEqualities(e.remoteDefinition,t));await this.deleteTraverse(i,e.remoteModelConstructor,n,r)}}}r.push({storeName:da(n,t.name),items:e})}}const jc=new kn("DataStore");var Uc=new class extends $c{constructor(){super(...arguments),this.safariCompatabilityMode=!1,this.canonicalKeyPath=e=>this.safariCompatabilityMode?e.length>1?e:e[0]:e}async preSetUpChecks(){await this.checkPrivate(),await this.setSafariCompatabilityMode()}async preOpCheck(){await this.checkPrivate()}async initDb(){return await function(e,t,{blocked:n,upgrade:r,blocking:i,terminated:o}={}){const s=indexedDB.open(e,t),a=Oc(s);return r&&s.addEventListener("upgradeneeded",(e=>{r(Oc(s.result),e.oldVersion,e.newVersion,Oc(s.transaction))})),n&&s.addEventListener("blocked",(()=>n())),a.then((e=>{o&&e.addEventListener("close",(()=>o())),i&&e.addEventListener("versionchange",(()=>i()))})).catch((()=>{})),a}(this.dbName,3,{upgrade:async(e,t,n,r)=>{if(0!==t)if(1!==t&&2!==t||3!==n);else try{for(const t of r.objectStoreNames){const n=r.objectStore(t),i=`tmp_${t}`;n.name=i;const{namespaceName:o,modelName:s}=this.getNamespaceAndModelFromStorename(t);if(!(s in this.schema.namespaces[o].models)){e.deleteObjectStore(i);continue}const a=this.createObjectStoreForModel(e,o,t,s);let c=await n.openCursor(),u=0;for(;c&&c.value;)await a.put(c.value),c=await c.continue(),u++;e.deleteObjectStore(i),jc.debug(`${u} ${t} records migrated`)}Object.keys(this.schema.namespaces).forEach((t=>{const n=this.schema.namespaces[t],i=new Set(r.objectStoreNames);Object.keys(n.models).map((e=>[e,da(t,e)])).filter((([,e])=>!i.has(e))).forEach((([n,r])=>{this.createObjectStoreForModel(e,t,r,n)}))}))}catch(e){throw jc.error("Error migrating IndexedDB data",e),r.abort(),e}else Object.keys(this.schema.namespaces).forEach((t=>{const n=this.schema.namespaces[t];Object.keys(n.models).forEach((n=>{const r=da(t,n);this.createObjectStoreForModel(e,t,r,n)}))}))}})}async _get(e,t){let n;if("string"==typeof e){const t=e;n=this.db.transaction(t,"readonly").store.index("byPk")}else n=e.index("byPk");return await n.get(this.canonicalKeyPath(t))}async clear(){await this.checkPrivate(),this.db?.close(),await function(e,{blocked:t}={}){const n=indexedDB.deleteDatabase(e);return t&&n.addEventListener("blocked",(()=>t())),Oc(n).then((()=>{}))}(this.dbName),this.db=void 0,this.initPromise=void 0}async save(e,t){await this.checkPrivate();const{storeName:n,set:r,connectionStoreNames:i,modelKeyValues:o}=this.saveMetadata(e),s=this.db.transaction([n,...Array.from(r.values())],"readwrite"),a=s.objectStore(n),c=await this._get(a,o);this.validateSaveCondition(t,c);const u=[];for await(const e of i){const{storeName:t,item:n,instance:r,keys:i}=e,a=s.objectStore(t),c=i.map((e=>n[e])),l=await this._get(a,c)?xa.UPDATE:xa.INSERT;if(ba(c,o)||l===xa.INSERT){const e=await a.index("byPk").getKey(this.canonicalKeyPath(c));await a.put(n,e),u.push([r,l])}}return await s.done,u}async query(e,t,n){await this.checkPrivate();const{storeName:r,namespaceName:i,queryByKey:o,predicates:s,hasSort:a,hasPagination:c}=this.queryMetadata(e,t,n),u=await(async()=>{if(o){const e=await this.getByKey(r,o);return e?[e]:[]}if(s){const e=await this.filterOnPredicate(r,s);return this.inMemoryPagination(e,n)}if(a){const e=await this.getAll(r);return this.inMemoryPagination(e,n)}return c?this.enginePagination(r,n):this.getAll(r)})();return await this.load(i,e.name,u)}async queryOne(e,t=Pa.FIRST){await this.checkPrivate();const n=this.getStorenameForModel(e),r=await this.db.transaction([n],"readonly").objectStore(n).openCursor(void 0,t===Pa.FIRST?"next":"prev"),i=r?r.value:void 0;return i&&this.modelInstanceCreator(e,i)}async batchSave(e,t){if(await this.checkPrivate(),0===t.length)return[];const n=e.name,r=this.namespaceResolver(e),i=this.getStorenameForModel(e),o=[],s=this.db.transaction(i,"readwrite"),a=s.store;for(const i of t){const t=this.modelInstanceCreator(e,i),s=Gs(n,t,this.schema.namespaces[r],this.modelInstanceCreator,this.getModelConstructorByModelName),c=this.getIndexKeyValuesFromModel(t),{_deleted:u}=i,l=a.index("byPk"),d=await l.getKey(this.canonicalKeyPath(c));if(u)o.push([i,xa.DELETE]),d&&await a.delete(d);else{const{instance:e}=s.find((({instance:e})=>{const t=this.getIndexKeyValuesFromModel(e);return ba(t,c)}));o.push([e,d?xa.UPDATE:xa.INSERT]),await a.put(e,d)}}return await s.done,o}async deleteItem(e){const t=e.map((({storeName:e})=>e)),n=this.db.transaction([...t],"readwrite");for await(const t of e){const{storeName:e,items:r}=t,i=n.objectStore(e);for await(const e of r)if(e){let t;if("object"==typeof e){const n=this.getIndexKeyValuesFromModel(e);t=await i.index("byPk").getKey(this.canonicalKeyPath(n))}else{const n=e.toString();t=await i.index("byPk").getKey(n)}void 0!==t&&await i.delete(t)}}}async checkPrivate(){return await new Promise((e=>{const t=Zr();let n;const r=()=>{Vs=!1,e(!0)},i=async()=>(n&&n.result&&"function"==typeof n.result.close&&await n.result.close(),await indexedDB.deleteDatabase(t),Vs=!0,e(!1));return!0===Vs?i():!1===Vs||null===indexedDB?r():(n=indexedDB.open(t),n.onerror=r,void(n.onsuccess=i))})).then((e=>e))?(jc.error("IndexedDB not supported in this browser's private mode"),Promise.reject("IndexedDB not supported in this browser's private mode")):Promise.resolve()}async setSafariCompatabilityMode(){this.safariCompatabilityMode=await(async()=>{try{const e=Zr(),t="indexedDBFeatureProbeStore",n="idx";if(null===indexedDB)return!1;if(void 0!==Ws)return Ws;const r=await new Promise((r=>{const i=indexedDB.open(e);i.onerror=()=>r(!1),i.onsuccess=()=>{const e=i.result;r(e)},i.onupgradeneeded=e=>{const i=e?.target?.result;i.onerror=()=>r(!1),i.createObjectStore(t,{autoIncrement:!0}).createIndex(n,["id"])}}));if(!r)throw new Error("Could not open probe DB");const i=r.transaction(t,"readwrite");i.objectStore(t).add({id:1}),i.commit();const o=await new Promise((e=>{const i=r.transaction(t,"readonly").objectStore(t).index(n).get([1]);i.onerror=()=>e(!1),i.onsuccess=t=>{e(t?.target?.result)}}));r&&"function"==typeof r.close&&await r.close(),await indexedDB.deleteDatabase(e),Ws=void 0===o}catch(e){Ws=!1}return Ws})(),!0===this.safariCompatabilityMode&&jc.debug("IndexedDB Adapter is running in Safari Compatability Mode")}getNamespaceAndModelFromStorename(e){const[t,...n]=e.split("_");return{namespaceName:t,modelName:n.join("_")}}createObjectStoreForModel(e,t,n,r){const i=e.createObjectStore(n,{autoIncrement:!0}),{indexes:o}=this.schema.namespaces[t].relationships[r];return o.forEach((([e,t,n])=>{i.createIndex(e,t,n)})),i}async getByKey(e,t){return await this._get(e,t)}async getAll(e){return await this.db.getAll(e)}matchingIndexQueries(e,t,n){const r=[],i=new Map;for(const e of t)i.set(String(e.field),e);const o=n.objectStore(e);for(const t of o.indexNames){const n=o.index(t),s=Array.isArray(n.keyPath)?n.keyPath:[n.keyPath],a=[];for(const e of s){const t=i.get(e);if(!t||null===t.operand||void 0===t.operand)break;a.push(t.operand)}a.length===s.length&&r.push((()=>this.db.transaction(e).objectStore(e).index(t).getAll(this.canonicalKeyPath(a))))}return r}async baseQueryIndex(e,t,n){let{predicates:r,type:i}=t;for(;1===r.length&&qa(r[0])&&"not"!==r[0].type;)i=r[0].type,r=r[0].predicates;const o=r.filter((e=>Ba(e)&&"eq"===e.operator)),s=n||this.db.transaction(e);let a={};if("or"===i){const t=await Promise.all(r.filter((e=>qa(e)&&"and"===e.type)).map((t=>this.baseQueryIndex(e,t,s)))).then((e=>e.filter((e=>1===e.indexedQueries.length)).map((e=>e.indexedQueries)))),n=r.filter((e=>Ba(e))).map((t=>this.matchingIndexQueries(e,[t],s))),i=[...t,...n].map((e=>e[0])).filter((e=>e));a=r.length>i.length?{groupType:null,indexedQueries:[]}:{groupType:"or",indexedQueries:i}}else a="and"===i?{groupType:i,indexedQueries:this.matchingIndexQueries(e,o,s)}:{groupType:null,indexedQueries:[]};return n||await s.done,a}async filterOnPredicate(e,t){const{predicates:n,type:r}=t,{groupType:i,indexedQueries:o}=await this.baseQueryIndex(e,t);let s;if("and"===i&&o.length>0)s=await o[0]();else if("or"===i&&o.length>0&&o.length<=7){const e=new Map;for(const t of o){const n=await t();for(const t of n){const n=JSON.stringify(t);e.set(n,t)}}s=Array.from(e.values())}else s=await this.getAll(e);const a=n?s.filter((e=>js(e,r,n))):s;return a}inMemoryPagination(e,t){return Zs(e,t)}async enginePagination(e,t){let n;if(t){const{page:r=0,limit:i=0}=t,o=Math.max(0,r*i)||0;let s=await this.db.transaction(e).objectStore(e).openCursor();s&&o>0&&await s.advance(o);const a=[],c="number"==typeof i&&i>0;for(;s&&s.value&&(a.push(s.value),!c||a.length!==i);)s=await s.continue();n=a}else n=await this.db.getAll(e);return n}};class Bc{constructor(){this.db=new Map,this.getAllKeys=async()=>Array.from(this.db.keys()),this.multiGet=async e=>e.reduce(((e,t)=>(e.push([t,this.db.get(t)]),e)),[]),this.multiRemove=async(e,t)=>{e.forEach((e=>this.db.delete(e))),"function"==typeof t&&t()},this.multiSet=async(e,t)=>{e.forEach((([e,t])=>{this.setItem(e,t)})),"function"==typeof t&&t()},this.setItem=async(e,t)=>this.db.set(e,t),this.removeItem=async e=>this.db.delete(e),this.getItem=async e=>this.db.get(e)}}const qc="@AmplifyDatastore",Kc=new Map;class Gc{constructor(){this._collectionInMemoryIndex=new Map,this.storage=new Bc}getCollectionIndex(e){return this._collectionInMemoryIndex.has(e)||this._collectionInMemoryIndex.set(e,new Map),this._collectionInMemoryIndex.get(e)}getMonotonicFactory(e){return Kc.has(e)||Kc.set(e,Hs()),Kc.get(e)}async init(){this._collectionInMemoryIndex.clear();const e=await this.storage.getAllKeys(),t=[];for(const n of e){const[e,r,i,o,s]=n.split("::");if(e===qc)if("Data"===i){let e;if(void 0===s){const t=o,n=this.getMonotonicFactory(r)(),i=this.getLegacyKeyForItem(r,t),s=this.getKeyForItem(r,t,n),a=await this.storage.getItem(i);await this.storage.setItem(s,a),await this.storage.removeItem(i),e=n}else e=o;this.getCollectionIndex(r).set(s,e)}else"Collection"===i&&t.push(n)}t.length>0&&await this.storage.multiRemove(t)}async save(e,t,n,r){const i=va(n),o=this.getCollectionIndex(t)?.get(i)||this.getMonotonicFactory(t)(),s=this.getKeyForItem(t,r,o);this.getCollectionIndex(t)?.set(r,o),await this.storage.setItem(s,JSON.stringify(e))}async batchSave(e,t,n){if(0===t.length)return[];const r=[],i=this.getCollectionIndex(e),o=new Set,s=new Set,a=[],c={};for(const r of t){const t=n.map((e=>r[e])),{_deleted:u}=r,l=i.get(t.join(xs))||this.getMonotonicFactory(e)(),d=this.getKeyForItem(e,t.join(xs),l);a.push(d),c[d]={ulid:l,model:r},u?o.add(d):s.add(d)}const u=(await this.storage.multiGet(a)).filter((([,e])=>!!e)).reduce(((e,[t])=>e.add(t)),new Set);await new Promise(((e,t)=>{if(0===o.size)return void e();const r=Array.from(o);r.forEach((e=>{const t=n.map((t=>c[e].model[t])).join(xs);i.delete(t)})),this.storage.multiRemove(r,(n=>{n&&n.length>0?t(n):e()}))})),await new Promise(((e,t)=>{if(0===s.size)return void e();const r=Array.from(s).map((e=>[e,JSON.stringify(c[e].model)]));s.forEach((e=>{const{model:t,ulid:r}=c[e],o=n.map((e=>t[e])).join(xs);i.set(o,r)})),this.storage.multiSet(r,(n=>{n&&n.length>0?t(n):e()}))}));for(const e of a)o.has(e)&&u.has(e)?r.push([c[e].model,xa.DELETE]):s.has(e)&&r.push([c[e].model,u.has(e)?xa.UPDATE:xa.INSERT]);return r}async get(e,t){const n=this.getCollectionIndex(t).get(e),r=this.getKeyForItem(t,e,n),i=await this.storage.getItem(r);return i&&JSON.parse(i)}async getOne(e,t){const n=this.getCollectionIndex(t),[r,i]=e===Pa.FIRST?(()=>{let e,t;for([e,t]of n)break;return[e,t]})():(()=>{let e,t;for([e,t]of n);return[e,t]})(),o=this.getKeyForItem(t,r,i),s=o&&await this.storage.getItem(o);return s&&JSON.parse(s)||void 0}async getAll(e,t){const n=this.getCollectionIndex(e),{page:r=0,limit:i=0}=t||{},o=Math.max(0,r*i)||0,s=i>0?o+i:void 0,a=[];let c=0;for(const[t,r]of n)if(c++,!(c<=o)&&(a.push(this.getKeyForItem(e,t,r)),c===s))break;return(await this.storage.multiGet(a)).filter((([,e])=>e)).map((([,e])=>JSON.parse(e)))}async delete(e,t){const n=this.getCollectionIndex(t).get(e),r=this.getKeyForItem(t,e,n);this.getCollectionIndex(t).delete(e),await this.storage.removeItem(r)}async clear(){const e=(await this.storage.getAllKeys()).filter((e=>e.startsWith(qc)));await this.storage.multiRemove(e),this._collectionInMemoryIndex.clear()}getKeyForItem(e,t,n){return`${this.getKeyPrefixForStoreItems(e)}::${n}::${t}`}getLegacyKeyForItem(e,t){return`${this.getKeyPrefixForStoreItems(e)}::${t}`}getKeyPrefixForStoreItems(e){return`@AmplifyDatastore::${e}::Data`}}var Vc=new class extends $c{async preSetUpChecks(){}async preOpCheck(){}async initDb(){const e=new Gc;return await e.init(),e}async clear(){await this.db.clear(),this.db=void 0,this.initPromise=void 0}async batchSave(e,t){if(0===t.length)return[];const n=e.name,r=this.namespaceResolver(e),i=da(r,n),o=wa(this.schema.namespaces[r],n),s=[];for(const i of t){const t=this.modelInstanceCreator(e,i),o=Gs(n,t,this.schema.namespaces[r],this.modelInstanceCreator,this.getModelConstructorByModelName),a=this.getIndexKeyValuesPath(t),{instance:c}=o.find((({instance:e})=>{const t=this.getIndexKeyValuesPath(e);return ba([t],[a])}));s.push(c)}return await this.db.batchSave(i,s,o)}async _get(e,t){const n=t.join(xs);return await this.db.get(n,e)}async save(e,t){const{storeName:n,connectionStoreNames:r,modelKeyValues:i}=this.saveMetadata(e),o=await this._get(n,i);this.validateSaveCondition(t,o);const s=[];for await(const e of r){const{storeName:t,item:n,instance:r,keys:o}=e,a=o.map((e=>n[e])),c=await this._get(t,a)?xa.UPDATE:xa.INSERT;(ba(a,i)||c===xa.INSERT)&&(await this.db.save(n,t,o,a.join(xs)),s.push([r,c]))}return s}async query(e,t,n){const{storeName:r,namespaceName:i,queryByKey:o,predicates:s,hasSort:a,hasPagination:c}=this.queryMetadata(e,t,n),u=await(async()=>{if(o){const e=o.join(xs),t=await this.getByKey(r,e);return t?[t]:[]}if(s){const e=await this.filterOnPredicate(r,s);return this.inMemoryPagination(e,n)}if(a||c){const e=await this.getAll(r);return this.inMemoryPagination(e,n)}return this.getAll(r)})();return await this.load(i,e.name,u)}async getByKey(e,t){return await this.db.get(t,e)}async getAll(e){return await this.db.getAll(e)}async filterOnPredicate(e,t){const{predicates:n,type:r}=t,i=await this.getAll(e),o=n?i.filter((e=>js(e,r,n))):i;return o}inMemoryPagination(e,t){return Zs(e,t)}async queryOne(e,t=Pa.FIRST){const n=this.getStorenameForModel(e),r=await this.db.getOne(t,n);return r&&this.modelInstanceCreator(e,r)}async deleteItem(e){for await(const t of e){const{storeName:e,items:n}=t;for await(const t of n)if(t&&"object"==typeof t){const n=this.getIndexKeyValuesPath(t);await this.db.delete(n,e)}}}getIndexKeyValuesPath(e){return this.getIndexKeyValuesFromModel(e).join(xs)}};const Wc=()=>"undefined"!=typeof window&&void 0!==window.document;class zc{constructor(){this._queue=[],this._pending=!1}isLocked(){return this._pending}acquire(){const e=new Promise((e=>this._queue.push(e)));return this._pending||this._dispatchNext(),e}runExclusive(e){return this.acquire().then((t=>{let n;try{n=e()}catch(e){throw t(),e}return Promise.resolve(n).then((e=>(t(),e)),(e=>{throw t(),e}))}))}_dispatchNext(){this._queue.length>0?(this._pending=!0,this._queue.shift()(this._dispatchNext.bind(this))):this._pending=!1}}const Qc=new kn("DataStore");class Hc{constructor(e,t,n,r,i,o){this.schema=e,this.namespaceResolver=t,this.getModelConstructorByModelName=n,this.modelInstanceCreator=r,this.adapter=i,this.sessionId=o,this.adapter=this.adapter||(Wc&&window.indexedDB||Ei()&&self.indexedDB?Uc:Vc),this.pushStream=new ec}static getNamespace(){return{name:Fs,relationships:{},enums:{},models:{},nonModels:{}}}async init(){if(void 0!==this.initialized)return void await this.initialized;let e,t;Qc.debug("Starting Storage"),this.initialized=new Promise(((n,r)=>{e=n,t=r})),this.adapter.setUp(this.schema,this.namespaceResolver,this.modelInstanceCreator,this.getModelConstructorByModelName,this.sessionId).then(e,t),await this.initialized}async save(e,t,n,r){if(await this.init(),!this.adapter)throw new Error("Storage adapter is missing");const i=await this.adapter.save(e,t);return i.forEach((o=>{const[s,a]=o,c=!!n;let u;if((a===xa.UPDATE||a===xa.INSERT)&&!c&&(u=this.getChangedFieldsInput(e,s,r),null===u))return i;const l=u||s,d=Object.getPrototypeOf(s).constructor;this.pushStream.next({model:d,opType:a,element:l,mutator:n,condition:t&&Xa.getPredicates(t,!1)||null,savedElement:s})})),i}async delete(e,t,n){if(await this.init(),!this.adapter)throw new Error("Storage adapter is missing");let r,i;[r,i]=await this.adapter.delete(e,t);const o=Bs(e)?e:Object.getPrototypeOf(e||{}).constructor,s=this.namespaceResolver(o),a=this.schema.namespaces[s].models[o.name],c=new Set(r.map((e=>vc(a,e))));return Bs(e)||Array.isArray(i)||(i=[i]),i.forEach((r=>{const i=Object.getPrototypeOf(r).constructor;let o;if(!Bs(e)){const e=vc(a,r);o=c.has(e)?Xa.getPredicates(t,!1):void 0}this.pushStream.next({model:i,opType:xa.DELETE,element:r,mutator:n,condition:o||null})})),[r,i]}async query(e,t,n){if(await this.init(),!this.adapter)throw new Error("Storage adapter is missing");return await this.adapter.query(e,t,n)}async queryOne(e,t=Pa.FIRST){if(await this.init(),!this.adapter)throw new Error("Storage adapter is missing");return await this.adapter.queryOne(e,t)}observe(e,t,n){const r=!e,{predicates:i,type:o}=t&&Xa.getPredicates(t,!1)||{};let s=this.pushStream.pipe(gi((({mutator:e})=>!n||e!==n))).pipe(mi((({mutator:e,...t})=>t)));return r||(s=s.pipe(gi((({model:t,element:n})=>e===t&&(!i||!o||js(n,o,i)))))),s}async clear(e=!0){if(this.initialized=void 0,!this.adapter)throw new Error("Storage adapter is missing");await this.adapter.clear(),e&&this.pushStream.complete()}async batchSave(e,t,n){if(await this.init(),!this.adapter)throw new Error("Storage adapter is missing");const r=await this.adapter.batchSave(e,t);return r.forEach((([t,r])=>{this.pushStream.next({model:e,opType:r,element:t,mutator:n,condition:null})})),r}getChangedFieldsInput(e,t,n){if(!n||!n.length)return null;const[r,i]=n,o={},s=r.map((e=>e.path&&e.path[0])),a=Object.getPrototypeOf(e).constructor,c=this.namespaceResolver(a),{fields:u}=this.schema.namespaces[c].models[a.name],{primaryKey:l,compositeKeys:d=[]}=this.schema.namespaces[c].keys?.[a.name]||{};if(s.forEach((e=>{const n=Ea(u[e]?.association);if(Array.isArray(n)){for(const e of n)if(!Xs(i[e],t[e])){o[e]=void 0===t[e]?null:t[e];for(const n of d)if(n.has(e))for(const e of n)o[e]=t[e]}}else{const r=n||e;if(!Xs(i[r],t[r])){o[r]=void 0===t[r]?null:t[r];for(const e of d)if(e.has(r))for(const n of e)o[n]=t[n]}}})),0===Object.keys(o).length)return null;if(l&&l.length)for(const e of l)o[e]=t[e];const{id:h,_version:p,_lastChangedAt:f,_deleted:y}=t;return{...o,id:h,_version:p,_lastChangedAt:f,_deleted:y}}}class Yc{constructor(e,t,n,r,i,o){this.mutex=new zc,this.storage=new Hc(e,t,n,r,i,o)}runExclusive(e){return this.mutex.runExclusive(e.bind(this,this.storage))}async save(e,t,n,r){return this.runExclusive((i=>i.save(e,t,n,r)))}async delete(e,t,n){return this.runExclusive((r=>{if(Bs(e)){const i=e;return r.delete(i,t,n)}{const i=e;return r.delete(i,t,n)}}))}async query(e,t,n){return this.runExclusive((r=>r.query(e,t,n)))}async queryOne(e,t=Pa.FIRST){return this.runExclusive((n=>n.queryOne(e,t)))}static getNamespace(){return Hc.getNamespace()}observe(e,t,n){return this.storage.observe(e,t,n)}async clear(){await this.runExclusive((e=>e.clear()))}batchSave(e,t){return this.storage.batchSave(e,t)}async init(){return this.storage.init()}}function Jc(e){return(n=(t=e)[t.length-1])&&We(n.schedule)?e.pop():void 0;var t,n}const Xc=(new Ii).networkMonitor();new kn("DataStore");class Zc{constructor(){this.connectionStatus={online:!1}}status(){if(this.observer)throw new Error("Subscriber already exists");return new It((e=>(this.observer=e,this.subscription=Xc.subscribe((({online:t})=>{this.connectionStatus.online=t;const n={...this.connectionStatus};e.next(n)})),()=>{clearTimeout(this.timeout),this.unsubscribe()})))}unsubscribe(){this.subscription&&(clearTimeout(this.timeout),this.subscription.unsubscribe())}async stop(){this.unsubscribe()}socketDisconnected(){this.observer&&"function"==typeof this.observer.next&&(this.observer.next({online:!1}),this.timeout=setTimeout((()=>{const e={...this.connectionStatus};this.observer.next(e)}),5e3))}}class eu{constructor(e,t){this.outbox=e,this.ownSymbol=t}async merge(e,t,n){let r;const i=await this.outbox.getForModel(e,t,n),o=t._deleted;return 0===i.length&&(o?(r=xa.DELETE,await e.delete(t,void 0,this.ownSymbol)):[[,r]]=await e.save(t,void 0,this.ownSymbol)),r}async mergePage(e,t,n,r){const i=new Map;for(const e of n){const t=vc(r,e);i.set(t,e)}const o=[...i.values()];return await e.batchSave(t,o,this.ownSymbol)}}class tu{constructor(e,t,n,r){this.schema=e,this.MutationEvent=t,this.modelInstanceCreator=n,this.ownSymbol=r}async enqueue(e,t){await e.runExclusive((async e=>{const n=this.schema.namespaces[Ls].models.MutationEvent,r=Xa.createFromAST(n,{and:[{modelId:{eq:t.modelId}},{id:{ne:this.inProgressMutationEventId}}]}),[i]=await e.query(this.MutationEvent,r);if(void 0===i)return void await e.save(t,void 0,this.ownSymbol);const{operation:o}=t;if(i.operation===ic.CREATE)if(o===ic.DELETE)await e.delete(this.MutationEvent,r);else{const n=this.mergeUserFields(i,t);await e.save(this.MutationEvent.copyOf(i,(e=>{e.data=n.data})),void 0,this.ownSymbol)}else{const{condition:n}=t,o=JSON.parse(n);let s;0===Object.keys(o).length&&(s=this.mergeUserFields(i,t),await e.delete(this.MutationEvent,r)),s=s||t,await e.save(s,void 0,this.ownSymbol)}}))}async dequeue(e,t,n){const r=await this.peek(e);return t&&await this.syncOutboxVersionsOnDequeue(e,t,r,n),r&&await e.delete(r),this.inProgressMutationEventId=void 0,r}async peek(e){const t=await e.queryOne(this.MutationEvent,Pa.FIRST);return this.inProgressMutationEventId=t?t.id:void 0,t}async getForModel(e,t,n){const r=this.schema.namespaces[Ls].models.MutationEvent,i=vc(n,t);return await e.query(this.MutationEvent,Xa.createFromAST(r,{and:{modelId:{eq:i}}}))}async getModelIds(e){const t=await e.query(this.MutationEvent),n=new Set;return t.forEach((({modelId:e})=>n.add(e))),n}async syncOutboxVersionsOnDequeue(e,t,n,r){if(n?.operation!==r)return;const{_version:i,_lastChangedAt:o,_deleted:s,...a}=t,c=this.removeTimestampFields(n.model,a),u=JSON.parse(n.data);if(!u)return;const{_version:l,_lastChangedAt:d,_deleted:h,...p}=u;if(!function(e,t,n=!1){const r=Object.keys(e);for(const i of r)if(!Xs(e[i],t[i],n))return!1;return!0}(this.removeTimestampFields(n.model,p),c,!0))return;const f=this.schema.namespaces[Ls].models.MutationEvent,y=vc(this.schema.namespaces.user.models[n.model],t),m=Xa.createFromAST(f,{and:[{modelId:{eq:y}},{id:{ne:this.inProgressMutationEventId}}]}),g=await e.query(this.MutationEvent,m);if(!g.length)return;const v=g.map((e=>{const t={...JSON.parse(e.data),_version:i,_lastChangedAt:o};return this.MutationEvent.copyOf(e,(e=>{e.data=JSON.stringify(t)}))}));await e.delete(this.MutationEvent,m),await Promise.all(v.map((async t=>await e.save(t,void 0,this.ownSymbol))))}mergeUserFields(e,t){const{_version:n,_lastChangedAt:r,_deleted:i,...o}=JSON.parse(e.data),{_version:s,_lastChangedAt:a,_deleted:c,...u}=JSON.parse(t.data),l=JSON.stringify({_version:n,_lastChangedAt:r,_deleted:i,...o,...u});return this.modelInstanceCreator(this.MutationEvent,{...t,data:l})}removeTimestampFields(e,t){let n="createdAt",r="updatedAt";const i=this.schema.namespaces[Ms].models[e].attributes?.find((e=>"model"===e.type)),o=i?.properties?.timestamps;return o&&(n=o.createdAt,r=o.updatedAt),delete t[n],delete t[r],t}}const nu=e=>/^Connection failed: Connection Timeout/.test(e.message),ru=e=>yc(e)>=500,iu={BadModel:()=>!1,BadRecord:e=>{const{message:t}=e;return/^Cannot return \w+ for [\w-_]+ type/.test(t)||/^Variable '.+' has coerced Null value for NonNull type/.test(t)},ConfigError:()=>!1,Transient:e=>nu(e)||ru(e),Unauthorized:e=>"Unauthorized"===e.message||401===yc(e)},ou={BadModel:()=>!1,BadRecord:()=>!1,ConfigError:()=>!1,Transient:e=>{const t=au(e);return nu(t)||ru(t)},Unauthorized:e=>{const t=au(e);return/Connection failed.+Unauthorized/.test(t.message)}},su={BadModel:()=>!1,BadRecord:e=>/^Cannot return \w+ for [\w-_]+ type/.test(e.message),ConfigError:()=>!1,Transient:e=>nu(e)||ru(e),Unauthorized:e=>"Unauthorized"===e.errorType};function au(e){const{errors:[t]}=e;return t}function cu(e){return lu(iu,e)}function uu(e){return lu(su,e)}function lu(e,t){const n=[...Object.keys(e)];for(const r of n)if((0,e[r])?.(t))return r;return"Unknown"}const du=new kn("DataStore");class hu{constructor(e,t,n,r,i,o,s={},a,c,u,l){this.schema=e,this.storage=t,this.userClasses=n,this.outbox=r,this.modelInstanceCreator=i,this.MutationEvent=o,this.amplifyConfig=s,this.authModeStrategy=a,this.errorHandler=c,this.conflictHandler=u,this.amplifyContext=l,this.typeQuery=new WeakMap,this.processing=!1,this.runningProcesses=new ms,this.amplifyContext.InternalAPI=this.amplifyContext.InternalAPI||fo,this.generateQueries()}generateQueries(){Object.values(this.schema.namespaces).forEach((e=>{Object.values(e.models).filter((({syncable:e})=>e)).forEach((t=>{const[n]=uc(e,t,"CREATE"),[r]=uc(e,t,"UPDATE"),[i]=uc(e,t,"DELETE");this.typeQuery.set(t,[n,r,i])}))}))}isReady(){return void 0!==this.observer}start(){return this.runningProcesses=new ms,new It((e=>{this.observer=e;try{this.resume()}catch(e){throw du.error("mutations processor start error",e),e}return this.runningProcesses.addCleaner((async()=>{this.removeObserver(),this.pause()}))}))}async stop(){this.removeObserver(),await this.runningProcesses.close(),await this.runningProcesses.open()}removeObserver(){this.observer?.complete?.(),this.observer=void 0}async resume(){this.runningProcesses.isOpen&&await this.runningProcesses.add((async e=>{if(this.processing||!this.isReady()||!this.runningProcesses.isOpen)return;let t;this.processing=!0;const n=Ms;for(;this.processing&&this.runningProcesses.isOpen&&void 0!==(t=await this.outbox.peek(this.storage));){const{model:r,operation:i,data:o,condition:s}=t,a=this.userClasses[r];let c,u,l;try{const d=(await pc({authModeStrategy:this.authModeStrategy,defaultAuthMode:this.amplifyConfig.aws_appsync_authenticationType,modelName:r,schema:this.schema}))[i.toUpperCase()];let h=0;const p=async()=>{try{du.debug(`Attempting mutation with authMode: ${d[h]}`);const c=await this.jitteredRetry(n,r,i,o,s,a,this.MutationEvent,t,d[h],e);return du.debug(`Mutation sent successfully with authMode: ${d[h]}`),c}catch(e){if(h++,h>=d.length){du.debug(`Mutation failed with authMode: ${d[h-1]}`);try{await this.errorHandler({recoverySuggestion:"Ensure app code is up to date, auth directives exist and are correct on each model, and that server-side data has not been invalidated by a schema change. If the problem persists, search for or create an issue: https://github.com/aws-amplify/amplify-js/issues",localModel:null,message:e.message,model:a.name,operation:u,errorType:cu(e),process:La.sync,remoteModel:null,cause:e})}catch(e){du.error("Mutation error handler failed with:",e)}throw e}return du.debug(`Mutation failed with authMode: ${d[h-1]}. Retrying with authMode: ${d[h]}`),await p()}};[c,u,l]=await p()}catch(e){if("Offline"===e.message||"RetryMutation"===e.message)continue}if(void 0===c){du.debug("done retrying"),await this.storage.runExclusive((async e=>{await this.outbox.dequeue(e)}));continue}const d=c.data[u];let h=!1;await this.storage.runExclusive((async e=>{await this.outbox.dequeue(e,d,i),h=void 0!==await this.outbox.peek(e)})),this.observer?.next?.({operation:i,modelDefinition:l,model:d,hasMore:h})}this.pause()}),"mutation resume loop")}async jitteredRetry(e,t,n,r,i,o,s,a,c,u){return await ii((async(t,n,r,i,o,s,a)=>{const[u,l,d,h,p]=this.createQueryVariables(e,t,n,r,i),f=await gc(c,this.amplifyConfig),y={query:u,variables:l,authMode:c,authToken:f};let m=0;const g=this.opTypeFromTransformerOperation(n),v={category:Bt.DataStore,action:Vt.GraphQl};do{try{return[await this.amplifyContext.InternalAPI.graphql(y,void 0,v),h,p]}catch(t){if(!(t.errors&&t.errors.length>0))throw new si(t);{const[r]=t.errors,{originalError:{code:i=null}={}}=r;if("Unauthorized"===r.errorType)throw new si("Unauthorized");if("Network Error"===r.message||"ECONNABORTED"===i){if(!this.processing)throw new si("Offline");throw new Error("Network Error")}if("ConflictUnhandled"===r.errorType){let t;if(m++,m>10)t=Ka;else try{t=await this.conflictHandler({modelConstructor:o,localModel:this.modelInstanceCreator(o,l.input),remoteModel:this.modelInstanceCreator(o,r.data),operation:g,attempts:m})}catch(e){du.warn("conflict trycatch",e);continue}if(t===Ka){const[[,t,n]]=uc(this.schema.namespaces[e],p,"GET"),r=await gc(c,this.amplifyConfig);return[await this.amplifyContext.InternalAPI.graphql({query:n,variables:{id:l.input.id},authMode:c,authToken:r},void 0,v),t,p]}const n=lc(this.schema.namespaces[e].relationships,p,g,o,t,d,s,this.modelInstanceCreator,a.id);throw await this.storage.save(n),new si("RetryMutation")}try{this.errorHandler({recoverySuggestion:"Ensure app code is up to date, auth directives exist and are correct on each model, and that server-side data has not been invalidated by a schema change. If the problem persists, search for or create an issue: https://github.com/aws-amplify/amplify-js/issues",localModel:l.input,message:r.message,operation:n,errorType:cu(r),errorInfo:r.errorInfo,process:La.mutate,cause:r,remoteModel:r.data?this.modelInstanceCreator(o,r.data):null})}catch(e){du.warn("Mutation error handler failed with:",e)}finally{return r.data?[{data:{[h]:r.data}},h,p]:[]}}}}while(y)}),[t,n,r,i,o,s,a],yu,u)}createQueryVariables(e,t,n,r,i){const o=this.schema.namespaces[e].models[t],{primaryKey:s}=this.schema.namespaces[e].keys[t],a=o.attributes?.find((e=>"auth"===e.type)),c=a?.properties?.rules.map((e=>e.ownerField)).filter((e=>e))||["owner"],u=this.typeQuery.get(o),[,l,d]=u.find((([e])=>e===n)),{_version:h,...p}=JSON.parse(r),f={};if(s&&s.length)for(const e of s)f[e]=p[e];else f.id=p.id;let y;if(n===ic.DELETE)y=f;else{y={};const e=Object.values(o.fields);for(const{name:t,type:r,association:i,isReadOnly:o}of e)if(!(o||c.includes(t)&&null===p[t]))if($a(r)){if(Ea(i)&&"BELONGS_TO"===i.connectionType){const e=ga(i);if(e)for(const t of e)y[t]=p[t]}}else(n!==ic.UPDATE||p.hasOwnProperty(t))&&(y[t]=p[t])}const m={...y,_version:h},g=JSON.parse(i);return[d,{input:m,...n===ic.CREATE?{}:{condition:Object.keys(g).length>0?g:null}},g,l,o]}opTypeFromTransformerOperation(e){switch(e){case ic.CREATE:return xa.INSERT;case ic.DELETE:return xa.DELETE;case ic.UPDATE:return xa.UPDATE;case ic.GET:break;default:throw new Error(`Invalid operation ${e}`)}}pause(){this.processing=!1}}const pu=3e5,fu=jn(pu),yu=(e,t,n)=>{const r=fu(e);return!1===r&&"Network Error"===(n||{}).message?pu:r},mu=new kn("DataStore");var gu,vu;!function(e){e.CONNECTED="CONNECTED"}(gu||(gu={})),function(e){e[e.none=0]="none",e[e.unauth=1]="unauth",e[e.auth=2]="auth"}(vu||(vu={}));class bu{constructor(e,t,n={},r,i,o={InternalAPI:fo}){this.schema=e,this.syncPredicates=t,this.amplifyConfig=n,this.authModeStrategy=r,this.errorHandler=i,this.amplifyContext=o,this.typeQuery=new WeakMap,this.buffer=[],this.runningProcesses=new ms}buildSubscription(e,t,n,r,i,o,s=!1){const{aws_appsync_authenticationType:a}=this.amplifyConfig,{isOwner:c,ownerField:u,ownerValue:l}=this.getAuthorizationInfo(t,r,a,i,o)||{},[d,h,p]=function(e,t,n,r,i,o=!1){const s=sc(e,t),{name:a}=t,c=`on${n}${a}`,u=[],l=[];return o&&(u.push(`$filter: ModelSubscription${a}FilterInput`),l.push("filter: $filter")),r&&(u.push(`$${i}: String!`),l.push(`${i}: $${i}`)),[n,c,`subscription operation${u.length?`(${u.join(",")})`:""}{\n\t\t\t${c}${l.length?`(${l.join(",")})`:""}{\n\t\t\t\t${s}\n\t\t\t}\n\t\t}`]}(e,t,n,c,u,s);return{authMode:o,opType:d,opName:h,query:p,isOwner:c,ownerField:u,ownerValue:l}}getAuthorizationInfo(e,t,n,r,i){const o=cc(e);if("iam"===i&&o.find((e=>"private"===e.authStrategy&&"iam"===e.provider))&&t===vu.unauth)return null;const s=o.filter((e=>"groups"===e.authStrategy&&["userPools","oidc"].includes(e.provider)));if(("oidc"===i||"userPool"===i)&&s.find((e=>{if(r)return[...function(e,t){let n=e[t.groupClaim]||[];if("string"==typeof n){let e;try{e=JSON.parse(n)}catch(t){e=n}n=[].concat(e)}return n}(r,e)].find((t=>e.groups.find((e=>e===t))))})))return{authMode:i,isOwner:!1};let a;return a||(("oidc"===i||"userPool"===i?o.filter((e=>"owner"===e.authStrategy&&("oidc"===e.provider||"userPools"===e.provider))):[]).forEach((t=>{const n=r[t.identityClaim],o=!0!==e.fields[t.ownerField]?.isArray&&!t.areSubscriptionsPublic;n&&(a={authMode:i,isOwner:o,ownerField:t.ownerField,ownerValue:String(n)})})),a||{authMode:i||n,isOwner:!1})}hubQueryCompletionListener(e,t){const{payload:{event:n}}=t;n===ai.SUBSCRIPTION_ACK&&e()}start(){this.runningProcesses=this.runningProcesses||new ms;return[new It((e=>{const t=[];let n,r={},i=vu.none;return this.runningProcesses.add((async()=>{try{const e=(await zr()).tokens?.accessToken;i=e?vu.auth:vu.unauth}catch(e){}try{const e=await zr();n=e.tokens?.idToken?.payload}catch(e){}Object.values(this.schema.namespaces).forEach((o=>{Object.values(o.models).filter((({syncable:e})=>e)).forEach((s=>this.runningProcesses.isOpen&&this.runningProcesses.add((async()=>{const a=(await pc({authModeStrategy:this.authModeStrategy,defaultAuthMode:this.amplifyConfig.aws_appsync_authenticationType,modelName:s.name,schema:this.schema})).READ;r={...r,[s.name]:{[ic.CREATE]:[],[ic.UPDATE]:[],[ic.DELETE]:[]}};const c=[ic.CREATE,ic.UPDATE,ic.DELETE],u={[ic.CREATE]:0,[ic.UPDATE]:0,[ic.DELETE]:0},l=Xa.getPredicates(this.syncPredicates.get(s),!1),d=void 0!==l,h=async(c,p=d)=>{const{opType:f,opName:y,query:m,isOwner:g,ownerField:v,ownerValue:b,authMode:w}=this.buildSubscription(o,s,c,i,n,a[u[c]],p),S=await gc(w,this.amplifyConfig),A={},E={category:Bt.DataStore,action:Vt.Subscribe};if(p&&l&&(A.filter=dc(l)),g){if(!b)return void e.error("Owner field required, sign in is needed in order to perform this operation");A[v]=b}mu.debug(`Attempting ${c} subscription with authMode: ${a[u[c]]}`);const I=this.amplifyContext.InternalAPI.graphql({query:m,variables:A,authMode:w,authToken:S},void 0,E);let T;r[s.name][f].push(I.subscribe({next:e=>{const{data:t,errors:n}=e;if(Array.isArray(n)&&n.length>0){const e=n.map((({message:e})=>e));return mu.warn(`Skipping incoming subscription. Messages: ${e.join("\n")}`),void this.drainBuffer()}const r=Xa.getPredicates(this.syncPredicates.get(s),!1),{[y]:i}=t;this.passesPredicateValidation(i,r)&&this.pushToBuffer(f,s,i),this.drainBuffer()},error:async t=>{const{errors:[{message:n=""}={}]}=t;if(p&&this.catchRTFError(n,s,l))return r[s.name][f].forEach((e=>e.unsubscribe())),r[s.name][f]=[],void h(c,!1);if(n.includes(ai.REALTIME_SUBSCRIPTION_INIT_ERROR)||n.includes(ai.CONNECTION_FAILED)){if(r[s.name][f].forEach((e=>e.unsubscribe())),r[s.name][f]=[],u[c]++,!(u[c]>=a.length))return mu.debug(`${c} subscription failed with authMode: ${a[u[c]-1]}. Retrying with authMode: ${a[u[c]]}`),void h(c);mu.debug(`${c} subscription failed with authMode: ${a[u[c]-1]}`)}mu.warn("subscriptionError",n);try{await this.errorHandler({recoverySuggestion:"Ensure app code is up to date, auth directives exist and are correct on each model, and that server-side data has not been invalidated by a schema change. If the problem persists, search for or create an issue: https://github.com/aws-amplify/amplify-js/issues",localModel:null,message:n,model:s.name,operation:c,errorType:(i=t,lu(ou,i)),process:La.subscribe,remoteModel:null,cause:t})}catch(e){mu.error("Subscription error handler failed with:",e)}var i;"function"==typeof T&&T(),n.includes('"errorType":"Unauthorized"')||n.includes('"errorType":"OperationDisabled"')||e.error(n)}})),t.push((async()=>{let e,t;await new Promise((n=>{T=n,e=this.hubQueryCompletionListener.bind(this,n),t=Mr.listen("api",e)})),t()})())};c.forEach((e=>h(e)))}))))})),this.runningProcesses.isOpen&&this.runningProcesses.add((()=>Promise.all(t).then((()=>{e.next(gu.CONNECTED)}))))}),"subscription processor new subscriber"),this.runningProcesses.addCleaner((async()=>{Object.keys(r).forEach((e=>{r[e][ic.CREATE].forEach((e=>e.unsubscribe())),r[e][ic.UPDATE].forEach((e=>e.unsubscribe())),r[e][ic.DELETE].forEach((e=>e.unsubscribe()))}))}))})),new It((e=>(this.dataObserver=e,this.drainBuffer(),this.runningProcesses.addCleaner((async()=>{this.dataObserver=null})))))]}async stop(){await this.runningProcesses.close(),await this.runningProcesses.open()}passesPredicateValidation(e,t){if(!t)return!0;const{predicates:n,type:r}=t;return js(e,r,n)}pushToBuffer(e,t,n){this.buffer.push([e,t,n])}drainBuffer(){this.dataObserver&&(this.buffer.forEach((e=>this.dataObserver.next(e))),this.buffer=[])}catchRTFError(e,t,n){const r={"UnknownArgument: Unknown field argument filter":hc.UnknownField,"Filters exceed maximum attributes limit":hc.MaxAttributes,"Filters combination exceed maximum limit":hc.MaxCombinations,"filter uses same fieldName multiple time":hc.RepeatedFieldname,"The variables input contains a field name 'not'":hc.NotGroup,"The variables input contains a field that is not defined for input object type":hc.FieldNotInType},[i,o]=Object.entries(r).find((([t])=>e.includes(t)))||[];if(void 0!==o){const r=function(e,t,n){const r=function(e){const t=new Set;if(!e||!Array.isArray(e.predicates))return t;const{predicates:n}=e,r=[...n];for(;r.length>0;){const e=r.pop();Ba(e)?t.add(e.field):qa(e)&&r.push(...e.predicates)}return t}(n),i=[...r].join(", "),o=function(e){const t=cc(e),n=new Set;for(const e of t)e.groupsField&&!e.groups.length?n.add(e.groupsField):e.ownerField&&n.add(e.ownerField);return n}(t),s=[...o].join(", "),a=function(e){if(!e||!Array.isArray(e.predicates))return 0;let t=0;const n=[e];for(;n.length>0;){const e=n.pop();if(qa(e)){const{predicates:r,type:i}=e;"or"===i&&r.length>1&&(t+=r.length),n.push(...r)}}return t||1}(n),c=function(e){if(!e||!Array.isArray(e.predicates))return null;const t=[dc(e)],n=e=>{const t={};for(const n of e){const[e]=Object.keys(n);if(t[e])return e;t[e]=!0}return null};for(;t.length>0;){const e=t.pop(),[r]=Object.keys(e),i=e[r];if(!Array.isArray(i))return null;const o=i.filter((e=>!Array.isArray(Object.values(e)[0]))),s=i.filter((e=>Array.isArray(Object.values(e)[0])));if("and"===r){const e=n(o);if(e)return e}t.push(...s)}return null}(n);switch(e){case hc.UnknownField:return"Your API was generated with an older version of the CLI that doesn't support backend subscription filtering.To enable backend subscription filtering, upgrade your Amplify CLI to the latest version and push your app by running `amplify upgrade` followed by `amplify push`";case hc.MaxAttributes:{let e=`Your selective sync expression for ${t.name} contains ${r.size} different model fields: ${i}.\n\n`;return o.size>0&&(e+=`Note: the number of fields you can use with selective sync is affected by @auth rules configured on the model.\n\nDynamic auth modes, such as owner auth and dynamic group auth each utilize 1 field.\nYou currently have ${o.size} dynamic auth mode(s) configured on this model: ${s}.`),e}case hc.MaxCombinations:{let e=`Your selective sync expression for ${t.name} contains ${a} field combinations (total number of predicates in an OR expression).\n\n`;return o.size>0&&(e+=`Note: the number of fields you can use with selective sync is affected by @auth rules configured on the model.\n\nDynamic auth modes, such as owner auth and dynamic group auth factor in to the number of combinations you're using.\nYou currently have ${o.size} dynamic auth mode(s) configured on this model: ${s}.`),e}case hc.RepeatedFieldname:return`Your selective sync expression for ${t.name} contains multiple entries for ${c} in the same AND group.`;case hc.NotGroup:return`Your selective sync expression for ${t.name} uses a \`not\` group. If you'd like to filter subscriptions in the backend, rewrite your expression using \`ne\` or \`notContains\` operators.`;case hc.FieldNotInType:return""}}(o,t,n);return mu.warn(`Backend subscriptions filtering error.\nSubscriptions filtering will be applied clientside.\n\n${e}\n${r}`),!0}return!1}}const wu={items:[],nextToken:null,startedAt:null},Su=new kn("DataStore");class Au{constructor(e,t,n={},r,i,o){this.schema=e,this.syncPredicates=t,this.amplifyConfig=n,this.authModeStrategy=r,this.errorHandler=i,this.amplifyContext=o,this.typeQuery=new WeakMap,this.runningProcesses=new ms,o.InternalAPI=o.InternalAPI||fo,this.generateQueries()}generateQueries(){Object.values(this.schema.namespaces).forEach((e=>{Object.values(e.models).filter((({syncable:e})=>e)).forEach((t=>{const[[,...n]]=uc(e,t,"LIST");this.typeQuery.set(t,n)}))}))}graphqlFilterFromPredicate(e){if(!this.syncPredicates)return null;const t=Xa.getPredicates(this.syncPredicates.get(e),!1);return t?dc(t):null}async retrievePage(e,t,n,r=null,i,o){const[s,a]=this.typeQuery.get(e),c={limit:r,nextToken:n,lastSync:t,filter:i},u=(await pc({authModeStrategy:this.authModeStrategy,defaultAuthMode:this.amplifyConfig.aws_appsync_authenticationType,modelName:e.name,schema:this.schema})).READ;let l=0;const d=async()=>{if(!this.runningProcesses.isOpen)throw new Error("sync.retreievePage termination was requested. Exiting.");try{Su.debug(`Attempting sync with authMode: ${u[l]}`);const t=await this.jitteredRetry({query:a,variables:c,opName:s,modelDefinition:e,authMode:u[l],onTerminate:o});return Su.debug(`Sync successful with authMode: ${u[l]}`),t}catch(e){if(l++,l>=u.length){const t=u[l-1];if(Su.debug(`Sync failed with authMode: ${t}`,e),mc(e)||fc(e))return Su.warn(`User is unauthorized to query ${s} with auth mode ${t}. No data could be returned.`),{data:{[s]:wu}};throw e}return Su.debug(`Sync failed with authMode: ${u[l-1]}. Retrying with authMode: ${u[l]}`),await d()}},{data:h}=await d(),{[s]:p}=h,{items:f,nextToken:y,startedAt:m}=p;return{nextToken:y,startedAt:m,items:f}}async jitteredRetry({query:e,variables:t,opName:n,modelDefinition:r,authMode:i,onTerminate:o}){return await oi((async(e,t)=>{try{const n=await gc(i,this.amplifyConfig),r={category:Bt.DataStore,action:Vt.GraphQl};return await this.amplifyContext.InternalAPI.graphql({query:e,variables:t,authMode:i,authToken:n},void 0,r)}catch(e){const t=mc(e)||fc(e);if(t)throw Su.error("Sync processor retry error:",e),new si(t);const i=Boolean(e?.data?.[n]?.items),o=e?.errors&&e.errors.some((e=>"Unauthorized"===e.errorType)),s=e?.errors&&e.errors.filter((e=>"Unauthorized"!==e.errorType)),a=e;if(i&&(a.data[n].items=a.data[n].items.filter((e=>null!==e))),i&&s?.length&&(await Promise.all(s.map((async e=>{try{await this.errorHandler({recoverySuggestion:"Ensure app code is up to date, auth directives exist and are correct on each model, and that server-side data has not been invalidated by a schema change. If the problem persists, search for or create an issue: https://github.com/aws-amplify/amplify-js/issues",localModel:null,message:e.message,model:r.name,operation:n,errorType:uu(e),process:La.sync,remoteModel:null,cause:e})}catch(e){Su.error("Sync error handler failed with:",e)}}))),Mr.dispatch("datastore",{event:"nonApplicableDataReceived",data:{errors:s,modelName:r.name}})),o)throw this.errorHandler({recoverySuggestion:"Ensure app code is up to date, auth directives exist and are correct on each model, and that server-side data has not been invalidated by a schema change. If the problem persists, search for or create an issue: https://github.com/aws-amplify/amplify-js/issues",localModel:null,message:e.message,model:r.name,operation:n,errorType:uu(e.errors[0]),process:La.sync,remoteModel:null,cause:e}),new si(e);if(a.data?.[n]?.items?.length)return a;throw e}}),[e,t],void 0,o)}start(e){const{maxRecordsToSync:t,syncPageSize:n}=this.amplifyConfig,r=new Map,i=new It((i=>{const o=Object.values(this.schema.namespaces).reduce(((t,n)=>{for(const r of Array.from(n.modelTopologicalOrdering.keys())){const i=e.get(n.models[r]);t.set(n.models[r],i)}return t}),new Map),s=Array.from(o.entries()).filter((([{syncable:e}])=>e)).map((([e,[o,s]])=>this.runningProcesses.isOpen&&this.runningProcesses.add((async a=>{let c=!1,u=null,l=null,d=null,h=0;const p=this.graphqlFilterFromPredicate(e),f=this.schema.namespaces[o].modelTopologicalOrdering.get(e.name).map((e=>r.get(`${o}_${e}`))),y=new Promise((async r=>{await Promise.all(f);do{if(!this.runningProcesses.isOpen)return Su.debug(`Sync processor has been stopped, terminating sync for ${e.name}`),r();const f=Math.min(t-h,n);try{({items:d,nextToken:u,startedAt:l}=await this.retrievePage(e,s,u,f,p,a))}catch(t){try{await this.errorHandler({recoverySuggestion:"Ensure app code is up to date, auth directives exist and are correct on each model, and that server-side data has not been invalidated by a schema change. If the problem persists, search for or create an issue: https://github.com/aws-amplify/amplify-js/issues",localModel:null,message:t.message,model:e.name,operation:null,errorType:uu(t),process:La.sync,remoteModel:null,cause:t})}catch(e){Su.error("Sync error handler failed with:",e)}c=!0,d=[]}h+=d.length,c=null===u||h>=t,i.next({namespace:o,modelDefinition:e,items:d,done:c,startedAt:l,isFullSync:!s})}while(!c);r()}));r.set(`${o}_${e.name}`,y),await y}),`adding model ${e.name}`)));Promise.all(s).then((()=>{i.complete()}))}));return i}async stop(){Su.debug("stopping sync processor"),await this.runningProcesses.close(),await this.runningProcesses.open(),Su.debug("sync processor stopped")}}const Eu=new kn("DataStore"),Iu=Symbol("sync");var Tu;!function(e){e.SYNC_ENGINE_STORAGE_SUBSCRIBED="storageSubscribed",e.SYNC_ENGINE_SUBSCRIPTIONS_ESTABLISHED="subscriptionsEstablished",e.SYNC_ENGINE_SYNC_QUERIES_STARTED="syncQueriesStarted",e.SYNC_ENGINE_SYNC_QUERIES_READY="syncQueriesReady",e.SYNC_ENGINE_MODEL_SYNCED="modelSynced",e.SYNC_ENGINE_OUTBOX_MUTATION_ENQUEUED="outboxMutationEnqueued",e.SYNC_ENGINE_OUTBOX_MUTATION_PROCESSED="outboxMutationProcessed",e.SYNC_ENGINE_OUTBOX_STATUS="outboxStatus",e.SYNC_ENGINE_NETWORK_STATUS="networkStatus",e.SYNC_ENGINE_READY="ready"}(Tu||(Tu={}));class Cu{getModelSyncedStatus(e){return this.modelSyncedStatus.get(e)}constructor(e,t,n,r,i,o,s,a,c,u={},l,d,h){this.schema=e,this.namespaceResolver=t,this.modelClasses=n,this.userModelClasses=r,this.storage=i,this.modelInstanceCreator=o,this.syncPredicates=c,this.amplifyConfig=u,this.authModeStrategy=l,this.amplifyContext=d,this.connectivityMonitor=h,this.online=!1,this.modelSyncedStatus=new WeakMap,this.connectionDisrupted=!1,this.runningProcesses=new ms,this.waitForSleepState=new Promise((e=>{this.syncQueriesObservableStartSleeping=e}));const p=this.modelClasses.MutationEvent;this.outbox=new tu(this.schema,p,o,Iu),this.modelMerger=new eu(this.outbox,Iu),this.syncQueriesProcessor=new Au(this.schema,this.syncPredicates,this.amplifyConfig,this.authModeStrategy,a,this.amplifyContext),this.subscriptionsProcessor=new bu(this.schema,this.syncPredicates,this.amplifyConfig,this.authModeStrategy,a,this.amplifyContext),this.mutationsProcessor=new hu(this.schema,this.storage,this.userModelClasses,this.outbox,this.modelInstanceCreator,p,this.amplifyConfig,this.authModeStrategy,a,s,this.amplifyContext),this.datastoreConnectivity=this.connectivityMonitor||new Zc}start(e){return new It((t=>{Eu.log("starting sync engine...");let n=[];this.runningProcesses.add((async()=>{try{await this.setupModels(e)}catch(e){return void t.error(e)}const r=new Promise(((e,r)=>{this.datastoreConnectivity.status().subscribe((async({online:i})=>this.runningProcesses.isOpen&&this.runningProcesses.add((async o=>{if(i&&!this.online){let e,s;this.online=i,t.next({type:Tu.SYNC_ENGINE_NETWORK_STATUS,data:{active:this.online}}),this.stopDisruptionListener=this.startDisruptionListener(),[e,s]=this.subscriptionsProcessor.start();try{await new Promise(((t,r)=>{o.then(r);const i=e.subscribe({next:e=>{e===gu.CONNECTED&&t()},error:e=>{r(e),this.disconnectionHandler()(e)}});n.push(i)}))}catch(e){return t.error(e),void r()}Eu.log("Realtime ready"),t.next({type:Tu.SYNC_ENGINE_SUBSCRIPTIONS_ESTABLISHED});try{await new Promise(((e,r)=>{const i=this.syncQueriesObservable().subscribe({next:n=>{const{type:r}=n;r===Tu.SYNC_ENGINE_SYNC_QUERIES_READY&&e(),t.next(n)},complete:()=>{e()},error:e=>{r(e)}});i&&n.push(i)}))}catch(e){return t.error(e),void r()}n.push(this.mutationsProcessor.start().subscribe((({modelDefinition:e,model:n,hasMore:r})=>this.runningProcesses.add((async()=>{const i=this.userModelClasses[e.name],o=this.modelInstanceCreator(i,n);await this.storage.runExclusive((t=>this.modelMerger.merge(t,o,e))),t.next({type:Tu.SYNC_ENGINE_OUTBOX_MUTATION_PROCESSED,data:{model:i,element:o}}),t.next({type:Tu.SYNC_ENGINE_OUTBOX_STATUS,data:{isEmpty:!r}})}),"mutation processor event")))),n.push(s.subscribe((([e,t,n])=>this.runningProcesses.add((async()=>{const e=this.userModelClasses[t.name],r=this.modelInstanceCreator(e,n);await this.storage.runExclusive((e=>this.modelMerger.merge(e,r,t)))}),"subscription dataSubsObservable event"))))}else i||(this.online=i,t.next({type:Tu.SYNC_ENGINE_NETWORK_STATUS,data:{active:this.online}}),n.forEach((e=>e.unsubscribe())),n=[]);e()}),"datastore connectivity event")))}));this.storage.observe(null,null,Iu).pipe(gi((({model:e})=>!0===this.getModelDefinition(e).syncable))).subscribe({next:async({opType:e,model:n,element:i,condition:o})=>this.runningProcesses.add((async()=>{const s=this.schema.namespaces[this.namespaceResolver(n)],a=this.modelClasses.MutationEvent,c=this.getModelDefinition(n),u=function(e,t){return e&&Array.isArray(e.predicates)?dc(e,pa(t)):{}}(o,c),l=lc(s.relationships,this.getModelDefinition(n),e,n,i,u,a,this.modelInstanceCreator);await this.outbox.enqueue(this.storage,l),t.next({type:Tu.SYNC_ENGINE_OUTBOX_MUTATION_ENQUEUED,data:{model:n,element:i}}),t.next({type:Tu.SYNC_ENGINE_OUTBOX_STATUS,data:{isEmpty:!1}}),await r,this.online&&this.mutationsProcessor.resume()}),"storage event")}),t.next({type:Tu.SYNC_ENGINE_STORAGE_SUBSCRIBED});const i=void 0===await this.outbox.peek(this.storage);t.next({type:Tu.SYNC_ENGINE_OUTBOX_STATUS,data:{isEmpty:i}}),await r,t.next({type:Tu.SYNC_ENGINE_READY})}),"sync start")}))}async getModelsMetadataWithNextFullSync(e){return new Map((await this.runningProcesses.add((()=>this.getModelsMetadata()),"sync/index getModelsMetadataWithNextFullSync")).map((({namespace:t,model:n,lastSync:r,lastFullSync:i,fullSyncInterval:o,lastSyncPredicate:s})=>{const a=!i||i+o<e?0:r;return[this.schema.namespaces[t].models[n],[t,a]]})))}syncQueriesObservable(){return this.online?new It((e=>{let t;this.runningProcesses.isOpen&&this.runningProcesses.add((async n=>{let r=!1;for(;!e.closed&&!r;){const i=new WeakMap,o=await this.getModelsMetadataWithNextFullSync(Date.now()),s=new Set(o.keys());let a,c,u,l,d,h;await new Promise(((r,h)=>{this.runningProcesses.isOpen||r(),n.then((()=>r())),t=this.syncQueriesProcessor.start(o).subscribe({next:async({namespace:n,modelDefinition:o,items:h,done:p,startedAt:f,isFullSync:y})=>{const m=this.userModelClasses[o.name];if(i.has(m)||(i.set(m,{new:0,updated:0,deleted:0}),u=Ys(),d=void 0===d?f:Math.max(d,f)),await this.storage.runExclusive((async e=>{const t=await this.outbox.getModelIds(e),n=[],r=h.filter((e=>{const r=vc(o,e);return!t.has(r)||(n.push(e),!1)})),s=[];for(const t of n){const n=await this.modelMerger.merge(e,t,o);void 0!==n&&s.push([t,n])}s.push(...await this.modelMerger.mergePage(e,m,r,o));const a=i.get(m);s.forEach((([,e])=>{switch(e){case xa.INSERT:a.new++;break;case xa.UPDATE:a.updated++;break;case xa.DELETE:a.deleted++;break;default:throw new Error(`Invalid opType ${e}`)}}))})),p){const{name:d}=o;let h=await this.getModelMetadata(n,d);const{lastFullSync:p,fullSyncInterval:g}=h;c=g,a=void 0===a?p:Math.max(a,y?f:p),h=this.modelClasses.ModelMetadata.copyOf(h,(e=>{e.lastSync=f,e.lastFullSync=y?f:h.lastFullSync})),await this.storage.save(h,void 0,Iu);const v=i.get(m);this.modelSyncedStatus.set(m,!0),e.next({type:Tu.SYNC_ENGINE_MODEL_SYNCED,data:{model:m,isFullSync:y,isDeltaSync:!y,counts:v}}),s.delete(o),0===s.size&&(l=Ys()-u,r(),e.next({type:Tu.SYNC_ENGINE_SYNC_QUERIES_READY}),t.unsubscribe())}},error:t=>{e.error(t)}}),e.next({type:Tu.SYNC_ENGINE_SYNC_QUERIES_STARTED,data:{models:Array.from(s).map((({name:e})=>e))}})})),h=a?a+c-(d+l):c-l,Eu.debug(`Next fullSync in ${h/1e3} seconds. (${new Date(Date.now()+h)})`),await this.runningProcesses.add((async e=>{let t;const n=new Promise((e=>{t=e,setTimeout(t,h)}));return e.then((()=>{r=!0,this.syncQueriesObservableStartSleeping(),t()})),this.unsleepSyncQueriesObservable=t,this.syncQueriesObservableStartSleeping(),n}),"syncQueriesObservable sleep"),this.unsleepSyncQueriesObservable=null,this.waitForSleepState=new Promise((e=>{this.syncQueriesObservableStartSleeping=e}))}}),"syncQueriesObservable main")})):function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=Jc(e);return Ai(e,n)}({})}disconnectionHandler(){return e=>{ai.CONNECTION_CLOSED!==e&&ai.TIMEOUT_DISCONNECT!==e||this.datastoreConnectivity.socketDisconnected()}}unsubscribeConnectivity(){this.datastoreConnectivity.unsubscribe()}async stop(){Eu.debug("stopping sync engine"),this.unsubscribeConnectivity(),this.stopDisruptionListener&&this.stopDisruptionListener(),await this.mutationsProcessor.stop(),await this.subscriptionsProcessor.stop(),await this.datastoreConnectivity.stop(),await this.syncQueriesProcessor.stop(),await this.runningProcesses.close(),await this.runningProcesses.open(),Eu.debug("sync engine stopped and ready to restart")}async setupModels(e){const{fullSyncInterval:t}=e,n=this.modelClasses.ModelMetadata,r=[];let i;Object.values(this.schema.namespaces).forEach((e=>{Object.values(e.models).filter((({syncable:e})=>e)).forEach((t=>{if(r.push([e.name,t]),e.name===Ms){const e=this.userModelClasses[t.name];this.modelSyncedStatus.set(e,!1)}}))}));const o=r.map((async([e,r])=>{const o=await this.getModelMetadata(e,r.name),s=Xa.getPredicates(this.syncPredicates.get(r),!1),a=s?JSON.stringify(s):null;if(void 0===o)[[i]]=await this.storage.save(this.modelInstanceCreator(n,{model:r.name,namespace:e,lastSync:null,fullSyncInterval:t,lastFullSync:null,lastSyncPredicate:a}),void 0,Iu);else{const e=(o.lastSyncPredicate?o.lastSyncPredicate:null)!==a;[[i]]=await this.storage.save(n.copyOf(o,(n=>{n.fullSyncInterval=t,e&&(n.lastSync=null,n.lastFullSync=null,n.lastSyncPredicate=a)})))}return i})),s={};for(const e of await Promise.all(o)){const{model:t}=e;s[t]=e}return s}async getModelsMetadata(){const e=this.modelClasses.ModelMetadata;return await this.storage.query(e)}async getModelMetadata(e,t){const n=this.modelClasses.ModelMetadata,r=Xa.createFromAST(this.schema.namespaces[Ls].models[n.name],{and:[{namespace:{eq:e}},{model:{eq:t}}]}),[i]=await this.storage.query(n,r,{page:0,limit:1});return i}getModelDefinition(e){const t=this.namespaceResolver(e);return this.schema.namespaces[t].models[e.name]}static getNamespace(){return{name:Ls,relationships:{},enums:{OperationType:{name:"OperationType",values:["CREATE","UPDATE","DELETE"]}},nonModels:{},models:{MutationEvent:{name:"MutationEvent",pluralName:"MutationEvents",syncable:!1,fields:{id:{name:"id",type:"ID",isRequired:!0,isArray:!1},model:{name:"model",type:"String",isRequired:!0,isArray:!1},data:{name:"data",type:"String",isRequired:!0,isArray:!1},modelId:{name:"modelId",type:"String",isRequired:!0,isArray:!1},operation:{name:"operation",type:{enum:"Operationtype"},isArray:!1,isRequired:!0},condition:{name:"condition",type:"String",isArray:!1,isRequired:!0}}},ModelMetadata:{name:"ModelMetadata",pluralName:"ModelsMetadata",syncable:!1,fields:{id:{name:"id",type:"ID",isRequired:!0,isArray:!1},namespace:{name:"namespace",type:"String",isRequired:!0,isArray:!1},model:{name:"model",type:"String",isRequired:!0,isArray:!1},lastSync:{name:"lastSync",type:"Int",isRequired:!1,isArray:!1},lastFullSync:{name:"lastFullSync",type:"Int",isRequired:!1,isArray:!1},fullSyncInterval:{name:"fullSyncInterval",type:"Int",isRequired:!0,isArray:!1},lastSyncPredicate:{name:"lastSyncPredicate",type:"String",isRequired:!1,isArray:!1}}}}}}startDisruptionListener(){return Mr.listen("api",(e=>{if("PubSub"===e.source&&e.payload.event===li)switch(e.payload.data.connectionState){case ci.ConnectionDisrupted:this.connectionDisrupted=!0;break;case ci.Connected:this.connectionDisrupted&&this.scheduleSync(),this.connectionDisrupted=!1}}))}scheduleSync(){return this.runningProcesses.isOpen&&this.runningProcesses.add((()=>this.waitForSleepState.then((()=>{this.unsleepSyncQueriesObservable()}))))}}const Nu=[...Ya],Ou=new Map,_u=(e,t)=>{const n=t||new Va;return Ou.set(n,e),n},ku=e=>{if(!Ou.has(e))throw new Error("Invalid predicate. Terminate your predicate with a valid condition (e.g., `p => p.field.eq('value')`) or pass `Predicates.ALL`.");return Ou.get(e)},xu={and:"or",or:"and",not:"and",eq:"ne",ne:"eq",gt:"le",ge:"lt",lt:"ge",le:"gt",contains:"notContains",notContains:"contains"};class Pu{constructor(e,t,n){this.field=e,this.operator=t,this.operands=n,this.validate()}copy(e){return[new Pu(this.field,this.operator,[...this.operands]),void 0]}toAST(){return{[this.field]:{[this.operator]:"between"===this.operator?[this.operands[0],this.operands[1]]:this.operands[0]}}}negated(e){return"between"===this.operator?new Ru(e,void 0,void 0,"or",[new Pu(this.field,"lt",[this.operands[0]]),new Pu(this.field,"gt",[this.operands[1]])]):"beginsWith"===this.operator?new Ru(e,void 0,void 0,"not",[new Pu(this.field,"beginsWith",[this.operands[0]])]):new Pu(this.field,xu[this.operator],this.operands)}async fetch(e){return Promise.reject("No implementation needed [yet].")}async matches(e){const t=e[this.field],n={eq:()=>t===this.operands[0],ne:()=>t!==this.operands[0],gt:()=>t>this.operands[0],ge:()=>t>=this.operands[0],lt:()=>t<this.operands[0],le:()=>t<=this.operands[0],contains:()=>t?.indexOf(this.operands[0])>-1,notContains:()=>!t||-1===t.indexOf(this.operands[0]),beginsWith:()=>t?.startsWith(this.operands[0]),between:()=>t>=this.operands[0]&&t<=this.operands[1]}[this.operator];if(n)return n();throw new Error(`Invalid operator given: ${this.operator}`)}validate(){const e=e=>{const t=1===e?"argument is":"arguments are";return()=>{if(this.operands.length!==e)return`Exactly ${e} ${t} required.`}},t={eq:e(1),ne:e(1),gt:e(1),ge:e(1),lt:e(1),le:e(1),contains:e(1),notContains:e(1),beginsWith:e(1),between:()=>e(2)()||(this.operands[0]>this.operands[1]?"The first argument must be less than or equal to the second argument.":null)}[this.operator];if(!t)throw new Error(`Non-existent operator: \`${this.operator}()\``);{const e=t();if("string"==typeof e)throw new Error(`Incorrect usage of \`${this.operator}()\`: ${e}`)}}}const Du=(()=>{let e=1;return()=>"group_"+e++})();class Ru{constructor(e,t,n,r,i,o=!1){this.model=e,this.field=t,this.relationshipType=n,this.operator=r,this.operands=i,this.isOptimized=o,this.groupId=Du()}copy(e){const t=new Ru(this.model,this.field,this.relationshipType,this.operator,[]);let n=e===this?t:void 0;return this.operands.forEach((r=>{const[i,o]=r.copy(e);t.operands.push(i),n=n||o})),[t,n]}withFieldConditionsOnly(e){const t=e!==("not"===this.operator);return new Ru(this.model,void 0,void 0,e?xu[this.operator]:this.operator,this.operands.filter((e=>e instanceof Pu)).map((e=>t?e.negated(this.model):e)))}optimized(e=!0){const t=this.operands.map((e=>e instanceof Ru?e.optimized("not"===this.operator):e));if(!e&&["and","or"].includes(this.operator)&&!this.field&&1===t.length){const e=t[0];if(!(e instanceof Pu))return e;if("between"!==e.operator)return e}return new Ru(this.model,this.field,this.relationshipType,this.operator,t,!0)}async fetch(e,t=[],n=!1){if(!this.isOptimized)return this.optimized().fetch(e);const r=[],i=n?xu[this.operator]:this.operator,o=n!==("not"===this.operator),s=this.operands.filter((e=>e instanceof Ru)),a=this.operands.filter((e=>e instanceof Pu));for(const n of s){const s=await n.fetch(e,[...t,this.groupId],o);if(0!==s.length)if(n.field){const t=Mc.from(this.model,n.field);if(!t)throw new Error("Missing field metadata.");{const n=[];for(const e of s){const r=[];for(let n=0;n<t.localJoinFields.length;n++)r.push({[t.localJoinFields[n]]:{eq:e[t.remoteJoinFields[n]]}});n.push({and:r})}const i=Xa.createFromAST(this.model.schema,{or:n});r.push(await e.query(this.model.builder,i))}}else r.push(s);else{if("and"===i)return[];r.push([])}}if(a.length>0){const t=this.withFieldConditionsOnly(o).toStoragePredicate();r.push(await e.query(this.model.builder,t))}else 0===a.length&&0===r.length&&r.push(await e.query(this.model.builder));const c=e=>JSON.stringify(this.model.pkField.map((t=>e[t])));let u;if("and"===i){if(0===r.length)return[];for(const e of r)if(void 0===u)u=new Map(e.map((e=>[c(e),e])));else{const t=new Map(e.map((e=>[c(e),e])));for(const e of u.keys())t.has(e)||u.delete(e)}}else if("or"===i||"not"===i){u=new Map;for(const e of r)for(const t of e)u.set(c(t),t)}return Array.from(u?.values()||[])}async matches(e,t=!1){const n=this.field&&!t?await e[this.field]:e;if(!n)return!1;if("HAS_MANY"===this.relationshipType&&"function"==typeof n[Symbol.asyncIterator]){for await(const e of n)if(await this.matches(e,!0))return!0;return!1}if("or"===this.operator)return async function(e,t){for(const n of e)if(await t(n))return!0;return!1}(this.operands,(e=>e.matches(n)));if("and"===this.operator)return async function(e,t){for(const n of e)if(!await t(n))return!1;return!0}(this.operands,(e=>e.matches(n)));if("not"===this.operator){if(1!==this.operands.length)throw new Error("Invalid arguments! `not()` accepts exactly one predicate expression.");return!await this.operands[0].matches(n)}throw new Error("Invalid group operator!")}toAST(){if(this.field)throw new Error("Nested type conditions are not supported!");return{[this.operator]:this.operands.map((e=>e.toAST()))}}toStoragePredicate(){return Xa.createFromAST(this.model.schema,this.toAST())}toJSON(){return{...this,model:this.model.schema.name}}}function Mu(e,t=!0,n,r,i){const o=new Ru(e,n,void 0,"and",[]),s=r&&i?r:o,a=r&&i?i:o,c={};_u(s,c);const u=()=>{const[n,r]=s.copy(a);return{query:n,newTail:r,newLink:Mu(e,t,void 0,n,r)}};["and","or"].forEach((r=>{c[r]=i=>{const{query:o,newTail:s}=u(),a=i(Mu(e,t));if(!Array.isArray(a))throw new Error(`Invalid predicate. \`${r}\` groups must return an array of child conditions.`);return s?.operands.push(new Ru(e,n,void 0,r,a.map((e=>ku(e))))),_u(o)}})),c.not=r=>{const{query:i,newTail:o}=u();return o?.operands.push(new Ru(e,n,void 0,"not",[ku(r(Mu(e,t)))])),_u(i)};for(const n in e.schema.allFields)Object.defineProperty(c,n,{enumerable:!0,get:()=>{const r=e.schema.allFields[n];if(r.association){if(t){if("BELONGS_TO"===r.association.connectionType||"HAS_ONE"===r.association.connectionType||"HAS_MANY"===r.association.connectionType){const e=r.type.modelConstructor;if(!e)throw new Error("Related model metadata is missing. This is a bug! Please report it.");const[i,o]=s.copy(a),c=new Ru(e,n,r.association.connectionType,"and",[]);return o.operands.push(c),Mu(e,t,void 0,i,c)}throw new Error("Related model definition doesn't have a typedef. This is a bug! Please report it.")}throw new Error("Predication on releated models is not supported in this context.")}return Nu.reduce(((e,t)=>({...e,[t]:(...e)=>{const{query:r,newTail:i}=u(),o=e.map((e=>void 0===e?null:e));return i?.operands.push(new Pu(n,t,o)),_u(r)}})),{})}});return c}function Lu(e){return Mu(e,!1)}ps(!0),function(){function e(t){if(!go(t))return t;if(Array.isArray(t))return t.map(e);if(Eo(t))return new Map(Array.from(t.entries()).map((function(t){return[t[0],e(t[1])]})));if(Io(t))return new Set(Array.from(t).map(e));var n=Object.create(Object.getPrototypeOf(t));for(var r in t)n[r]=e(t[r]);return wo(t,ts)&&(n[ts]=t[ts]),n}function t(t){return mo(t)?e(t):t}var n="add";!function(e,t){ss[e]||(ss[e]=t)}("Patches",{$:function(t,r){return r.forEach((function(r){for(var i=r.path,o=r.op,s=t,a=0;a<i.length-1;a++){var c=bo(s),u=""+i[a];0!==c&&1!==c||"__proto__"!==u&&"constructor"!==u||yo(24),"function"==typeof s&&"prototype"===u&&yo(24),"object"!=typeof(s=So(s,u))&&yo(15,i.join("/"))}var l=bo(s),d=e(r.value),h=i[i.length-1];switch(o){case"replace":switch(l){case 2:return s.set(h,d);case 3:yo(16);default:return s[h]=d}case n:switch(l){case 1:return s.splice(h,0,d);case 2:return s.set(h,d);case 3:return s.add(d);default:return s[h]=d}case"remove":switch(l){case 1:return s.splice(h,1);case 2:return s.delete(h);case 3:return s.delete(r.value);default:return delete s[h]}default:yo(17,o)}})),t},R:function(e,r,i,o){switch(e.i){case 0:case 4:case 2:return function(e,r,i,o){var s=e.t,a=e.o;vo(e.D,(function(e,c){var u=So(s,e),l=So(a,e),d=c?wo(s,e)?"replace":n:"remove";if(u!==l||"replace"!==d){var h=r.concat(e);i.push("remove"===d?{op:d,path:h}:{op:d,path:h,value:l}),o.push(d===n?{op:"remove",path:h}:"remove"===d?{op:n,path:h,value:t(u)}:{op:"replace",path:h,value:t(u)})}}))}(e,r,i,o);case 5:case 1:return function(e,r,i,o){var s=e.t,a=e.D,c=e.o;if(c.length<s.length){var u=[c,s];s=u[0],c=u[1];var l=[o,i];i=l[0],o=l[1]}for(var d=0;d<s.length;d++)if(a[d]&&c[d]!==s[d]){var h=r.concat([d]);i.push({op:"replace",path:h,value:t(c[d])}),o.push({op:"replace",path:h,value:t(s[d])})}for(var p=s.length;p<c.length;p++){var f=r.concat([p]);i.push({op:n,path:f,value:t(c[p])})}s.length<c.length&&o.push({op:"replace",path:r.concat(["length"]),value:s.length})}(e,r,i,o);case 3:return function(e,t,r,i){var o=e.t,s=e.o,a=0;o.forEach((function(e){if(!s.has(e)){var o=t.concat([a]);r.push({op:"remove",path:o,value:e}),i.unshift({op:n,path:o,value:e})}a++})),a=0,s.forEach((function(e){if(!o.has(e)){var s=t.concat([a]);r.push({op:n,path:s,value:e}),i.unshift({op:"remove",path:s,value:e})}a++}))}(e,r,i,o)}},M:function(e,t,n,r){n.push({op:"replace",path:[],value:t===es?void 0:t}),r.push({op:"replace",path:[],value:e.t})}})}();const Fu=new kn("DataStore"),$u=Hs(Date.now()),ju="schemaVersion";let Uu;const Bu=new WeakMap,qu=new WeakMap,Ku=e=>{const t=Bu.get(e);return t?Uu.namespaces[t].models[e.name]:void 0},Gu=e=>Bs(e)&&Bu.has(e),Vu=e=>{const t=Bu.get(e);if(!t)throw new Error(`Namespace Resolver for '${e.name}' not found! This is probably a bug in '@amplify-js/datastore'.`);return t},Wu=e=>{if(!e)throw new Error("Missing modelConstructor");const t=Ku(e);if(!t)throw new Error("Missing modelSchema");const n=pa(t);if(!n)throw new Error("Could not determine PK");return Mu({builder:e,schema:t,pkField:n})};let zu,Qu,Hu,Yu;const Ju=new WeakMap;var Xu;!function(e){e.Detached="Detached",e.DataStore="DataStore",e.API="API"}(Xu||(Xu={}));const Zu=new WeakMap;function el(e,t){return Array.isArray(e)?e.map((e=>el(e,t))):e&&Zu.set(e,t),e}const tl=e=>Zu.has(e)?Zu.get(e):Xu.Detached,nl=()=>{if(void 0===Uu){const e="Schema is not initialized. DataStore will not function as expected. This could happen if you have multiple versions of DataStore installed. Please see https://docs.amplify.aws/lib/troubleshooting/upgrading/q/platform/js/#check-for-duplicate-versions";throw Fu.error(e),new Error(e)}},rl=e=>{const t={};return Object.entries(e.models).forEach((([n,r])=>{const i=dl(r);t[n]=i,Bu.set(i,e.name)})),Object.entries(e.nonModels||{}).forEach((([e,n])=>{const r=yl(n);t[e]=r})),t},il=new WeakSet;function ol(e,t){return il.add(t),new e(t)}const sl=e=>(t,n)=>{const r=e.fields[t];if(void 0!==r){const{type:i,isRequired:o,isArrayNullable:s,name:a,isArray:c}=r,u=!!(Aa(e)?(e=>{const t=e.attributes?.find((e=>"model"===e.type)),n=t?.properties?.timestamps;return{createdAt:"createdAt",updatedAt:"updatedAt",...n||{}}})(e):{})[a];if((!c&&o||c&&!s)&&!u&&null==n)throw new Error(`Field ${a} is required`);if(Aa(e)&&!ya(e)&&pa(e).includes(t)&&""===n)throw Fu.error(Ps,{k:t,value:n}),new Error(Ps);if(Fa(i)){const e=ka.getJSType(i),t=ka.getValidationFunction(i);if("AWSJSON"===i){if(typeof n===e)return;if("string"==typeof n)try{return void JSON.parse(n)}catch(e){throw new Error(`Field ${a} is an invalid JSON object. ${n}`)}}if(c){let r=e;if(o||(r=`${e} | null | undefined`),!Array.isArray(n)&&!s)throw new Error(`Field ${a} should be of type [${r}], ${typeof n} received. ${n}`);if(!$s(n)&&n.some((t=>$s(t)?o:typeof t!==e))){const e=n.map((e=>null===e?"null":typeof e)).join(",");throw new Error(`All elements in the ${a} array should be of type ${r}, [${e}] received. ${n}`)}if(t&&!$s(n)){if(!n.map((e=>$s(e)?!(!$s(e)||o):t(e))).every((e=>e)))throw new Error(`All elements in the ${a} array should be of type ${i}, validation failed for one or more elements. ${n}`)}}else{if(!o&&void 0===n)return;if(typeof n!==e&&null!==n)throw new Error(`Field ${a} should be of type ${e}, ${typeof n} received. ${n}`);if(!$s(n)&&t&&!t(n))throw new Error(`Field ${a} should be of type ${i}, validation failed. ${n}`)}}else if(ja(i)&&!$s(n)){const e=Uu.namespaces.user.nonModels[i.nonModel],t=sl(e);if(c){let r=i.nonModel;if(o||(r=`${i.nonModel} | null | undefined`),!Array.isArray(n))throw new Error(`Field ${a} should be of type [${r}], ${typeof n} received. ${n}`);n.forEach((n=>{if($s(n)&&o||"object"!=typeof n&&void 0!==n)throw new Error(`All elements in the ${a} array should be of type ${i.nonModel}, [${typeof n}] received. ${n}`);$s(n)||Object.keys(e.fields).forEach((e=>{t(e,n[e])}))}))}else{if("object"!=typeof n)throw new Error(`Field ${a} should be of type ${i.nonModel}, ${typeof n} recieved. ${n}`);Object.keys(e.fields).forEach((e=>{t(e,n[e])}))}}}},al=(e,t,n)=>{const{isArray:r,type:i}=e.fields[t]||{};if("string"==typeof n&&(r||"AWSJSON"===i||ja(i)||$a(i)))try{return JSON.parse(n)}catch{}return"number"==typeof n&&"Boolean"===i?Boolean(n):n},cl=new WeakMap,ul=(e,t,n)=>{const r=sl(t);Object.entries(e).forEach((([e,i])=>{const o=al(t,e,i);r(e,o),n[e]=o}))},ll=(e,t)=>{for(const n of Object.keys(e.fields))void 0===t[n]&&(t[n]=null)},dl=e=>{const t=class{constructor(t){let n=[];const r=hs(this,(n=>{ul(t,e,n);const r=il.has(t),i=r?t:{},{id:o}=i;if(ya(e)){const t=null!=o?o:e.syncable?Zr():$u();n.id=t}else(e=>{const t=ha(e);return!(!t||!Ca(t))&&t.properties.fields[0]===ks})(e)&&(n.id=n.id||Zr());r||pl(n,e);const{_version:s,_lastChangedAt:a,_deleted:c}=i;e.syncable&&(n._version=s,n._lastChangedAt=a,n._deleted=c)}),(e=>n=e)),i=hs(r,(t=>ll(e,t)));return cl.set(i,n),i}static copyOf(t,n){const r=Object.getPrototypeOf(t||{}).constructor;if(!Gu(r)){const e="The source object is not a valid model";throw Fu.error(e,{source:t}),new Error(e)}let i=[];const o=hs(t,(r=>{n(r),pa(e).forEach((e=>{r[e]!==t[e]&&Fu.warn(`copyOf() does not update PK fields. The '${e}' update is being ignored.`,{source:t}),r[e]=t[e]}));const i=sl(e);Object.entries(r).forEach((([t,n])=>{const r=al(e,t,n);i(t,r)})),ll(e,r)}),(e=>i=e)),s=qu.has(t);if(i.length||s)if(s){const[n,r]=qu.get(t),s=function(e,t,n){const r=t.concat(n);let i;return hs(e,(e=>{fs(e,r)}),(e=>{i=e})),i}(r,n,i);qu.set(o,[s,r]),fl(s,e)}else qu.set(o,[i,t]),fl(i,e);else qu.set(o,[[],t]);return el(o,Xu.DataStore)}static fromJSON(n){if(Array.isArray(n))return n.map((e=>this.fromJSON(e)));const r=ol(t,n),i=sl(e);return Object.entries(r).forEach((([e,t])=>{i(e,t)})),el(r,Xu.DataStore)}};t[ts]=!0,Object.defineProperty(t,"name",{value:e.name});const n=Mc.allFrom({builder:t,schema:e,pkField:pa(e)});for(const r of n){const n=r.field;Object.defineProperty(t.prototype,e.fields[n].name,{set(t){if("object"==typeof t||void 0===t){if(t&&t.hasOwnProperty("_version")){const i=Object.getPrototypeOf(t||{}).constructor;if(!Gu(i)){const r=`Value passed to ${e.name}.${n} is not a valid instance of a model`;throw Fu.error(r,{model:t}),new Error(r)}if(i.name.toLowerCase()!==r.remoteModelConstructor.name.toLowerCase()){const i=`Value passed to ${e.name}.${n} is not an instance of ${r.remoteModelConstructor.name}`;throw Fu.error(i,{model:t}),new Error(i)}}if(r.isComplete){for(let e=0;e<r.localJoinFields.length;e++)this[r.localJoinFields[e]]=t?.[r.remoteJoinFields[e]];(Ju.has(this)?Ju.get(this):Ju.set(this,{}).get(this))[n]=t||void 0}}},get(){const t=Ju.has(this)?Ju.get(this):Ju.set(this,{}).get(this);if(!t.hasOwnProperty(n)){if(tl(this)!==Xu.DataStore){if(tl(this)===Xu.API)throw new Error("Lazy loading from API is not yet supported!");return"HAS_MANY"===r.type?new hl([]):Promise.resolve(void 0)}{const i=Al.query(r.remoteModelConstructor,(e=>e.and((e=>r.remoteJoinFields.map(((t,n)=>e[t].eq(this[r.localJoinFields[n]])))))));"HAS_MANY"===r.type?t[n]=new hl(i):t[n]=i.then((t=>{if(t.length>1){const t=new Error(`\n\t\t\t\t\t\t\t\t\tData integrity error.\n\t\t\t\t\t\t\t\t\tToo many records found for a HAS_ONE/BELONGS_TO field '${e.name}.${n}'\n\t\t\t\t\t\t\t\t`);throw console.error(t),t}return t[0]}))}}return t[n]}})}return t};class hl{constructor(e){this.values=e}[Symbol.asyncIterator](){let e,t=0;return{next:async()=>{if(e||(e=await this.values),t<e.length){const n={value:e[t],done:!1};return t++,n}return{value:null,done:!0}}}}async toArray({max:e=Number.MAX_SAFE_INTEGER}={}){const t=[];let n=0;for await(const r of this){if(!(n<e))break;t.push(r),n++}return t}}const pl=(e,t)=>{const n=Object.keys(e),{fields:r}=t;n.forEach((e=>{if(r[e]&&r[e].isReadOnly)throw new Error(`${e} is read-only.`)}))},fl=(e,t)=>{const n=e.map((e=>[e.path[0],e.value])),{fields:r}=t;n.forEach((([e,t])=>{if(t&&r[e]&&r[e].isReadOnly)throw new Error(`${e} is read-only.`)}))},yl=e=>{const t=class{constructor(t){return hs(this,(n=>{ul(t,e,n)}))}};return t[ts]=!0,Object.defineProperty(t,"name",{value:e.name}),function(e){qs.add(e)}(t),t};function ml(e){return"string"==typeof e}function gl(e){const{localModel:t,modelConstructor:n,remoteModel:r}=e,{_version:i}=r;return ol(n,{...t,_version:i})}function vl(e){Fu.warn(e)}function bl(e,t){let n;switch(e){case Rs:n=Hu[t];break;case Ms:n=Qu[t];break;case Ls:n=zu[t];break;case Fs:n=Yu[t];break;default:throw new Error(`Invalid namespace: ${e}`)}if(Gu(n))return n;{const n=`Model name is not valid for namespace. modelName: ${t}, namespace: ${e}`;throw Fu.error(n),new Error(n)}}let wl;var Sl;!function(e){e.NotRunning="Not Running",e.Starting="Starting",e.Running="Running",e.Stopping="Stopping",e.Clearing="Clearing"}(Sl||(Sl={}));const Al=new class{constructor(){this.InternalAPI=fo,this.Cache=po,this.amplifyConfig={},this.syncPredicates=new WeakMap,this.amplifyContext={InternalAPI:this.InternalAPI},this.runningProcesses=new ms,this.state=Sl.NotRunning,this.start=async()=>this.runningProcesses.add((async()=>{if(this.state=Sl.Starting,void 0!==this.initialized)return void await this.initialized;Fu.debug("Starting DataStore"),this.initialized=new Promise(((e,t)=>{this.initResolve=e,this.initReject=t})),this.storage=new Yc(Uu,Vu,bl,ol,this.storageAdapter,this.sessionId),await this.storage.init(),nl(),await async function(e,t){const n=Hu.Setting,r=Uu.namespaces[Rs].models.Setting;await e.runExclusive((async e=>{const[i]=await e.query(n,Xa.createFromAST(r,{and:{key:{eq:ju}}}),{page:0,limit:1});void 0!==i&&void 0!==i.value?JSON.parse(i.value)!==t&&await e.clear(!1):await e.save(ol(n,{key:ju,value:JSON.stringify(t)}))}))}(this.storage,Uu.version);const{aws_appsync_graphqlEndpoint:e}=this.amplifyConfig;if(e){Fu.debug("GraphQL endpoint available",e),this.syncPredicates=await this.processSyncExpressions(),this.sync=new Cu(Uu,Vu,zu,Qu,this.storage,ol,this.conflictHandler,this.errorHandler,this.syncPredicates,this.amplifyConfig,this.authModeStrategy,this.amplifyContext,this.connectivityMonitor);const t=1e3*this.fullSyncInterval*60;wl=this.sync.start({fullSyncInterval:t}).subscribe({next:({type:e,data:t})=>{e===("undefined"!=typeof process&&null!=process.versions&&null!=process.versions.node?Tu.SYNC_ENGINE_SYNC_QUERIES_READY:Tu.SYNC_ENGINE_STORAGE_SUBSCRIBED)&&this.initResolve(),Mr.dispatch("datastore",{event:e,data:t})},error:e=>{Fu.warn("Sync error",e),this.initReject()}})}else Fu.warn("Data won't be synchronized. No GraphQL endpoint configured. Did you forget `Amplify.configure(awsconfig)`?",{config:this.amplifyConfig}),this.initResolve();await this.initialized,this.state=Sl.Running}),"datastore start").catch(this.handleAddProcError("DataStore.start()")),this.query=async(e,t,n)=>this.runningProcesses.add((async()=>{let r;if(await this.start(),!this.storage)throw new Error("No storage to query");if(!Gu(e)){const t="Constructor is not for a valid model";throw Fu.error(t,{modelConstructor:e}),new Error(t)}"string"==typeof t&&void 0!==n&&Fu.warn("Pagination is ignored when querying by id");const i=Ku(e);if(!i)throw new Error("Invalid model definition provided!");const o=this.processPagination(i,n),s=pa(i);if(ml(t)){if(s.length>1){const e="Models with composite primary keys cannot be queried by a single key value. Use object literal syntax for composite keys instead: https://docs.amplify.aws/lib/datastore/advanced-workflows/q/platform/js/#querying-records-with-custom-primary-keys";throw Fu.error(e,{keyFields:s}),new Error(e)}const n=Xa.createFromFlatEqualities(i,{[s[0]]:t});r=await this.storage.query(e,n,o)}else if(Ua(t,i)){const n=Xa.createForPk(i,t);r=await this.storage.query(e,n,o)}else if(!t||Qa(t))r=await(this.storage?.query(e,void 0,o));else{const n=Mu({builder:e,schema:i,pkField:pa(i)}),s=ku(t(n));r=await s.fetch(this.storage),r=Zs(r,o)}return el(ml(t)||Ua(t,i)?r[0]:r,Xu.DataStore)}),"datastore query").catch(this.handleAddProcError("DataStore.query()")),this.save=async(e,t)=>this.runningProcesses.add((async()=>{if(await this.start(),!this.storage)throw new Error("No storage to save to");const n=qu.get(e),r=cl.has(e)?[cl.get(e),{}]:void 0,i=n||r,o=e?e.constructor:void 0;if(!Gu(o)){const t="Object is not an instance of a valid model";throw Fu.error(t,{model:e}),new Error(t)}const s=Ku(o);if(!s)throw new Error("Model Definition could not be found for model");const a={builder:o,schema:s,pkField:pa(s)};await this.storage.runExclusive((async t=>{const n=Mc.allFrom(a).filter((e=>"BELONGS_TO"===e.type));for(const r of n){const n=r.createRemoteQueryObject(e);if(null!==n&&0===(await t.query(r.remoteModelConstructor,Xa.createFromFlatEqualities(r.remoteDefinition,n))).length)throw new Error([`Data integrity error. You tried to save a ${s.name} (${JSON.stringify(e)})`,`but the instance assigned to the "${r.field}" property`,"does not exist in the local database. If you're trying to create the related",`"${r.remoteDefinition?.name}", you must save it independently first.`].join(" "))}}));const c=t?ku(t(Lu(a))).toStoragePredicate():void 0,[u]=await this.storage.runExclusive((async t=>(await t.save(e,c,void 0,i),t.query(o,Xa.createForPk(s,e)))));return el(u,Xu.DataStore)}),"datastore save").catch(this.handleAddProcError("DataStore.save()")),this.setConflictHandler=e=>{const{DataStore:t}=e;return t&&t.conflictHandler?t.conflictHandler:(()=>this.conflictHandler===gl)()&&e.conflictHandler?e.conflictHandler:this.conflictHandler||gl},this.setErrorHandler=e=>{const{DataStore:t}=e;return t&&t.errorHandler?t.errorHandler:(()=>this.errorHandler===vl)()&&e.errorHandler?e.errorHandler:this.errorHandler||vl},this.delete=async(e,t)=>this.runningProcesses.add((async()=>{if(await this.start(),!this.storage)throw new Error("No storage to delete from");let n;if(!e){const t="Model or Model Constructor required";throw Fu.error(t,{modelOrConstructor:e}),new Error(t)}if(Gu(e)){const r=e;if(!t){const e="Id to delete or criteria required. Do you want to delete all? Pass Predicates.ALL";throw Fu.error(e,{identifierOrCriteria:t}),new Error(e)}const i=Ku(r);if(!i)throw new Error("Could not find model definition for modelConstructor.");if("string"==typeof t){const e=pa(i);if(e.length>1){const t="Models with composite primary keys cannot be deleted by a single key value, unless using a predicate. Use object literal syntax for composite keys instead: https://docs.amplify.aws/lib/datastore/advanced-workflows/q/platform/js/#querying-records-with-custom-primary-keys";throw Fu.error(t,{keyFields:e}),new Error(t)}n=Xa.createFromFlatEqualities(i,{[e[0]]:t})}else if(n=Ua(t,i)?Xa.createForPk(i,t):ku(t(Lu({builder:r,schema:i,pkField:pa(i)}))).toStoragePredicate(),!n||!Xa.isValidPredicate(n)){const e="Criteria required. Do you want to delete all? Pass Predicates.ALL";throw Fu.error(e,{condition:n}),new Error(e)}const[o]=await this.storage.delete(r,n);return el(o,Xu.DataStore)}{const r=e,i=Object.getPrototypeOf(r||{}).constructor;if(!Gu(i)){const e="Object is not an instance of a valid model";throw Fu.error(e,{model:r}),new Error(e)}const o=Ku(i);if(!o)throw new Error("Could not find model definition for modelConstructor.");const s=Xa.createForPk(o,r);if(t){if("function"!=typeof t){const e="Invalid criteria";throw Fu.error(e,{identifierOrCriteria:t}),new Error(e)}n=ku(t(Lu({builder:i,schema:o,pkField:pa(o)}))).toStoragePredicate()}else n=s;const[[a]]=await this.storage.delete(r,n);return el(a,Xu.DataStore)}}),"datastore delete").catch(this.handleAddProcError("DataStore.delete()")),this.observe=(e,t)=>{let n;const r=e&&Gu(e)?e:void 0;if(e&&void 0===r){const n=e,r=n&&Object.getPrototypeOf(n).constructor;if(Gu(r))return t&&Fu.warn("idOrCriteria is ignored when using a model instance",{model:n,identifierOrCriteria:t}),this.observe(r,n.id);{const e="The model is not an instance of a PersistentModelConstructor";throw Fu.error(e,{model:n}),new Error(e)}}if(t&&r&&Ua(t,Ku(r))){const e="Object literal syntax cannot be used with observe. Use a predicate instead: https://docs.amplify.aws/lib/datastore/data-access/q/platform/js/#predicates";throw Fu.error(e,{objectLiteral:t}),new Error(e)}if(void 0!==t&&void 0===r){const e="Cannot provide criteria without a modelConstructor";throw Fu.error(e,t),new Error(e)}if(r&&!Gu(r)){const e="Constructor is not for a valid model";throw Fu.error(e,{modelConstructor:r}),new Error(e)}return r&&"string"==typeof t?n=ku(Wu(r).id.eq(t)):r&&"function"==typeof t&&(n=ku(t(Wu(r)))),new It((e=>{let t;return this.runningProcesses.add((async()=>{await this.start(),t=this.storage.observe(r).pipe(gi((({model:e})=>Vu(e)===Ms))).subscribe({next:t=>this.runningProcesses.isOpen&&this.runningProcesses.add((async()=>{let r=t;if("DELETE"!==t.opType){const e=Ku(t.model),n=pa(e),i=((e,t)=>{const n={};return t.forEach((t=>n[t]=e[t])),n})(t.element,n),o=await this.query(t.model,i);r={...r,element:o}}n&&!await n.matches(r.element)||e.next(r)}),"datastore observe message handler"),error:t=>e.error(t),complete:()=>e.complete()})}),"datastore observe observable initialization").catch(this.handleAddProcError("DataStore.observe()")).catch((t=>{e.error(t)})),this.runningProcesses.addCleaner((async()=>{t&&t.unsubscribe()}),"DataStore.observe() cleanup")}))},this.observeQuery=(e,t,n)=>new It((r=>{const i=new Map,o=new Map;let s,a,c=[];const u=()=>{const e=p();f(e)},l=new la({callback:u,errorHandler:r.error,maxInterval:2e3}),{sort:d}=n||{},h=d?{sort:d}:void 0;if(!Ku(e))throw new Error("Could not find model definition.");e&&"function"==typeof t?a=ku(t(Wu(e))):Qa(t)&&(a=void 0),this.runningProcesses.add((async()=>{try{(await this.query(e,t,h)).forEach((t=>{const n=vc(Ku(e),t);i.set(n,t)})),s=this.observe(e).subscribe((({element:e,model:t,opType:n})=>this.runningProcesses.isOpen&&this.runningProcesses.add((async()=>{const r=vc(Ku(t),e);if(a&&!await a.matches(e)){if("UPDATE"!==n||!i.has(r)&&!o.has(r))return;c.push(r)}"DELETE"===n?c.push(r):o.set(r,e);const s=this.sync?.getModelSyncedStatus(t)??!1;(o.size-c.length>=this.syncPageSize||s)&&l.resolve(),l.start()}),"handle observeQuery observed event"))),u()}catch(e){r.error(e)}}),"datastore observequery startup").catch(this.handleAddProcError("DataStore.observeQuery()")).catch((e=>{r.error(e)}));const p=()=>{const t=this.sync?.getModelSyncedStatus(e)??!1,r=[...Array.from(i.values()),...Array.from(o.values())];i.clear(),r.forEach((t=>{const n=vc(Ku(e),t);i.set(n,t)})),c.forEach((e=>i.delete(e)));const s=Array.from(i.values());return n?.sort&&y(s),{items:s,isSynced:t}},f=e=>{r.next(e),o.clear(),c=[]},y=t=>{const r=Ku(e),i=this.processPagination(r,n),o=_s.getPredicates(i.sort);if(o.length){const e=Js(o);t.sort(e)}},m=Mr.listen("datastore",(({payload:t})=>{const{event:n,data:r}=t;n===Tu.SYNC_ENGINE_MODEL_SYNCED&&r?.model?.name===e.name&&(u(),m())}));return this.runningProcesses.addCleaner((async()=>{s&&s.unsubscribe()}),"datastore observequery cleaner")})),this.configure=(e={})=>{this.amplifyContext.InternalAPI=this.InternalAPI;const{DataStore:t,authModeStrategyType:n,conflictHandler:r,errorHandler:i,maxRecordsToSync:o,syncPageSize:s,fullSyncInterval:a,syncExpressions:c,authProviders:u,storageAdapter:l,...d}=e,h=Wr.getConfig().API?.GraphQL,p={aws_appsync_graphqlEndpoint:h?.endpoint,aws_appsync_authenticationType:h?.defaultAuthMode,aws_appsync_region:h?.region,aws_appsync_apiKey:h?.apiKey};switch(this.amplifyConfig={...this.amplifyConfig,...d,...h&&p},this.conflictHandler=this.setConflictHandler(e),this.errorHandler=this.setErrorHandler(e),t&&t.authModeStrategyType||n||Ra.DEFAULT){case Ra.MULTI_AUTH:this.authModeStrategy=(this.amplifyContext,async({schema:e,modelName:t})=>{let n;try{const e=await zr();e.tokens.accessToken&&(n=e)}catch(e){}const{attributes:r}=e.namespaces.user.models[t];if(r){const e=r.find((e=>"auth"===e.type));if(e?.properties?.rules){const t=function(e){const t=[Oa.CUSTOM,Oa.OWNER,Oa.GROUPS,Oa.PRIVATE,Oa.PUBLIC],n=[_a.FUNCTION,_a.USER_POOLS,_a.OIDC,_a.IAM,_a.API_KEY];return[...e].sort(((e,r)=>e.allow===r.allow?n.indexOf(Wa(e))-n.indexOf(Wa(r)):t.indexOf(e.allow)-t.indexOf(r.allow)))}(e.properties.rules);return function({rules:e,currentUser:t}){const n=new Set;return e.forEach((e=>{switch(e.allow){case Oa.CUSTOM:e.provider&&e.provider!==_a.FUNCTION||n.add("lambda");break;case Oa.GROUPS:case Oa.OWNER:t&&(e.provider===_a.USER_POOLS?n.add("userPool"):e.provider===_a.OIDC&&n.add("oidc"));break;case Oa.PRIVATE:t&&(e.provider&&e.provider!==_a.USER_POOLS?e.provider===_a.IAM&&n.add("iam"):n.add("userPool"));break;case Oa.PUBLIC:e.provider===_a.IAM?n.add("iam"):e.provider&&e.provider!==_a.API_KEY||n.add("apiKey")}})),Array.from(n)}({currentUser:n,rules:t})}}return[]});break;case Ra.DEFAULT:default:this.authModeStrategy=gs}this.amplifyConfig.authProviders=t&&t.authProviders||u,this.syncExpressions=t&&t.syncExpressions||c||this.syncExpressions,this.maxRecordsToSync=t&&t.maxRecordsToSync||o||this.maxRecordsToSync||1e4,this.amplifyConfig.maxRecordsToSync=this.maxRecordsToSync,this.syncPageSize=t&&t.syncPageSize||s||this.syncPageSize||1e3,this.amplifyConfig.syncPageSize=this.syncPageSize,this.fullSyncInterval=t&&t.fullSyncInterval||a||this.fullSyncInterval||1440,this.storageAdapter=t&&t.storageAdapter||l||this.storageAdapter||void 0,this.sessionId=this.retrieveSessionId()}}getModuleName(){return"DataStore"}handleAddProcError(e){return t=>{throw t.message.startsWith("BackgroundManagerNotOpenError")?new Error([`DataStoreStateError: Tried to execute \`${e}\` while DataStore was "${this.state}".`,'This can only be done while DataStore is "Started" or "Stopped". To remedy:',"Ensure all calls to `stop()` and `clear()` have completed first.","If this is not possible, retry the operation until it succeeds."].join("\n")):t}}async clear(){nl(),this.state=Sl.Clearing,await this.runningProcesses.close(),void 0===this.storage&&(this.storage=new Yc(Uu,Vu,bl,ol,this.storageAdapter,this.sessionId),await this.storage.init()),wl&&!wl.closed&&wl.unsubscribe(),this.sync&&await this.sync.stop(),await this.storage.clear(),this.initialized=void 0,this.storage=void 0,this.sync=void 0,this.syncPredicates=new WeakMap,await this.runningProcesses.open(),this.state=Sl.NotRunning}async stop(){this.state=Sl.Stopping,await this.runningProcesses.close(),wl&&!wl.closed&&wl.unsubscribe(),this.sync&&await this.sync.stop(),this.initialized=void 0,this.sync=void 0,await this.runningProcesses.open(),this.state=Sl.NotRunning}processPagination(e,t){let n;const{limit:r,page:i,sort:o}=t||{};if(void 0!==r||void 0!==i||void 0!==o){if(void 0!==i&&void 0===r)throw new Error("Limit is required when requesting a page");if(void 0!==i){if("number"!=typeof i)throw new Error("Page should be a number");if(i<0)throw new Error("Page can't be negative")}if(void 0!==r){if("number"!=typeof r)throw new Error("Limit should be a number");if(r<0)throw new Error("Limit can't be negative")}return o&&(n=_s.createFromExisting(e,o)),{limit:r,page:i,sort:n}}}async processSyncExpressions(){if(!this.syncExpressions||!this.syncExpressions.length)return new WeakMap;const e=await Promise.all(this.syncExpressions.map((async e=>{const{modelConstructor:t,conditionProducer:n}=await e,r=Ku(t),i=await this.unwrapPromise(n);return Qa(i)?[r,null]:[r,ku(i(Lu({builder:t,schema:r,pkField:pa(r)}))).toStoragePredicate()]})));return this.weakMapFromEntries(e)}async unwrapPromise(e){try{return await e()||e}catch(t){if(t instanceof TypeError)return e;throw t}}weakMapFromEntries(e){return e.reduce(((e,[t,n])=>{if(e.has(t)){const{name:n}=t;return Fu.warn(`You can only utilize one Sync Expression per model.\n          Subsequent sync expressions for the ${n} model will be ignored.`),e}return n&&e.set(t,n),e}),new WeakMap)}retrieveSessionId(){try{const e=sessionStorage.getItem("datastoreSessionId");if(e){const{aws_appsync_graphqlEndpoint:t}=this.amplifyConfig,n=t.split("/")[2],[r]=n.split(".");return`${e}-${r}`}}catch{}}};Al.configure({}),Mr.listen("core",(e=>{"configure"===e.payload.event&&Al.configure({})}));const{Challenge:El,Week:Il,Completer:Tl,User:Cl,Comments:Nl,DailyBread:Ol,Event:_l,MorningRevival:kl,ChallengeWeeks:xl,DailyBreadUser:Pl,MorningRevivalUser:Dl,EventsUser:Rl}=(e=>{if(void 0!==Uu)return console.warn("The schema has already been initialized"),Qu;Fu.log("validating schema",{schema:e}),(e=>{let t=!1;try{const n=e.split("."),[r,i,o,s]=n;t=3===Number(r)&&Number(i)>=2}catch(t){console.log(`Error parsing codegen version: ${e}\n${t}`)}if(!t){const t=`Models were generated with an unsupported version of codegen. Codegen artifacts are from ${e||"an unknown version"}, whereas ^3.2.0 is required. Update to the latest CLI and run 'amplify codegen models'.`;throw Fu.error(t),new Error(t)}})(e.codegenVersion);const t={name:Ms,...e};Fu.log("DataStore","Init models"),Qu=rl(t),Fu.log("DataStore","Models initialized");const n={name:Rs,relationships:{},enums:{},nonModels:{},models:{Setting:{name:"Setting",pluralName:"Settings",syncable:!1,fields:{id:{name:"id",type:"ID",isRequired:!0,isArray:!1},key:{name:"key",type:"String",isRequired:!0,isArray:!1},value:{name:"value",type:"String",isRequired:!0,isArray:!1}}}}},r=Yc.getNamespace(),i=Cu.getNamespace();return Hu=rl(n),Yu=rl(r),zu=rl(i),Uu={namespaces:{[n.name]:n,[t.name]:t,[r.name]:r,[i.name]:i},version:e.version,codegenVersion:e.codegenVersion},Object.keys(Uu.namespaces).forEach((e=>{const[t,n]=ma(Uu.namespaces[e]);Uu.namespaces[e].relationships=t,Uu.namespaces[e].keys=n;const r=new Map;Object.values(Uu.namespaces[e].models).forEach((t=>{const n=[];Object.values(t.fields).filter((e=>e.association&&"BELONGS_TO"===e.association.connectionType&&e.type.model!==t.name)).forEach((e=>n.push(e.type.model))),r.set(t.name,n),Object.values(t.fields).forEach((e=>{const t=Qu[e.type.model];Bs(t)&&Object.defineProperty(e.type,"modelConstructor",{get:()=>{const e=Ku(t);if(!e)throw new Error(`Could not find model definition for ${t.name}`);return{builder:t,schema:e,pkField:pa(e)}}})}));const i=Uu.namespaces[e].relationships[t.name].indexes,o=new Set;for(const e of i)for(const t of e[1])o.add(t);t.allFields={...Object.fromEntries([...o.values()].map((e=>[e,{name:e,type:"ID",isArray:!1}]))),...t.fields}}));const i=new Map;let o=1e3;for(;o>0&&0!==r.size;){if(o--,0===o)throw new Error("Models are not topologically sortable. Please verify your schema.");for(const e of Array.from(r.keys())){const t=r.get(e);t?.every((e=>i.has(e)))&&i.set(e,t)}Array.from(i.keys()).forEach((e=>r.delete(e)))}Uu.namespaces[e].modelTopologicalOrdering=i})),Qu})({models:{Challenge:{name:"Challenge",fields:{id:{name:"id",isArray:!1,type:"ID",isRequired:!0,attributes:[]},auto:{name:"auto",isArray:!1,type:"Boolean",isRequired:!0,attributes:[]},autoDailyBread:{name:"autoDailyBread",isArray:!1,type:"Boolean",isRequired:!1,attributes:[]},autoComments:{name:"autoComments",isArray:!1,type:"Boolean",isRequired:!1,attributes:[]},description:{name:"description",isArray:!1,type:"String",isRequired:!0,attributes:[]},title:{name:"title",isArray:!1,type:"String",isRequired:!0,attributes:[]},icon:{name:"icon",isArray:!1,type:{enum:"ChallengeIcons"},isRequired:!0,attributes:[]},weeks:{name:"weeks",isArray:!0,type:{model:"ChallengeWeeks"},isRequired:!1,attributes:[],isArrayNullable:!0,association:{connectionType:"HAS_MANY",associatedWith:["challenge"]}},completers:{name:"completers",isArray:!0,type:{model:"Completer"},isRequired:!1,attributes:[],isArrayNullable:!0,association:{connectionType:"HAS_MANY",associatedWith:["challengeCompletersId"]}},createdAt:{name:"createdAt",isArray:!1,type:"AWSDateTime",isRequired:!1,attributes:[],isReadOnly:!0},updatedAt:{name:"updatedAt",isArray:!1,type:"AWSDateTime",isRequired:!1,attributes:[],isReadOnly:!0}},syncable:!0,pluralName:"Challenges",attributes:[{type:"model",properties:{}},{type:"key",properties:{fields:["id"]}},{type:"auth",properties:{rules:[{allow:"public",operations:["create","update","delete","read"]}]}}]},Week:{name:"Week",fields:{monday:{name:"monday",isArray:!1,type:"AWSDate",isRequired:!0,attributes:[]},challenges:{name:"challenges",isArray:!0,type:{model:"ChallengeWeeks"},isRequired:!1,attributes:[],isArrayNullable:!0,association:{connectionType:"HAS_MANY",associatedWith:["week"]}},completers:{name:"completers",isArray:!0,type:{model:"Completer"},isRequired:!1,attributes:[],isArrayNullable:!0,association:{connectionType:"HAS_MANY",associatedWith:["weekCompletersMonday"]}},createdAt:{name:"createdAt",isArray:!1,type:"AWSDateTime",isRequired:!1,attributes:[],isReadOnly:!0},updatedAt:{name:"updatedAt",isArray:!1,type:"AWSDateTime",isRequired:!1,attributes:[],isReadOnly:!0}},syncable:!0,pluralName:"Weeks",attributes:[{type:"model",properties:{}},{type:"key",properties:{fields:["monday"]}},{type:"auth",properties:{rules:[{allow:"public",operations:["create","update","delete","read"]}]}}]},Completer:{name:"Completer",fields:{id:{name:"id",isArray:!1,type:"ID",isRequired:!0,attributes:[]},week:{name:"week",isArray:!1,type:{model:"Week"},isRequired:!1,attributes:[],association:{connectionType:"BELONGS_TO",targetNames:["weekCompletersMonday"]}},challenge:{name:"challenge",isArray:!1,type:{model:"Challenge"},isRequired:!1,attributes:[],association:{connectionType:"BELONGS_TO",targetNames:["challengeCompletersId"]}},user:{name:"user",isArray:!1,type:{model:"User"},isRequired:!1,attributes:[],association:{connectionType:"BELONGS_TO",targetNames:["userCompletedChallengesUsername"]}},createdAt:{name:"createdAt",isArray:!1,type:"AWSDateTime",isRequired:!1,attributes:[],isReadOnly:!0},updatedAt:{name:"updatedAt",isArray:!1,type:"AWSDateTime",isRequired:!1,attributes:[],isReadOnly:!0},challengeCompletersId:{name:"challengeCompletersId",isArray:!1,type:"ID",isRequired:!1,attributes:[]},weekCompletersMonday:{name:"weekCompletersMonday",isArray:!1,type:"AWSDate",isRequired:!1,attributes:[]},userCompletedChallengesUsername:{name:"userCompletedChallengesUsername",isArray:!1,type:"String",isRequired:!1,attributes:[]}},syncable:!0,pluralName:"Completers",attributes:[{type:"model",properties:{}},{type:"auth",properties:{rules:[{allow:"public",operations:["create","update","delete","read"]}]}}]},User:{name:"User",fields:{username:{name:"username",isArray:!1,type:"String",isRequired:!0,attributes:[]},name:{name:"name",isArray:!1,type:"String",isRequired:!0,attributes:[]},anonymous:{name:"anonymous",isArray:!1,type:"Boolean",isRequired:!0,attributes:[]},dailyBreadNotificationTime:{name:"dailyBreadNotificationTime",isArray:!1,type:"String",isRequired:!1,attributes:[]},dailyBreadNotifications:{name:"dailyBreadNotifications",isArray:!1,type:"Boolean",isRequired:!1,attributes:[]},dailyBreads:{name:"dailyBreads",isArray:!0,type:{model:"DailyBreadUser"},isRequired:!1,attributes:[],isArrayNullable:!0,association:{connectionType:"HAS_MANY",associatedWith:["user"]}},morningRevival:{name:"morningRevival",isArray:!0,type:{model:"MorningRevivalUser"},isRequired:!1,attributes:[],isArrayNullable:!0,association:{connectionType:"HAS_MANY",associatedWith:["user"]}},events:{name:"events",isArray:!0,type:{model:"EventsUser"},isRequired:!1,attributes:[],isArrayNullable:!0,association:{connectionType:"HAS_MANY",associatedWith:["user"]}},completedChallenges:{name:"completedChallenges",isArray:!0,type:{model:"Completer"},isRequired:!1,attributes:[],isArrayNullable:!0,association:{connectionType:"HAS_MANY",associatedWith:["userCompletedChallengesUsername"]}},createdAt:{name:"createdAt",isArray:!1,type:"AWSDateTime",isRequired:!1,attributes:[],isReadOnly:!0},updatedAt:{name:"updatedAt",isArray:!1,type:"AWSDateTime",isRequired:!1,attributes:[],isReadOnly:!0}},syncable:!0,pluralName:"Users",attributes:[{type:"model",properties:{}},{type:"key",properties:{fields:["username"]}},{type:"key",properties:{name:"usersByName",fields:["name"]}},{type:"auth",properties:{rules:[{allow:"public",operations:["create","update","delete","read"]}]}}]},Comments:{name:"Comments",fields:{id:{name:"id",isArray:!1,type:"ID",isRequired:!0,attributes:[]},name:{name:"name",isArray:!1,type:"String",isRequired:!0,attributes:[]},text:{name:"text",isArray:!1,type:"String",isRequired:!0,attributes:[]},datetime:{name:"datetime",isArray:!1,type:"AWSDateTime",isRequired:!0,attributes:[]},username:{name:"username",isArray:!1,type:"String",isRequired:!0,attributes:[]},dailyBread:{name:"dailyBread",isArray:!1,type:"AWSDate",isRequired:!1,attributes:[]},morningRevival:{name:"morningRevival",isArray:!1,type:"AWSDate",isRequired:!1,attributes:[]},createdAt:{name:"createdAt",isArray:!1,type:"AWSDateTime",isRequired:!1,attributes:[],isReadOnly:!0},updatedAt:{name:"updatedAt",isArray:!1,type:"AWSDateTime",isRequired:!1,attributes:[],isReadOnly:!0}},syncable:!0,pluralName:"Comments",attributes:[{type:"model",properties:{}},{type:"key",properties:{name:"DailyBreadComments",fields:["dailyBread","datetime"]}},{type:"key",properties:{name:"MorningRevivalComments",fields:["morningRevival","datetime"]}},{type:"auth",properties:{rules:[{allow:"public",operations:["create","update","delete","read"]}]}}]},DailyBread:{name:"DailyBread",fields:{date:{name:"date",isArray:!1,type:"AWSDate",isRequired:!0,attributes:[]},bookName:{name:"bookName",isArray:!1,type:"String",isRequired:!0,attributes:[]},chapterIdx:{name:"chapterIdx",isArray:!1,type:"String",isRequired:!0,attributes:[]},comments:{name:"comments",isArray:!0,type:{model:"Comments"},isRequired:!1,attributes:[],isArrayNullable:!0,association:{connectionType:"HAS_MANY",associatedWith:["dailyBread"]}},users:{name:"users",isArray:!0,type:{model:"DailyBreadUser"},isRequired:!1,attributes:[],isArrayNullable:!0,association:{connectionType:"HAS_MANY",associatedWith:["dailyBread"]}},createdAt:{name:"createdAt",isArray:!1,type:"AWSDateTime",isRequired:!1,attributes:[],isReadOnly:!0},updatedAt:{name:"updatedAt",isArray:!1,type:"AWSDateTime",isRequired:!1,attributes:[],isReadOnly:!0}},syncable:!0,pluralName:"DailyBreads",attributes:[{type:"model",properties:{}},{type:"key",properties:{fields:["date"]}},{type:"auth",properties:{rules:[{allow:"public",operations:["create","update","delete","read"]}]}}]},Event:{name:"Event",fields:{id:{name:"id",isArray:!1,type:"ID",isRequired:!0,attributes:[]},startDateTime:{name:"startDateTime",isArray:!1,type:"AWSDateTime",isRequired:!0,attributes:[]},endDateTime:{name:"endDateTime",isArray:!1,type:"AWSDateTime",isRequired:!0,attributes:[]},location:{name:"location",isArray:!1,type:"String",isRequired:!0,attributes:[]},topic:{name:"topic",isArray:!1,type:"String",isRequired:!1,attributes:[]},title:{name:"title",isArray:!1,type:"String",isRequired:!0,attributes:[]},handout:{name:"handout",isArray:!1,type:"String",isRequired:!1,attributes:[]},users:{name:"users",isArray:!0,type:{model:"EventsUser"},isRequired:!1,attributes:[],isArrayNullable:!0,association:{connectionType:"HAS_MANY",associatedWith:["event"]}},createdAt:{name:"createdAt",isArray:!1,type:"AWSDateTime",isRequired:!1,attributes:[],isReadOnly:!0},updatedAt:{name:"updatedAt",isArray:!1,type:"AWSDateTime",isRequired:!1,attributes:[],isReadOnly:!0}},syncable:!0,pluralName:"Events",attributes:[{type:"model",properties:{}},{type:"key",properties:{name:"eventsByStartDateTime",fields:["startDateTime"]}},{type:"auth",properties:{rules:[{allow:"public",operations:["create","update","delete","read"]}]}}]},MorningRevival:{name:"MorningRevival",fields:{date:{name:"date",isArray:!1,type:"AWSDate",isRequired:!0,attributes:[]},verses:{name:"verses",isArray:!0,type:"String",isRequired:!1,attributes:[],isArrayNullable:!0},excerpts:{name:"excerpts",isArray:!1,type:"String",isRequired:!1,attributes:[]},instruction:{name:"instruction",isArray:!1,type:"String",isRequired:!1,attributes:[]},comments:{name:"comments",isArray:!0,type:{model:"Comments"},isRequired:!1,attributes:[],isArrayNullable:!0,association:{connectionType:"HAS_MANY",associatedWith:["morningRevival"]}},users:{name:"users",isArray:!0,type:{model:"MorningRevivalUser"},isRequired:!1,attributes:[],isArrayNullable:!0,association:{connectionType:"HAS_MANY",associatedWith:["morningRevival"]}},createdAt:{name:"createdAt",isArray:!1,type:"AWSDateTime",isRequired:!1,attributes:[],isReadOnly:!0},updatedAt:{name:"updatedAt",isArray:!1,type:"AWSDateTime",isRequired:!1,attributes:[],isReadOnly:!0}},syncable:!0,pluralName:"MorningRevivals",attributes:[{type:"model",properties:{}},{type:"key",properties:{fields:["date"]}},{type:"auth",properties:{rules:[{allow:"public",operations:["create","update","delete","read"]}]}}]},ChallengeWeeks:{name:"ChallengeWeeks",fields:{id:{name:"id",isArray:!1,type:"ID",isRequired:!0,attributes:[]},challengeId:{name:"challengeId",isArray:!1,type:"ID",isRequired:!1,attributes:[]},weekMonday:{name:"weekMonday",isArray:!1,type:"ID",isRequired:!1,attributes:[]},challenge:{name:"challenge",isArray:!1,type:{model:"Challenge"},isRequired:!0,attributes:[],association:{connectionType:"BELONGS_TO",targetNames:["challengeId"]}},week:{name:"week",isArray:!1,type:{model:"Week"},isRequired:!0,attributes:[],association:{connectionType:"BELONGS_TO",targetNames:["weekMonday"]}},createdAt:{name:"createdAt",isArray:!1,type:"AWSDateTime",isRequired:!1,attributes:[],isReadOnly:!0},updatedAt:{name:"updatedAt",isArray:!1,type:"AWSDateTime",isRequired:!1,attributes:[],isReadOnly:!0}},syncable:!0,pluralName:"ChallengeWeeks",attributes:[{type:"model",properties:{}},{type:"key",properties:{name:"byChallenge",fields:["challengeId"]}},{type:"key",properties:{name:"byWeek",fields:["weekMonday"]}}]},DailyBreadUser:{name:"DailyBreadUser",fields:{id:{name:"id",isArray:!1,type:"ID",isRequired:!0,attributes:[]},userUsername:{name:"userUsername",isArray:!1,type:"ID",isRequired:!1,attributes:[]},dailyBreadDate:{name:"dailyBreadDate",isArray:!1,type:"ID",isRequired:!1,attributes:[]},user:{name:"user",isArray:!1,type:{model:"User"},isRequired:!0,attributes:[],association:{connectionType:"BELONGS_TO",targetNames:["userUsername"]}},dailyBread:{name:"dailyBread",isArray:!1,type:{model:"DailyBread"},isRequired:!0,attributes:[],association:{connectionType:"BELONGS_TO",targetNames:["dailyBreadDate"]}},createdAt:{name:"createdAt",isArray:!1,type:"AWSDateTime",isRequired:!1,attributes:[],isReadOnly:!0},updatedAt:{name:"updatedAt",isArray:!1,type:"AWSDateTime",isRequired:!1,attributes:[],isReadOnly:!0}},syncable:!0,pluralName:"DailyBreadUsers",attributes:[{type:"model",properties:{}},{type:"key",properties:{name:"byUser",fields:["userUsername"]}},{type:"key",properties:{name:"byDailyBread",fields:["dailyBreadDate"]}}]},MorningRevivalUser:{name:"MorningRevivalUser",fields:{id:{name:"id",isArray:!1,type:"ID",isRequired:!0,attributes:[]},userUsername:{name:"userUsername",isArray:!1,type:"ID",isRequired:!1,attributes:[]},morningRevivalDate:{name:"morningRevivalDate",isArray:!1,type:"ID",isRequired:!1,attributes:[]},user:{name:"user",isArray:!1,type:{model:"User"},isRequired:!0,attributes:[],association:{connectionType:"BELONGS_TO",targetNames:["userUsername"]}},morningRevival:{name:"morningRevival",isArray:!1,type:{model:"MorningRevival"},isRequired:!0,attributes:[],association:{connectionType:"BELONGS_TO",targetNames:["morningRevivalDate"]}},createdAt:{name:"createdAt",isArray:!1,type:"AWSDateTime",isRequired:!1,attributes:[],isReadOnly:!0},updatedAt:{name:"updatedAt",isArray:!1,type:"AWSDateTime",isRequired:!1,attributes:[],isReadOnly:!0}},syncable:!0,pluralName:"MorningRevivalUsers",attributes:[{type:"model",properties:{}},{type:"key",properties:{name:"byUser",fields:["userUsername"]}},{type:"key",properties:{name:"byMorningRevival",fields:["morningRevivalDate"]}}]},EventsUser:{name:"EventsUser",fields:{id:{name:"id",isArray:!1,type:"ID",isRequired:!0,attributes:[]},userUsername:{name:"userUsername",isArray:!1,type:"ID",isRequired:!1,attributes:[]},eventId:{name:"eventId",isArray:!1,type:"ID",isRequired:!1,attributes:[]},user:{name:"user",isArray:!1,type:{model:"User"},isRequired:!0,attributes:[],association:{connectionType:"BELONGS_TO",targetNames:["userUsername"]}},event:{name:"event",isArray:!1,type:{model:"Event"},isRequired:!0,attributes:[],association:{connectionType:"BELONGS_TO",targetNames:["eventId"]}},createdAt:{name:"createdAt",isArray:!1,type:"AWSDateTime",isRequired:!1,attributes:[],isReadOnly:!0},updatedAt:{name:"updatedAt",isArray:!1,type:"AWSDateTime",isRequired:!1,attributes:[],isReadOnly:!0}},syncable:!0,pluralName:"EventsUsers",attributes:[{type:"model",properties:{}},{type:"key",properties:{name:"byUser",fields:["userUsername"]}},{type:"key",properties:{name:"byEvent",fields:["eventId"]}}]}},enums:{ChallengeIcons:{name:"ChallengeIcons",values:["READ","SHARE","VERSE"]}},nonModels:{},codegenVersion:"3.4.4",version:"37088fd87314cbe0692038646d3c0c1c"});function Ml(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)e[r]=n[r]}return e}var Ll=function e(t,n){function r(e,r,i){if("undefined"!=typeof document){"number"==typeof(i=Ml({},n,i)).expires&&(i.expires=new Date(Date.now()+864e5*i.expires)),i.expires&&(i.expires=i.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var o="";for(var s in i)i[s]&&(o+="; "+s,!0!==i[s]&&(o+="="+i[s].split(";")[0]));return document.cookie=e+"="+t.write(r,e)+o}}return Object.create({set:r,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var n=document.cookie?document.cookie.split("; "):[],r={},i=0;i<n.length;i++){var o=n[i].split("="),s=o.slice(1).join("=");try{var a=decodeURIComponent(o[0]);if(r[a]=t.read(s,a),e===a)break}catch(e){}}return e?r[e]:r}},remove:function(e,t){r(e,"",Ml({},t,{expires:-1}))},withAttributes:function(t){return e(this.converter,Ml({},this.attributes,t))},withConverter:function(t){return e(Ml({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(n)},converter:{value:Object.freeze(t)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"});class Fl{constructor(e={}){const{path:t,domain:n,expires:r,sameSite:i,secure:o}=e;if(this.domain=n,this.path=t||"/",this.expires=Object.prototype.hasOwnProperty.call(e,"expires")?r:365,this.secure=!Object.prototype.hasOwnProperty.call(e,"secure")||o,Object.prototype.hasOwnProperty.call(e,"sameSite")){if(!i||!["strict","lax","none"].includes(i))throw new Error('The sameSite value of cookieStorage must be "lax", "strict" or "none".');if("none"===i&&!this.secure)throw new Error("sameSite = None requires the Secure attribute in latest browser versions.");this.sameSite=i}}async setItem(e,t){Ll.set(e,t,this.getData())}async getItem(e){return Ll.get(e)??null}async removeItem(e){Ll.remove(e,this.getData())}async clear(){const e=Ll.get(),t=Object.keys(e).map((e=>this.removeItem(e)));await Promise.all(t)}getData(){return{path:this.path,expires:this.expires,domain:this.domain,secure:this.secure,...this.sameSite&&{sameSite:this.sameSite}}}}const $l=new class extends Xi{constructor(){super(eo())}},jl=(new class extends Xi{constructor(){super("undefined"!=typeof window&&window.sessionStorage?window.sessionStorage:new Zi)}},new Xi(new Zi),{convert:e=>(()=>{if("undefined"!=typeof window&&"function"==typeof window.atob)return window.atob;if("function"==typeof atob)return atob;throw new fn({name:"Base64EncoderError",message:"Cannot resolve the `atob` function from the environment."})})()(e)});var Ul,Bl;(Bl=Ul||(Ul={})).AuthTokenConfigException="AuthTokenConfigException",Bl.AuthUserPoolAndIdentityPoolException="AuthUserPoolAndIdentityPoolException",Bl.AuthUserPoolException="AuthUserPoolException",Bl.InvalidIdentityPoolIdException="InvalidIdentityPoolIdException",Bl.OAuthNotConfigureException="OAuthNotConfigureException";const ql=so({[Ul.AuthTokenConfigException]:{message:"Auth Token Provider not configured.",recoverySuggestion:"Make sure to call Amplify.configure in your app."},[Ul.AuthUserPoolAndIdentityPoolException]:{message:"Auth UserPool or IdentityPool not configured.",recoverySuggestion:"Make sure to call Amplify.configure in your app with UserPoolId and IdentityPoolId."},[Ul.AuthUserPoolException]:{message:"Auth UserPool not configured.",recoverySuggestion:"Make sure to call Amplify.configure in your app with userPoolId and userPoolClientId."},[Ul.InvalidIdentityPoolIdException]:{message:"Invalid identity pool id provided.",recoverySuggestion:"Make sure a valid identityPoolId is given in the config."},[Ul.OAuthNotConfigureException]:{message:"oauth param not configured.",recoverySuggestion:"Make sure to call Amplify.configure with oauth parameter in your app."}});function Kl(e){let t=!0;t=!!e&&!!e.userPoolId&&!!e.userPoolClientId,ql(t,Ul.AuthUserPoolException)}function Gl(e){ql(!!e?.identityPoolId,Ul.InvalidIdentityPoolIdException)}function Vl(e){const t=e.split(".");if(3!==t.length)throw new Error("Invalid token");try{const n=t[1].replace(/-/g,"+").replace(/_/g,"/"),r=decodeURIComponent(jl.convert(n).split("").map((e=>`%${`00${e.charCodeAt(0).toString(16)}`.slice(-2)}`)).join(""));return{toString:()=>e,payload:JSON.parse(r)}}catch(e){throw new Error("Invalid token payload")}}const Wl=(e,t,n,r)=>async(i,o)=>{const s={...r,...i},a=await s.endpointResolver(s,o),c=await t(o,a),u=await e(c,{...s});return n(u)};class zl extends fn{constructor(e){super(e),this.constructor=zl,Object.setPrototypeOf(this,zl.prototype)}}function Ql(e){if(!e||"Error"===e.name||e instanceof TypeError)throw new zl({name:Yi.Unknown,message:"An unknown error has occurred.",underlyingError:e})}const Hl={id:"aws",outputs:{dnsSuffix:"amazonaws.com"},regionRegex:"^(us|eu|ap|sa|ca|me|af)\\-\\w+\\-\\d+$",regions:["aws-global"]},Yl={partitions:[Hl,{id:"aws-cn",outputs:{dnsSuffix:"amazonaws.com.cn"},regionRegex:"^cn\\-\\w+\\-\\d+$",regions:["aws-cn-global"]}]},Jl=e=>{const{partitions:t}=Yl;for(const{regions:n,outputs:r,regionRegex:i}of t){const t=new RegExp(i);if(n.includes(e)||t.test(e))return r.dnsSuffix}return Hl.outputs.dnsSuffix},Xl=gr(Ar,[()=>(e,t)=>async function(t){return t.headers["cache-control"]="no-store",e(t)}]),Zl={service:"cognito-idp",endpointResolver:({region:e})=>{const t=Wr.getConfig().Auth?.Cognito,n=t?.userPoolEndpoint,r=new jt(`https://cognito-idp.${e}.${Jl(e)}`);return{url:n?new jt(n):r}},retryDecider:Dn(En),computeDelay:Bn,userAgentValue:pn(),cache:"no-store"},ed=e=>(t,n)=>{const r=(e=>({"content-type":"application/x-amz-json-1.1","x-amz-target":`AWSCognitoIdentityProviderService.${e}`}))(e);return(({url:e},t,n)=>({headers:t,url:e,body:n,method:"POST"}))(n,r,JSON.stringify(t))},td=()=>async e=>{if(e.statusCode>=300){const t=await En(e);throw Ql(t),new zl({name:t.name,message:t.message})}return await In(e)},nd=()=>async e=>{if(e.statusCode>=300){const t=await En(e);throw Ql(t),new zl({name:t.name,message:t.message})}},rd=Wl(Xl,ed("InitiateAuth"),td(),Zl);function id(e){if(!e||!e.includes(":"))throw new zl({name:"InvalidIdentityPoolIdException",message:"Invalid identity pool id provided.",recoverySuggestion:"Make sure a valid identityPoolId is given in the config."});return e.split(":")[0]}Wl(Xl,ed("RevokeToken"),td(),Zl),Wl(Xl,ed("SignUp"),td(),Zl),Wl(Xl,ed("ConfirmSignUp"),td(),Zl),Wl(Xl,ed("ForgotPassword"),td(),Zl),Wl(Xl,ed("ConfirmForgotPassword"),td(),Zl),Wl(Xl,ed("RespondToAuthChallenge"),td(),Zl),Wl(Xl,ed("ResendConfirmationCode"),td(),Zl),Wl(Xl,ed("VerifySoftwareToken"),td(),Zl),Wl(Xl,ed("AssociateSoftwareToken"),td(),Zl),Wl(Xl,ed("SetUserMFAPreference"),td(),Zl),Wl(Xl,ed("GetUser"),td(),Zl),Wl(Xl,ed("ChangePassword"),td(),Zl),Wl(Xl,ed("ConfirmDevice"),td(),Zl),Wl(Xl,ed("ForgetDevice"),nd(),Zl),Wl(Xl,ed("DeleteUser"),nd(),Zl),Wl(Xl,ed("GetUserAttributeVerificationCode"),td(),Zl),Wl(Xl,ed("GlobalSignOut"),td(),Zl),Wl(Xl,ed("UpdateUserAttributes"),td(),Zl),Wl(Xl,ed("VerifyUserAttribute"),td(),Zl),Wl(Xl,ed("UpdateDeviceStatus"),td(),Zl),Wl(Xl,ed("ListDevices"),td(),Zl),Wl(Xl,ed("DeleteUserAttributes"),td(),Zl);const od="UserUnAuthenticatedException";new zl({name:"InvalidRedirectException",message:"signInRedirect or signOutRedirect had an invalid format or was not found.",recoverySuggestion:"Please make sure the signIn/Out redirect in your oauth config is valid."}),new zl({name:"InvalidOriginException",message:"redirect is coming from a different origin. The oauth flow needs to be initiated from the same origin",recoverySuggestion:"Please call signInWithRedirect from the same origin."});const sd=new zl({name:"TokenRefreshException",message:"Token refresh is not supported when authenticated with the 'implicit grant' (token) oauth flow. \n\tPlease change your oauth configuration to use 'code grant' flow.",recoverySuggestion:"Please logout and change your Amplify configuration to use \"code grant\" flow. \n\tE.g { responseType: 'code' }"}),ad=new zl({name:od,message:"User needs to be authenticated to call this API.",recoverySuggestion:"Sign in before calling this API again."});const cd={inflightOAuth:"inflightOAuth",oauthSignIn:"oauthSignIn",oauthPKCE:"oauthPKCE",oauthState:"oauthState"};function ud(e){return e?.accessToken||e?.idToken}const ld=(e=>{let t;return async(...e)=>t||(t=new Promise(((n,r)=>{(async({tokens:e,authConfig:t,username:n})=>{Kl(t?.Cognito);const r=function(e){const t=e?.split("_")[0];if(!e||e.indexOf("_")<0||!t||"string"!=typeof t)throw new zl({name:"InvalidUserPoolId",message:"Invalid user pool id provided."});return t}(t.Cognito.userPoolId);!function(e){if(function(e){return ud(e)&&!e?.refreshToken}(e))throw sd;if(!function(e){return ud(e)&&e?.refreshToken}(e))throw ad}(e);const i=e.refreshToken,o={REFRESH_TOKEN:i};e.deviceMetadata?.deviceKey&&(o.DEVICE_KEY=e.deviceMetadata.deviceKey);const s=function({username:e,userPoolId:t,userPoolClientId:n}){if("undefined"==typeof window)return;const r=window.AmazonCognitoAdvancedSecurityData;if(void 0===r)return;const i=r.getData(e,t,n);return i?{EncodedData:i}:{}}({username:n,userPoolId:t.Cognito.userPoolId,userPoolClientId:t.Cognito.userPoolClientId}),{AuthenticationResult:a}=await rd({region:r},{ClientId:t?.Cognito?.userPoolClientId,AuthFlow:"REFRESH_TOKEN_AUTH",AuthParameters:o,UserContextData:s}),c=Vl(a?.AccessToken??""),u=a?.IdToken?Vl(a.IdToken):void 0,{iat:l}=c.payload;if(!l)throw new zl({name:"iatNotFoundException",message:"iat not found in access token"});return{accessToken:c,idToken:u,clockDrift:1e3*l-(new Date).getTime(),refreshToken:i,username:n}})(...e).then((e=>{n(e)})).catch((e=>{r(e)})).finally((()=>{t=void 0}))})),t)})(),dd={accessToken:"accessToken",idToken:"idToken",oidcProvider:"oidcProvider",clockDrift:"clockDrift",refreshToken:"refreshToken",deviceKey:"deviceKey",randomPasswordKey:"randomPasswordKey",deviceGroupKey:"deviceGroupKey",signInDetails:"signInDetails"};var hd;!function(e){e.InvalidAuthTokens="InvalidAuthTokens"}(hd||(hd={}));const pd=so({[hd.InvalidAuthTokens]:{message:"Invalid tokens.",recoverySuggestion:"Make sure the tokens are valid."}});class fd{constructor(){this.name="CognitoIdentityServiceProvider"}getKeyValueStorage(){if(!this.keyValueStorage)throw new zl({name:"KeyValueStorageNotFoundException",message:"KeyValueStorage was not found in TokenStore"});return this.keyValueStorage}setKeyValueStorage(e){this.keyValueStorage=e}setAuthConfig(e){this.authConfig=e}async loadTokens(){try{const e=await this.getAuthKeys(),t=await this.getKeyValueStorage().getItem(e.accessToken);if(!t)throw new zl({name:"NoSessionFoundException",message:"Auth session was not found. Make sure to call signIn."});const n=Vl(t),r=await this.getKeyValueStorage().getItem(e.idToken),i=r?Vl(r):void 0,o=await this.getKeyValueStorage().getItem(e.refreshToken)??void 0,s=await this.getKeyValueStorage().getItem(e.clockDrift)??"0",a=Number.parseInt(s),c=await this.getKeyValueStorage().getItem(e.signInDetails),u={accessToken:n,idToken:i,refreshToken:o,deviceMetadata:await this.getDeviceMetadata()??void 0,clockDrift:a,username:await this.getLastAuthUser()};return c&&(u.signInDetails=JSON.parse(c)),u}catch(e){return null}}async storeTokens(e){pd(void 0!==e,hd.InvalidAuthTokens),await this.clearTokens();const t=e.username;await this.getKeyValueStorage().setItem(this.getLastAuthUserKey(),t);const n=await this.getAuthKeys();await this.getKeyValueStorage().setItem(n.accessToken,e.accessToken.toString()),e.idToken&&await this.getKeyValueStorage().setItem(n.idToken,e.idToken.toString()),e.refreshToken&&await this.getKeyValueStorage().setItem(n.refreshToken,e.refreshToken),e.deviceMetadata&&(e.deviceMetadata.deviceKey&&await this.getKeyValueStorage().setItem(n.deviceKey,e.deviceMetadata.deviceKey),e.deviceMetadata.deviceGroupKey&&await this.getKeyValueStorage().setItem(n.deviceGroupKey,e.deviceMetadata.deviceGroupKey),await this.getKeyValueStorage().setItem(n.randomPasswordKey,e.deviceMetadata.randomPassword)),e.signInDetails&&await this.getKeyValueStorage().setItem(n.signInDetails,JSON.stringify(e.signInDetails)),await this.getKeyValueStorage().setItem(n.clockDrift,`${e.clockDrift}`)}async clearTokens(){const e=await this.getAuthKeys();await Promise.all([this.getKeyValueStorage().removeItem(e.accessToken),this.getKeyValueStorage().removeItem(e.idToken),this.getKeyValueStorage().removeItem(e.clockDrift),this.getKeyValueStorage().removeItem(e.refreshToken),this.getKeyValueStorage().removeItem(e.signInDetails),this.getKeyValueStorage().removeItem(this.getLastAuthUserKey())])}async getDeviceMetadata(e){const t=await this.getAuthKeys(e),n=await this.getKeyValueStorage().getItem(t.deviceKey),r=await this.getKeyValueStorage().getItem(t.deviceGroupKey),i=await this.getKeyValueStorage().getItem(t.randomPasswordKey);return i?{deviceKey:n??void 0,deviceGroupKey:r??void 0,randomPassword:i}:null}async clearDeviceMetadata(e){const t=await this.getAuthKeys(e);await Promise.all([this.getKeyValueStorage().removeItem(t.deviceKey),this.getKeyValueStorage().removeItem(t.deviceGroupKey),this.getKeyValueStorage().removeItem(t.randomPasswordKey)])}async getAuthKeys(e){Kl(this.authConfig?.Cognito);const t=e??await this.getLastAuthUser();return yd(this.name,`${this.authConfig.Cognito.userPoolClientId}.${t}`)}getLastAuthUserKey(){Kl(this.authConfig?.Cognito);const e=this.authConfig.Cognito.userPoolClientId;return`${this.name}.${e}.LastAuthUser`}async getLastAuthUser(){return await this.getKeyValueStorage().getItem(this.getLastAuthUserKey())??"username"}}const yd=(e,t)=>md(dd)(`${e}`,t);function md(e){const t=Object.values({...e});return(e,n)=>t.reduce(((t,r)=>({...t,[r]:`${e}.${n}.${r}`})),{})}const gd="amplify-signin-with-hostedUI",vd="CognitoIdentityServiceProvider",bd=(e,t)=>md(cd)(e,t),wd=new class{constructor(e){this.keyValueStorage=e}async clearOAuthInflightData(){Kl(this.cognitoConfig);const e=bd(vd,this.cognitoConfig.userPoolClientId);await Promise.all([this.keyValueStorage.removeItem(e.inflightOAuth),this.keyValueStorage.removeItem(e.oauthPKCE),this.keyValueStorage.removeItem(e.oauthState)])}async clearOAuthData(){Kl(this.cognitoConfig);const e=bd(vd,this.cognitoConfig.userPoolClientId);return await this.clearOAuthInflightData(),await this.keyValueStorage.removeItem(gd),this.keyValueStorage.removeItem(e.oauthSignIn)}loadOAuthState(){Kl(this.cognitoConfig);const e=bd(vd,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.getItem(e.oauthState)}storeOAuthState(e){Kl(this.cognitoConfig);const t=bd(vd,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.setItem(t.oauthState,e)}loadPKCE(){Kl(this.cognitoConfig);const e=bd(vd,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.getItem(e.oauthPKCE)}storePKCE(e){Kl(this.cognitoConfig);const t=bd(vd,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.setItem(t.oauthPKCE,e)}setAuthConfig(e){this.cognitoConfig=e}async loadOAuthInFlight(){Kl(this.cognitoConfig);const e=bd(vd,this.cognitoConfig.userPoolClientId);return"true"===await this.keyValueStorage.getItem(e.inflightOAuth)}async storeOAuthInFlight(e){Kl(this.cognitoConfig);const t=bd(vd,this.cognitoConfig.userPoolClientId);await this.keyValueStorage.setItem(t.inflightOAuth,`${e}`)}async loadOAuthSignIn(){Kl(this.cognitoConfig);const e=bd(vd,this.cognitoConfig.userPoolClientId),t=await this.keyValueStorage.getItem(gd),[n,r]=(await this.keyValueStorage.getItem(e.oauthSignIn))?.split(",")??[];return{isOAuthSignIn:"true"===n||"true"===t,preferPrivateSession:"true"===r}}async storeOAuthSignIn(e,t=!1){Kl(this.cognitoConfig);const n=bd(vd,this.cognitoConfig.userPoolClientId);await this.keyValueStorage.setItem(n.oauthSignIn,`${e},${t}`)}}($l),Sd=[];class Ad{constructor(){this.waitForInflightOAuth=Wc()?async()=>{if(await wd.loadOAuthInFlight())return this.inflightPromise||(this.inflightPromise=new Promise(((e,t)=>{var n;n=e,Sd.push(n)}))),this.inflightPromise}:async()=>{}}setAuthConfig(e){wd.setAuthConfig(e.Cognito),this.authConfig=e}setTokenRefresher(e){this.tokenRefresher=e}setAuthTokenStore(e){this.tokenStore=e}getTokenStore(){if(!this.tokenStore)throw new zl({name:"EmptyTokenStoreException",message:"TokenStore not set"});return this.tokenStore}getTokenRefresher(){if(!this.tokenRefresher)throw new zl({name:"EmptyTokenRefresherException",message:"TokenRefresher not set"});return this.tokenRefresher}async getTokens(e){let t;try{Kl(this.authConfig?.Cognito)}catch(e){return null}await this.waitForInflightOAuth(),this.inflightPromise=void 0,t=await this.getTokenStore().loadTokens();const n=await this.getTokenStore().getLastAuthUser();if(null===t)return null;const r=!!t?.idToken&&Kr({expiresAt:1e3*(t.idToken?.payload?.exp??0),clockDrift:t.clockDrift??0}),i=Kr({expiresAt:1e3*(t.accessToken?.payload?.exp??0),clockDrift:t.clockDrift??0});return(e?.forceRefresh||r||i)&&(t=await this.refreshTokens({tokens:t,username:n}),null===t)?null:{accessToken:t?.accessToken,idToken:t?.idToken,signInDetails:t?.signInDetails}}async refreshTokens({tokens:e,username:t}){try{const{signInDetails:n}=e,r=await this.getTokenRefresher()({tokens:e,authConfig:this.authConfig,username:t});return r.signInDetails=n,await this.setTokens({tokens:r}),Mr.dispatch("auth",{event:"tokenRefresh"},"Auth",Pr),r}catch(e){return this.handleErrors(e)}}handleErrors(e){if(Ql(e),"Network error"!==e.message&&this.clearTokens(),Mr.dispatch("auth",{event:"tokenRefresh_failure",data:{error:e}},"Auth",Pr),e.name.startsWith("NotAuthorizedException"))return null;throw e}async setTokens({tokens:e}){return this.getTokenStore().storeTokens(e)}async clearTokens(){return this.getTokenStore().clearTokens()}getDeviceMetadata(e){return this.getTokenStore().getDeviceMetadata(e)}clearDeviceMetadata(e){return this.getTokenStore().clearDeviceMetadata(e)}}const Ed=new class{constructor(){this.authTokenStore=new fd,this.authTokenStore.setKeyValueStorage($l),this.tokenOrchestrator=new Ad,this.tokenOrchestrator.setAuthTokenStore(this.authTokenStore),this.tokenOrchestrator.setTokenRefresher(ld)}getTokens({forceRefresh:e}={forceRefresh:!1}){return this.tokenOrchestrator.getTokens({forceRefresh:e})}setKeyValueStorage(e){this.authTokenStore.setKeyValueStorage(e)}setAuthConfig(e){this.authTokenStore.setAuthConfig(e),this.tokenOrchestrator.setAuthConfig(e)}},{tokenOrchestrator:Id}=Ed,Td={identityId:"identityId"},Cd=new kn("DefaultIdentityIdStore"),Nd=gr(Ar,[()=>e=>async function(t){return t.headers["cache-control"]="no-store",e(t)}]),Od={service:"cognito-identity",endpointResolver:({region:e})=>({url:new jt(`https://cognito-identity.${e}.${Jl(e)}`)}),retryDecider:Dn(En),computeDelay:Bn,userAgentValue:pn(),cache:"no-store"};ln((()=>{Od.userAgentValue=pn()}));const _d=e=>({"content-type":"application/x-amz-json-1.1","x-amz-target":`AWSCognitoIdentityService.${e}`}),kd=({url:e},t,n)=>({headers:t,url:e,body:n,method:"POST"}),xd=({AccessKeyId:e,SecretKey:t,SessionToken:n,Expiration:r}={})=>({AccessKeyId:e,SecretKey:t,SessionToken:n,Expiration:r&&new Date(1e3*r)}),Pd=Wl(Nd,((e,t)=>{const n=_d("GetCredentialsForIdentity"),r=JSON.stringify(e);return kd(t,n,r)}),(async e=>{if(e.statusCode>=300)throw await En(e);{const t=await In(e);return{IdentityId:t.IdentityId,Credentials:xd(t.Credentials),$metadata:Sn(e)}}}),Od),Dd=Wl(Nd,((e,t)=>{const n=_d("GetId"),r=JSON.stringify(e);return kd(t,n,r)}),(async e=>{if(e.statusCode>=300)throw await En(e);return{IdentityId:(await In(e)).IdentityId,$metadata:Sn(e)}}),Od);function Rd(e){const t=Vl(e).payload.iss,n={};if(!t)throw new zl({name:"InvalidIdTokenException",message:"Invalid Idtoken."});return n[t.replace(/(^\w+:|^)\/\//,"")]=e,n}const Md=new kn("CognitoIdentityIdProvider");async function Ld(e,t){const n=t?.identityPoolId,r=id(n),i=(await Dd({region:r},{IdentityPoolId:n,Logins:e})).IdentityId;if(!i)throw new zl({name:"GetIdResponseException",message:"Received undefined response from getId operation",recoverySuggestion:"Make sure to pass a valid identityPoolId in the configuration."});return i}const Fd=new kn("CognitoCredentialsProvider"),$d=3e6,jd=new class{constructor(e){this._nextCredentialsRefresh=0,this._identityIdStore=e}async clearCredentialsAndIdentityId(){Fd.debug("Clearing out credentials and identityId"),this._credentialsAndIdentityId=void 0,await this._identityIdStore.clearIdentityId()}async clearCredentials(){Fd.debug("Clearing out in-memory credentials"),this._credentialsAndIdentityId=void 0}async getCredentialsAndIdentityId(e){const t=e.authenticated,{tokens:n}=e,{authConfig:r}=e;try{Gl(r?.Cognito)}catch{return}if(!t&&!r.Cognito.allowGuestAccess)return;const{forceRefresh:i}=e,o=this.hasTokenChanged(n),s=await async function({tokens:e,authConfig:t,identityIdStore:n}){n.setAuthConfig({Cognito:t});let r=await n.loadIdentityId();if(e){if(r&&"primary"===r.type)return r.id;{const n=e.idToken?Rd(e.idToken.toString()):{},i=await Ld(n,t);r&&r.id===i&&Md.debug(`The guest identity ${r.id} has become the primary identity.`),r={id:i,type:"primary"}}}else{if(r&&"guest"===r.type)return r.id;r={id:await Ld({},t),type:"guest"}}return n.storeIdentityId(r),r.id}({tokens:n,authConfig:r.Cognito,identityIdStore:this._identityIdStore});return(i||o)&&this.clearCredentials(),t?(function(e){if(!e||!e.idToken)throw new zl({name:od,message:"User needs to be authenticated to call this API.",recoverySuggestion:"Sign in before calling this API again."})}(n),this.credsForOIDCTokens(r.Cognito,n,s)):this.getGuestCredentials(s,r.Cognito)}async getGuestCredentials(e,t){if(this._credentialsAndIdentityId&&!this.isPastTTL()&&!1===this._credentialsAndIdentityId.isAuthenticatedCreds)return Fd.info("returning stored credentials as they neither past TTL nor expired."),this._credentialsAndIdentityId;this.clearCredentials();const n=id(t.identityPoolId),r=await Pd({region:n},{IdentityId:e});if(r.Credentials&&r.Credentials.AccessKeyId&&r.Credentials.SecretKey){this._nextCredentialsRefresh=(new Date).getTime()+$d;const t={credentials:{accessKeyId:r.Credentials.AccessKeyId,secretAccessKey:r.Credentials.SecretKey,sessionToken:r.Credentials.SessionToken,expiration:r.Credentials.Expiration},identityId:e},n=r.IdentityId;return n&&(t.identityId=n,this._identityIdStore.storeIdentityId({id:n,type:"guest"})),this._credentialsAndIdentityId={...t,isAuthenticatedCreds:!1},t}throw new zl({name:"CredentialsNotFoundException",message:"Cognito did not respond with either Credentials, AccessKeyId or SecretKey."})}async credsForOIDCTokens(e,t,n){if(this._credentialsAndIdentityId&&!this.isPastTTL()&&!0===this._credentialsAndIdentityId.isAuthenticatedCreds)return Fd.debug("returning stored credentials as they neither past TTL nor expired."),this._credentialsAndIdentityId;this.clearCredentials();const r=t.idToken?Rd(t.idToken.toString()):{},i=id(e.identityPoolId),o=await Pd({region:i},{IdentityId:n,Logins:r});if(o.Credentials&&o.Credentials.AccessKeyId&&o.Credentials.SecretKey){const e={credentials:{accessKeyId:o.Credentials.AccessKeyId,secretAccessKey:o.Credentials.SecretKey,sessionToken:o.Credentials.SessionToken,expiration:o.Credentials.Expiration},identityId:n};this._credentialsAndIdentityId={...e,isAuthenticatedCreds:!0,associatedIdToken:t.idToken?.toString()},this._nextCredentialsRefresh=(new Date).getTime()+$d;const r=o.IdentityId;return r&&(e.identityId=r,this._identityIdStore.storeIdentityId({id:r,type:"primary"})),e}throw new zl({name:"CredentialsException",message:"Cognito did not respond with either Credentials, AccessKeyId or SecretKey."})}isPastTTL(){return void 0===this._nextCredentialsRefresh||this._nextCredentialsRefresh<=Date.now()}hasTokenChanged(e){return!!e&&!!this._credentialsAndIdentityId?.associatedIdToken&&e.idToken?.toString()!==this._credentialsAndIdentityId.associatedIdToken}}(new class{setAuthConfig(e){var t,n;Gl(e.Cognito),this.authConfig=e,this._authKeys=(t="Cognito",n=e.Cognito.identityPoolId,md(Td)(`com.amplify.${t}`,n))}constructor(e){this._authKeys={},this.keyValueStorage=e}async loadIdentityId(){Gl(this.authConfig?.Cognito);try{if(this._primaryIdentityId)return{id:this._primaryIdentityId,type:"primary"};{const e=await this.keyValueStorage.getItem(this._authKeys.identityId);return e?{id:e,type:"guest"}:null}}catch(e){return Cd.log("Error getting stored IdentityId.",e),null}}async storeIdentityId(e){Gl(this.authConfig?.Cognito),"guest"===e.type?(this.keyValueStorage.setItem(this._authKeys.identityId,e.id),this._primaryIdentityId=void 0):(this._primaryIdentityId=e.id,this.keyValueStorage.removeItem(this._authKeys.identityId))}async clearIdentityId(){this._primaryIdentityId=void 0,await this.keyValueStorage.removeItem(this._authKeys.identityId)}}($l)),Ud={configure(e,t){let n;if(n=Object.keys(e).some((e=>e.startsWith("aws_")))?$r(e):e,n.Auth){if(!t?.Auth)return Wr.libraryOptions.Auth?t?(void 0!==t.ssr&&Ed.setKeyValueStorage(t.ssr?new Fl({sameSite:"lax"}):$l),void Wr.configure(n,{Auth:Wr.libraryOptions.Auth,...t})):void Wr.configure(n):(Ed.setAuthConfig(n.Auth),Ed.setKeyValueStorage(t?.ssr?new Fl({sameSite:"lax"}):$l),void Wr.configure(n,{...t,Auth:{tokenProvider:Ed,credentialsProvider:jd}}));Wr.configure(n,t)}else Wr.configure(n,t)},getConfig:()=>Wr.getConfig()};var Bd=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},qd=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Kd=I("daily-bread-widget");Ud.configure({API:{GraphQL:{endpoint:"https://gi4zexzfnfcbzbz6luibswx2bi.appsync-api.us-west-1.amazonaws.com/graphql",region:"us-west-1",defaultAuthMode:"apiKey",apiKey:"da2-kcdik2ri5zflzgicrd2mgaz2dm"}}});var Gd,Vd,Wd=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},zd=function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))},Qd=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=new(Date.bind.apply(Date,zd([void 0],Wd(e),!1)));return n.setHours(0,0,0,0),n},Hd=new Intl.DateTimeFormat([],{month:"short",day:"numeric"}),Yd=new Intl.DateTimeFormat([],{month:"short",day:"numeric",hour:"numeric",minute:"numeric"}),Jd=function(e,t){return"".concat(e.getHours()%12||12).concat(0===e.getMinutes()?"":":"+e.getMinutes().toString().padStart(2,"0")).concat(t?e.getHours()<12?"am":"pm":"")},Xd=function(e){return Hd.format(e)},Zd=n(883),eh={};eh.styleTagTransform=p(),eh.setAttributes=u(),eh.insert=a().bind(null,"head"),eh.domAPI=o(),eh.insertStyleElement=d(),r()(Zd.Z,eh),Zd.Z&&Zd.Z.locals&&Zd.Z.locals;var th=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},nh=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},rh=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},ih=I("upcoming-events-widget"),oh=I("upcoming-event");var sh,ah,ch,uh,lh;(function(){var t,n,r=new Date,i="".concat(r.getMonth()+1,"/").concat(r.getDate().toString().padStart(2,"0"));try{for(var o=qd(Kd("date")),s=o.next();!s.done;s=o.next())s.value.textContent=i}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}var a=function(){var t,n,i,o;Kd.modify({state:"loading"});try{for(var s=qd(Kd("chapter-title")),c=s.next();!c.done;c=s.next())c.value.textContent="Loading..."}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}try{for(var u=qd(Kd("verses")),l=u.next();!l.done;l=u.next())l.value.innerHTML=""}catch(e){i={error:e}}finally{try{l&&!l.done&&(o=u.return)&&o.call(u)}finally{if(i)throw i.error}}console.log("date:",e(r)),Al.query(Ol,e(r)).then((function(e){return console.log(e),e?fetch("../assets/bible/".concat(e.bookName,".json")).then((function(e){return e.json()})).then((function(t){return t.chapters[Number(e.chapterIdx)]})):{ref:"No Daily Bread today :(",refLong:"No Daily Bread today :(",numVerses:0,verses:[]}})).then((function(e){var t,n,r,i,o,s,a=e.verses.map((function(e){return v(Gd||(Gd=Bd(['\n            <p class="','">\n              <span class="','">','</span>\n              <span class="','">',"</span>\n            </p>\n          "],['\n            <p class="','">\n              <span class="','">','</span>\n              <span class="','">',"</span>\n            </p>\n          "])),Kd("verse"),Kd("verse-ref"),e.ref,Kd("verse-text"),e.text)})).join("");try{for(var c=qd(Kd("chapter-title")),u=c.next();!u.done;u=c.next())u.value.textContent=e.refLong}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}try{for(var l=qd(Kd("verses")),d=l.next();!d.done;d=l.next())d.value.innerHTML=a}catch(e){r={error:e}}finally{try{d&&!d.done&&(i=l.return)&&i.call(l)}finally{if(r)throw r.error}}var h=function(e){e.removeAttribute("disabled"),I.button.modify({disabled:!1},e),e.addEventListener("click",(function(){Kd.modify({expanded:!0},Kd.root(e))}))};try{for(var p=qd(Kd("expander")),f=p.next();!f.done;f=p.next())h(f.value)}catch(e){o={error:e}}finally{try{f&&!f.done&&(s=p.return)&&s.call(p)}finally{if(o)throw o.error}}Kd.modify({state:"loaded"}),Kd.modify({expanded:e.verses.length<=5})})).catch((function(e){var t,n,r,i;console.error(e);var o=document.createElement("div");o.classList.add(Kd("error_msg").className),o.innerHTML=v(Vd||(Vd=Bd(["\n        <div>There was a problem getting today's Daily Bread.</div>\n        <button\n          class=\"",'"\n        >\n          Try again\n        </button>\n      '],["\n        <div>There was a problem getting today's Daily Bread.</div>\n        <button\n          class=\"",'"\n        >\n          Try again\n        </button>\n      '])),I.button({bg:"primary",hover:"shadow",text:"lightest"})),Kd.modify({state:"errored"});try{for(var s=qd(Kd("chapter-title")),c=s.next();!c.done;c=s.next())c.value.textContent="An error occurred."}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}try{for(var u=qd(Kd("verses")),l=u.next();!l.done;l=u.next()){var d=l.value;d.textContent="";var h=o.cloneNode(!0);h.querySelector("button").addEventListener("click",a),d.appendChild(h)}}catch(e){r={error:e}}finally{try{l&&!l.done&&(i=u.return)&&i.call(u)}finally{if(r)throw r.error}}}))};a()})(),uh=ih.select(),lh=function(){var e,t,n=new Date,r=Qd(n);ih.modify({state:"loading"});try{for(var i=nh(uh),o=i.next();!o.done;o=i.next())o.value.innerHTML=v(sh||(sh=th(['<div class="','">\n        Loading...\n      </div>'],['<div class="','">\n        Loading...\n      </div>'])),ih("loading"))}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}fetch("https://scs-app-backend-481f8.web.app/api/v1/events10").then((function(e){return e.json()})).then((function(e){return("events"in e&&e.events?e.events:[]).map((function(e){var t,n,i,o,s,a,c,u,l;if("string"==typeof(null===(t=e.start)||void 0===t?void 0:t.date)&&"string"==typeof(null===(n=e.end)||void 0===n?void 0:n.date)){var d=rh(((null===(i=e.start)||void 0===i?void 0:i.date)||"").split("-"),3),h=d[0],p=d[1],f=d[2],y=rh(((null===(o=e.end)||void 0===o?void 0:o.date)||"").split("-"),3),m=y[0],g=y[1],v=y[2],b=Qd(new Date(+h,+p-1,+f)),w=Qd(new Date(+m,+g-1,+v-1));c=Math.round((b.valueOf()-r.valueOf())/864e5),u=b.valueOf()!==w.valueOf()?b.getMonth()!==w.getMonth()?"".concat(Xd(b)," to ").concat(Xd(w),", all-day"):"".concat(Xd(b),"").concat(w.getDate(),", all-day"):"".concat(Xd(b),", all-day")}else{var S=new Date((null===(s=e.start)||void 0===s?void 0:s.dateTime)||new Date),A=(b=Qd(S),new Date((null===(a=e.end)||void 0===a?void 0:a.dateTime)||new Date));w=Qd(A),c=Math.round((b.valueOf()-r.valueOf())/864e5),u=b.valueOf()!==w.valueOf()?"".concat(Xd(S)," to ").concat((l=A,Yd.format(l))):"".concat(Xd(b)," from ").concat(Jd(S,S.getHours()<12!=A.getHours()<12),"").concat(Jd(A,!0))}return{name:e.summary,time:u,location:e.location,subject:e.description,daysToEvent:c<=0?"Today":1===c?"Tomorrow":"In ".concat(c," days"),link:e.htmlLink}}))})).then((function(e){return e.map((function(e){var t=document.createElement("div");return t.classList.add(oh.className),t.innerHTML=v(ah||(ah=th(['\n            <div class="','">\n              <h3 class="','">','</h3>\n              <div class="','">\n                ','\n              </div>\n              <div class="','">\n                ','\n              </div>\n            </div>\n            <div class="','">\n              <div class="','">\n                ','\n              </div>\n            </div>\n            <div class="','">\n              <div class="','">\n                ','\n              </div>\n              <a\n                href="','"\n                target="_blank"\n                rel="external noreferrer"\n                class="',' fa-regular fa-calendar"\n              ></a>\n            </div>\n          '],['\n            <div class="','">\n              <h3 class="','">','</h3>\n              <div class="','">\n                ','\n              </div>\n              <div class="','">\n                ','\n              </div>\n            </div>\n            <div class="','">\n              <div class="','">\n                ','\n              </div>\n            </div>\n            <div class="','">\n              <div class="','">\n                ','\n              </div>\n              <a\n                href="','"\n                target="_blank"\n                rel="external noreferrer"\n                class="',' fa-regular fa-calendar"\n              ></a>\n            </div>\n          '])),oh("info-text"),oh("info-text-name"),e.name,oh("info-text-time"),e.time||"",oh("info-text-location"),e.location||"",oh("subject"),oh("subject-text"),e.subject||"",oh("calendar"),oh("calendar-text"),e.daysToEvent||"",e.link,oh("calendar-icon")),t}))})).then((function(e){var t,n,r=0===e.length;if(r){var i=document.createElement("div");i.classList.add("".concat(ih("no-events"))),i.innerText="No upcoming events. Check back later for more!",e.push(i)}var o=Array.from({length:uh.length});o[0]=e;for(var s=1;s<uh.length;s++){o[s]=Array.from({length:e.length});for(var a=0;a<e.length;a++)o[s][a]=e[a].cloneNode(!0)}for(ih.modify({empty:r,filled:!r}),s=0;s<uh.length;s++){uh[s].textContent="";try{for(var c=(t=void 0,nh(o[s])),u=c.next();!u.done;u=c.next()){var l=u.value;uh[s].appendChild(l)}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}}})).catch((function(){var e=document.createElement("div");e.classList.add(ih("errored").className),e.innerHTML=v(ch||(ch=th(['\n          <div>There was a problem getting the events.</div>\n          <button\n            class="','"\n          >\n            Try again\n          </button>\n        '],['\n          <div>There was a problem getting the events.</div>\n          <button\n            class="','"\n          >\n            Try again\n          </button>\n        '])),I.button({bg:"primary",text:"lightest",hover:"shadow"})),ih.modify({state:"errored"});for(var t=0;t<uh.length;t++){uh[t].textContent="";var n=e.cloneNode(!0);n.querySelector("button").addEventListener("click",lh),uh[t].appendChild(n)}}))},lh()})()})();
//# sourceMappingURL=index.js.map